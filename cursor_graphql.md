# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GraphQL —Å—Ö–µ–º—ã –¥–ª—è –∫–Ω–∏–≥
_Exported on 12/6/2025 at 11:41:45 GMT+3 from Cursor (2.1.47)_

---

**User**

@schema.graphql –ø—Ä–∏–≤–µ—Ç! –Ω–∞–ø–∏—à–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–∞–∫ –º–æ–∂–Ω–æ –∏–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ö–µ–º—É API, –∫–æ—Ç–æ—Ä–∞—è —É –º–µ–Ω—è –µ—Å—Ç—å. –≠—Ç–æ —Å–∞–π—Ç —Å –∫–Ω–∏–≥–∞–º–∏, –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–∞–º–∏ –∏ –¥—Ä—É–≥–æ–π –∏–Ω—Ñ–æ–π –æ –∫–Ω–∏–≥–∞—Ö

---

**Cursor**


–ò–∑—É—á–∞—é —Å—Ö–µ–º—É –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API.



–°–æ–∑–¥–∞—é —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é GraphQL API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–Ω–∏–≥–∞–º–∏.


```markdown
# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é GraphQL API –¥–ª—è –∫–Ω–∏–∂–Ω–æ–≥–æ —Å–∞–π—Ç–∞

## –û–±–∑–æ—Ä

–≠—Ç–æ GraphQL API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∫–Ω–∏–≥, –∞—É–¥–∏–æ–∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ–ª–ª–µ–∫—Ü–∏–π –∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è (Query) –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Mutation).

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### –ö–Ω–∏–≥–∏ (Book)
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (`uuid`)
- –ù–∞–∑–≤–∞–Ω–∏–µ, slug, –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, EPUB —Ñ–∞–π–ª
- –ê–≤—Ç–æ—Ä—ã, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–µ–≥–∏, –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- –î–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ê—É–¥–∏–æ–∫–Ω–∏–≥–∏ (Audiobook)
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–Ω–∏–≥–∞–º, –Ω–æ —Å —Ç—Ä–µ–∫–∞–º–∏ (`audiobookTrack`)
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

### –ê–≤—Ç–æ—Ä—ã (Author)
- –ò–º—è, —Ñ–∞–º–∏–ª–∏—è, –æ—Ç—á–µ—Å—Ç–≤–æ
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è
- –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ –∏ –∞—É–¥–∏–æ–∫–Ω–∏–≥–∏

### –ö–æ–ª–ª–µ–∫—Ü–∏–∏ (Collection)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–Ω–∏–≥ –∏ –∞—É–¥–∏–æ–∫–Ω–∏–≥
- –ü–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (`orderUuids`)

---

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (Query)

### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```graphql
query GetBooks {
  books(body: {
    isActive: true
    limit: 20
    page: 1
    titleSort: "asc"
  }) {
    uuid
    name
    slug
    annotation
    image {
      url
    }
    authors(limit: 5) {
      uuid
      firstName
      lastName
    }
    categories {
      uuid
      name
    }
  }
}
```

### 2. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∫–Ω–∏–≥—É –ø–æ UUID –∏–ª–∏ slug

```graphql
query GetBook {
  book(body: {
    uuid: "book-uuid-here"
    # –∏–ª–∏
    # slug: "book-slug"
  }) {
    uuid
    name
    annotation
    annotationHTML
    image {
      url
      name
    }
    epub {
      url
    }
    authors {
      uuid
      firstName
      lastName
      patronymic
    }
    categories {
      uuid
      name
      slug
    }
    tags {
      uuid
      name
    }
    collections {
      uuid
      name
    }
    bookSections {
      uuid
      name
      href
      order
    }
    publicationDate
    ageLimit
  }
}
```

### 3. –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –∞–≤—Ç–æ—Ä–∞–º

```graphql
query SearchBooksByAuthors {
  books(body: {
    authors: ["author-uuid-1", "author-uuid-2"]
    isActive: true
    limit: 10
  }) {
    uuid
    name
    authors {
      firstName
      lastName
    }
  }
}
```

### 4. –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

```graphql
query GetBooksWithPagination {
  booksWithPagination(body: {
    isActive: true
    limit: 20
    page: 1
    titleSort: "desc"
  }) {
    books {
      uuid
      name
      slug
      image {
        url
      }
    }
    pageInfo {
      totalCount
      perPage
      totalPage
    }
  }
}
```

### 5. –ü–æ–ª—É—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ —Å –µ–≥–æ –∫–Ω–∏–≥–∞–º–∏

```graphql
query GetAuthor {
  author(body: {
    uuid: "author-uuid"
    # –∏–ª–∏
    # slug: "author-slug"
  }) {
    uuid
    firstName
    lastName
    patronymic
    annotation
    image {
      url
    }
    books(limit: 10, page: 1) {
      uuid
      name
      slug
      image {
        url
      }
    }
    audiobooks(limit: 10, page: 1) {
      uuid
      name
      slug
    }
  }
}
```

### 6. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å –∫–Ω–∏–≥–∞–º–∏

```graphql
query GetCollection {
  collection(body: {
    uuid: "collection-uuid"
  }) {
    uuid
    name
    annotation
    image {
      url
    }
    books(limit: 50, page: 1) {
      uuid
      name
      slug
      image {
        url
      }
    }
    audiobooks(limit: 50, page: 1) {
      uuid
      name
      slug
    }
    orderUuids
  }
}
```

### 7. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫

```graphql
query UniversalSearch {
  search(body: {
    text: "–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –∏–ª–∏ –∞–≤—Ç–æ—Ä–∞"
    category: ["category-uuid-1"]
    tag: ["tag-uuid-1"]
    author: ["author-uuid-1"]
    ageLimit: ["12+", "16+"]
    limit: 20
    page: 1
  }) {
    books {
      uuid
      name
      slug
    }
    audiobooks {
      uuid
      name
      slug
    }
    authors {
      uuid
      firstName
      lastName
    }
    articles {
      uuid
      name
      slug
    }
  }
}
```

### 8. –ü–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ–∫–Ω–∏–≥—É —Å —Ç—Ä–µ–∫–∞–º–∏

```graphql
query GetAudiobook {
  audiobook(body: {
    uuid: "audiobook-uuid"
  }) {
    uuid
    name
    annotation
    duration
    image {
      url
    }
    audiobookTrack {
      uuid
      name
      order
      duration
      audio {
        url
      }
    }
    authors {
      firstName
      lastName
    }
  }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –º—É—Ç–∞—Ü–∏–π (Mutation)

### 1. –°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É

```graphql
mutation CreateBook {
  createBook(body: {
    name: "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏"
    slug: "nazvanie-knigi"
    annotation: "–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –∫–Ω–∏–≥–∏"
    annotationHTML: "<p>–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –≤ HTML</p>"
    image: "https://example.com/image.jpg"
    isActive: true
    ageLimit: "12+"
    publicationDate: "2025-01-01T00:00:00Z"
    isGlobalVersion: true
    externalUuid: "external-id-123"
  }) {
    uuid
    name
    slug
  }
}
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É

```graphql
mutation UpdateBook {
  updateBook(
    uuid: "book-uuid"
    body: {
      name: "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"
      annotation: "–ù–æ–≤–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è"
      isActive: false
    }
  ) {
    uuid
    name
    annotation
    isActive
  }
}
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ –∫ –∫–Ω–∏–≥–µ

```graphql
mutation AddAuthorToBook {
  addBookAuthor(body: {
    bookUuid: "book-uuid"
    authorUuid: "author-uuid"
    order: 1
  }) {
    uuid
    firstName
    lastName
  }
}
```

### 4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ –∫ –∫–Ω–∏–≥–µ

```graphql
mutation AddTagToBook {
  addBookTag(body: {
    book: "book-uuid"
    tag: "tag-uuid"
  }) {
    uuid
    name
  }
}
```

### 5. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é

```graphql
mutation AddBookToCollection {
  addBookCollection(body: {
    collectionUuid: "collection-uuid"
    bookUuid: "book-uuid"
    order: 5
  }) {
    uuid
    name
    books {
      uuid
      name
    }
  }
}
```

### 6. –°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ—Ä–∞

```graphql
mutation CreateAuthor {
  createAuthor(body: {
    firstName: "–ò–≤–∞–Ω"
    lastName: "–ò–≤–∞–Ω–æ–≤"
    patronymic: "–ò–≤–∞–Ω–æ–≤–∏—á"
    annotation: "–ë–∏–æ–≥—Ä–∞—Ñ–∏—è –∞–≤—Ç–æ—Ä–∞"
    image: "https://example.com/author.jpg"
    type: 1
    isActive: true
    order: 1
    slug: "ivanov-ivan"
  }) {
    uuid
    firstName
    lastName
  }
}
```

### 7. –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é

```graphql
mutation CreateCollection {
  createCollection(body: {
    name: "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏"
    slug: "nazvanie-kollekcii"
    annotation: "–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏"
    image: "https://example.com/collection.jpg"
    isActive: true
    order: 1
  }) {
    uuid
    name
    slug
  }
}
```

### 8. –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª –∫–Ω–∏–≥–∏ (BookSection)

```graphql
mutation CreateBookSection {
  createBookSection(body: {
    bookUuid: "book-uuid"
    name: "–ì–ª–∞–≤–∞ 1"
    href: "#chapter1"
    path: "/book/chapter1"
    order: 1
    level: 1
    isShow: true
    isActive: true
    part: 0.1
    offset: 0
  }) {
    uuid
    name
    order
  }
}
```

---

## –†–∞–±–æ—Ç–∞ —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```graphql
query GetUserCollections {
  collectionsUsers {
    uuid
    name
    orderUuids
    books(limit: 50, page: 1) {
      uuid
      name
    }
    audiobooks(limit: 50, page: 1) {
      uuid
      name
    }
  }
}
```

### –î–µ–π—Å—Ç–≤–∏—è —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```graphql
mutation ActionUserCollection {
  actionBookCollectionUsers(body: [
    {
      uuid: "action-uuid-1"
      actionType: 1  # 1 - –¥–æ–±–∞–≤–∏—Ç—å, 2 - —É–¥–∞–ª–∏—Ç—å, –∏ —Ç.–¥.
      createdAt: "2025-01-01T00:00:00Z"
      type: 1  # –¢–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞
      collectionUuid: "collection-uuid"
      collectionType: 1
    }
  ])
}
```

---

## –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```graphql
query GetProfile {
  profile {
    uuid
    fullName
    username
    email
    image {
      url
    }
    progresses {
      uuid
      book {
        uuid
        name
      }
      audiobook {
        uuid
        name
      }
      totalProgression
    }
    collections {
      uuid
      name
    }
  }
}
```

### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —á—Ç–µ–Ω–∏—è –∫–Ω–∏–≥–∏

```graphql
query GetBookProgress {
  progress(bookUuid: "book-uuid") {
    uuid
    totalProgression
    info
    book {
      uuid
      name
    }
  }
}
```

---

## –†–∞–±–æ—Ç–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ç–µ–≥–∞–º–∏

### –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```graphql
query GetCategories {
  categories(body: {
    typeView: ALL  # –∏–ª–∏ BOOK, –∏–ª–∏ MEDIA
  }) {
    uuid
    name
    slug
    image {
      url
    }
  }
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–≥–∏

```graphql
query GetTags {
  tags(body: {
    uuids: ["tag-uuid-1", "tag-uuid-2"]
  }) {
    uuid
    name
    slug
    tagCategory {
      uuid
      name
    }
  }
}
```

---

## –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç–∞—Ç—å—è–º–∏

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—å–∏

```graphql
query GetArticles {
  articles(body: {
    isActive: "true"
    limit: 20
    page: 1
    search: "–ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"
  }) {
    uuid
    name
    slug
    annotation
    preview {
      url
    }
    createdAt
  }
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—å—é —Å –±–ª–æ–∫–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```graphql
query GetArticle {
  articleOne(body: {
    uuid: "article-uuid"
  }) {
    uuid
    name
    contentBlock {
      uuid
      type
      content
      order
      book {
        uuid
        name
      }
      audiobook {
        uuid
        name
      }
    }
  }
}
```

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
–í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ `limit` –∏ `page` –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–ø–∏—Å–∫–æ–≤, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ—Ç–≤–µ—Ç.

### 2. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ `isActive`
–î–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `isActive: true`, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ slug –¥–ª—è SEO
Slug –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∏—Ç–∞–µ–º—ã—Ö URL –Ω–∞ —Å–∞–π—Ç–µ.

### 4. –ü–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ `order` –∏ `orderUuids` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

### 5. –í–Ω–µ—à–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
–ü–æ–ª–µ `externalUuid` –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

### 6. –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
–§–∏–ª—å—Ç—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ `ageLimit` –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º.

---

## –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–Ω–∏–≥–∏
- –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–Ω–∏–≥–∏
- –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ
- –ü–æ–ª—É—á–∏—Ç—å –∞–≤—Ç–æ—Ä–æ–≤ –∫–Ω–∏–≥–∏
- –ü–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π
- –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã –∫–Ω–∏–≥–∏ (–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–∞—Ç–∞–ª–æ–≥
- –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–µ–≥–∏, –∞–≤—Ç–æ—Ä—ã)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
- –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —á—Ç–µ–Ω–∏—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å API –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–ø–æ–º–µ—á–µ–Ω—ã `!` –≤ —Å—Ö–µ–º–µ)
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç (`DateTime` - ISO 8601)
- –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å UUID
- –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–≤—è–∑–µ–π

---

## –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–Ω–∏–≥–∏

```graphql
query GetBookPage($bookUuid: String!) {
  book(body: { uuid: $bookUuid }) {
    uuid
    name
    slug
    annotation
    annotationHTML
    image {
      url
      name
    }
    epub {
      url
    }
    ageLimit
    publicationDate
    authors {
      uuid
      firstName
      lastName
      patronymic
      slug
      image {
        url
      }
    }
    categories {
      uuid
      name
      slug
    }
    tags {
      uuid
      name
      slug
    }
    collections {
      uuid
      name
      slug
    }
    bookSections {
      uuid
      name
      href
      order
      level
      isShow
    }
    articles {
      uuid
      name
      slug
    }
    tests {
      uuid
      description
    }
  }
  
  # –ü–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π
  collections(body: {
    uuids: ["collection-uuid-1", "collection-uuid-2"]
  }) {
    uuid
    name
    books(limit: 5) {
      uuid
      name
      slug
      image {
        url
      }
    }
  }
}
```

---

–≠—Ç–æ API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–Ω–∏–∂–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º, –≤–∫–ª—é—á–∞—è –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

```


–°–æ–∑–¥–∞–ª —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é GraphQL API –¥–ª—è –≤–∞—à–µ–≥–æ –∫–Ω–∏–∂–Ω–æ–≥–æ —Å–∞–π—Ç–∞.

## –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:

1. **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ Book, Audiobook, Author, Collection –∏ –¥—Ä—É–≥–∏—Ö
2. **–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (Query)**:
   - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
   - –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
   - –†–∞–±–æ—Ç–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—É–¥–∏–æ–∫–Ω–∏–≥ —Å —Ç—Ä–µ–∫–∞–º–∏
3. **–ü—Ä–∏–º–µ—Ä—ã –º—É—Ç–∞—Ü–∏–π (Mutation)**:
   - –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤, —Ç–µ–≥–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - –†–∞–±–æ—Ç–∞ —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ –∫–Ω–∏–≥
4. **–†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏**:
   - –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü—Ä–æ–≥—Ä–µ—Å—Å —á—Ç–µ–Ω–∏—è
   - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã** –∏ —Ç–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ —Ñ–∞–π–ª `API_–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï.md` –≤ –≤–∞—à–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –≤–∞—à–∏ UUID –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏. –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏–ª–∏ —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å.

---

**User**

–¥–∞, –∫–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ API, –¥–∞–π –∏–¥–µ–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞

---

**Cursor**


–°–æ–±–∏—Ä–∞—é –∏–¥–µ–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ GraphQL API.


```markdown
# –ò–¥–µ–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ GraphQL API –∫–Ω–∏–∂–Ω–æ–≥–æ —Å–∞–π—Ç–∞

## üìö –ü—Ä–æ–µ–∫—Ç—ã –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

### 1. **–í–µ–±-–∫–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å—Ç–æ–π —Å–∞–π—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–Ω–∏–≥ –∏ –∞–≤—Ç–æ—Ä–æ–≤
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React/Vue + GraphQL
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
  - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–Ω–∏–≥–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
  - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–∞–≤—Ç–æ—Ä—É
  - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∞ —Å –µ–≥–æ –∫–Ω–∏–≥–∞–º–∏
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (2/5)

### 2. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-—á–∏—Ç–∞–ª–∫–∞**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–Ω–∏–≥ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React Native / Flutter
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ß—Ç–µ–Ω–∏–µ EPUB –∫–Ω–∏–≥
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —á—Ç–µ–Ω–∏—è
  - –õ–∏—á–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
  - –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 3. **Telegram-–±–æ—Ç –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–æ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–Ω–∏–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + python-telegram-bot
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–∞–≤—Ç–æ—Ä—É
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ª–∏—á–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∫–Ω–∏–≥–∞—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (2/5)

### 4. **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Plotly/Dash –∏–ª–∏ React + Chart.js
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∫–Ω–∏–≥
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤
  - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–Ω–∏–≥–∏
  - –î–∏–Ω–∞–º–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (2/5)

---

## üöÄ –ü—Ä–æ–µ–∫—Ç—ã —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è

### 5. **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∫–Ω–∏–≥**
**–û–ø–∏—Å–∞–Ω–∏–µ:** AI-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + scikit-learn / TensorFlow
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ç–µ–≥–æ–≤
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 6. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è CMS –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React Admin / Django Admin / Strapi
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ–ª–ª–µ–∫—Ü–∏–π
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, EPUB)
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ç–µ–≥–∞–º–∏
  - –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 7. **–ê—É–¥–∏–æ–ø–ª–µ–µ—Ä –¥–ª—è –∞—É–¥–∏–æ–∫–Ω–∏–≥**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –∞—É–¥–∏–æ–∫–Ω–∏–≥
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React + Web Audio API
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤ –∞—É–¥–∏–æ–∫–Ω–∏–≥
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è
  - –ü–ª–µ–π–ª–∏—Å—Ç—ã –∏ –∑–∞–∫–ª–∞–¥–∫–∏
  - –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
  - –¢–∞–π–º–µ—Ä —Å–Ω–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 8. **–°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –∫–Ω–∏–≥ –∏–∑ Excel
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + pandas + GraphQL –∫–ª–∏–µ–Ω—Ç
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü–∞—Ä—Å–∏–Ω–≥ Excel —Ñ–∞–π–ª–æ–≤ —Å –∫–Ω–∏–≥–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
  - –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ API
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)
- **üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç `check_book_ids.py` - –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –µ–≥–æ!

### 9. **–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∫–Ω–∏–≥–∞–º**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –ø–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º –∫–Ω–∏–≥–∞–º
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React + TypeScript
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –∏–∑ API
  - –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ—Å—Ç–∞–º
  - –†–µ–π—Ç–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 10. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è**
**–û–ø–∏—Å–∞–Ω–∏–µ:** Chrome/Firefox —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** JavaScript + Chrome Extensions API
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –∫–Ω–∏–≥
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–∏—Ç–∞—Ç
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

---

## üéØ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

### 11. **–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª–µ–π**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è —á–∏—Ç–∞—Ç–µ–ª–µ–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Next.js + GraphQL + WebSockets
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –∫–Ω–∏–≥
  - –ö–ª—É–±—ã —á—Ç–µ–Ω–∏—è
  - –û–±—Å—É–∂–¥–µ–Ω–∏—è –∫–Ω–∏–≥
  - –ß–µ–ª–ª–µ–Ω–¥–∂–∏ —á—Ç–µ–Ω–∏—è
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ –∫–Ω–∏–≥–∞—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

### 12. **–°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —á—Ç–µ–Ω–∏—è
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Node.js + Redis + WebSockets
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
  - –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
  - –ö–æ–Ω—Ñ–ª–∏–∫—Ç-—Ä–µ–∑–æ–ª—é—à–Ω –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —á—Ç–µ–Ω–∏–∏
  - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 13. **API Gateway –∏ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Node.js / Python + GraphQL
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–∞—à–µ–≥–æ API –∏ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
  - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
  - Rate limiting
  - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
  - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 14. **–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —á—Ç–µ–Ω–∏—è**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è —á–∏—Ç–∞—Ç–µ–ª–µ–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Apache Kafka + ClickHouse / BigQuery
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á—Ç–µ–Ω–∏—è (—á–µ—Ä–µ–∑ API)
  - –ê–Ω–∞–ª–∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –∫–Ω–∏–≥
  - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤
  - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –û—Ç—á–µ—Ç—ã –∏ –¥–∞—à–±–æ—Ä–¥—ã
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

### 15. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏**
**–û–ø–∏—Å–∞–Ω–∏–µ:** ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + NLP –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (spaCy, transformers)
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ê–Ω–∞–ª–∏–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∫–Ω–∏–≥
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API
  - –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã

### 16. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–Ω–∏–≥**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ EPUB
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è slug –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
  - –ü–æ–∏—Å–∫ –æ–±–ª–æ–∂–µ–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
  - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ API
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 17. **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + SQLite / JSON
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–Ω–∏–≥ –≤ JSON/CSV
  - –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–π
  - –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (2/5)

### 18. **–í–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö API**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + pytest
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
  - –ü–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ñ–∞–π–ª—ã
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 19. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä sitemap.xml**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è sitemap –¥–ª—è SEO
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ–ª–ª–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ API
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è sitemap.xml
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (2/5)

### 20. **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Node.js + Telegram Bot API / Email
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∫–Ω–∏–≥–∞—Ö –ª—é–±–∏–º—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤
  - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

---

## üé® –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

### 21. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∫–Ω–∏–≥–∞–º–∏**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ —Å–≤—è–∑–µ–π –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ–ª–ª–µ–∫—Ü–∏–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** D3.js / vis.js + React
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ì—Ä–∞—Ñ —Å–≤—è–∑–µ–π –∞–≤—Ç–æ—Ä–æ–≤ –∏ –∫–Ω–∏–≥
  - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–π
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 22. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ü–∏—Ç–∞—Ç –∏ –æ–±–ª–æ–∂–µ–∫**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫—Ä–∞—Å–∏–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ü–∏—Ç–∞—Ç–∞–º–∏
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + PIL / Pillow
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ –∏–∑ –∫–Ω–∏–≥
  - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±–ª–æ–∂–µ–∫ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–π
  - –®–∞–±–ª–æ–Ω—ã –¥–∏–∑–∞–π–Ω–∞
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 23. **–ò–≥—Ä–∞-–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ø–æ –∫–Ω–∏–≥–∞–º**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–≥—Ä–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –æ –∫–Ω–∏–≥–∞—Ö
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React / Unity
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –í–æ–ø—Ä–æ—Å—ã –∏–∑ API (—Ç–∏–ø Test)
  - –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  - –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä —Ä–µ–∂–∏–º
  - –†–µ–π—Ç–∏–Ω–≥–∏ –∏–≥—Ä–æ–∫–æ–≤
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 24. **–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–Ω–∏–∂–Ω–∞—è –ø–æ–ª–∫–∞**
**–û–ø–∏—Å–∞–Ω–∏–µ:** 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Three.js + React
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - 3D –ø–æ–ª–∫–∞ —Å –∫–Ω–∏–≥–∞–º–∏
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
  - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
  - –î–∞–Ω–Ω—ã–µ –∏–∑ API
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

---

## üì± –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 25. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–µ–π**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React Native / Flutter
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR-–∫–æ–¥–æ–≤ –∫–Ω–∏–≥
  - –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 26. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –Ω–∞ —Ö–æ–¥—É**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —á—Ç–µ–Ω–∏—è
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** React Native / Flutter
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ß—Ç–µ–Ω–∏–µ –∫–Ω–∏–≥
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
  - –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
  - –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 27. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Goodreads**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å Goodreads
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Goodreads API
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ò–º–ø–æ—Ä—Ç –∫–Ω–∏–≥ –∏–∑ Goodreads
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
  - –≠–∫—Å–ø–æ—Ä—Ç –≤ –≤–∞—à API
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

### 28. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á—Ç–µ–Ω–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Google Calendar API / iCal
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —á—Ç–µ–Ω–∏—è
  - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —á—Ç–µ–Ω–∏–∏
  - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

### 29. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏**
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ –∫–Ω–∏–≥–∞—Ö
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python + Twitter API / Instagram API
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –æ –Ω–æ–≤—ã—Ö –∫–Ω–∏–≥–∞—Ö
  - –¶–∏—Ç–∞—Ç—ã –∏–∑ –∫–Ω–∏–≥
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á—Ç–µ–Ω–∏—è
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

### –î–ª—è –∏–∑—É—á–µ–Ω–∏—è GraphQL:
- –ü—Ä–æ–µ–∫—Ç—ã #1, #3, #4, #9

### –î–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ:
- –ü—Ä–æ–µ–∫—Ç—ã #1, #5, #6, #11

### –î–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:
- –ü—Ä–æ–µ–∫—Ç—ã #2, #7, #8, #20

### –î–ª—è –∏–∑—É—á–µ–Ω–∏—è ML/AI:
- –ü—Ä–æ–µ–∫—Ç—ã #5, #15, #14

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (1-2 –Ω–µ–¥–µ–ª–∏):
- –ü—Ä–æ–µ–∫—Ç—ã #1, #3, #4, #17, #19

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (2+ –º–µ—Å—è—Ü–∞):
- –ü—Ä–æ–µ–∫—Ç—ã #11, #14, #25

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç** –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º –∏ —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
2. **–ò–∑—É—á–∏—Ç–µ API** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GraphQL Playground –∏–ª–∏ Postman
3. **–°–æ–∑–¥–∞–π—Ç–µ MVP** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç
4. **–ò—Ç–µ—Ä–∏—Ä—É–π—Ç–µ** - –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** - –≤–µ–¥–∏—Ç–µ README –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–£–¥–∞—á–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ**

```


–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª —Å–ø–∏—Å–æ–∫ –∏–∑ 29 –∏–¥–µ–π –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ GraphQL API. –û–Ω–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

## –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:

### –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö (4 –ø—Ä–æ–µ–∫—Ç–∞)
- –í–µ–±-–∫–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-—á–∏—Ç–∞–ª–∫–∞
- Telegram-–±–æ—Ç
- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (6 –ø—Ä–æ–µ–∫—Ç–æ–≤)
- –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å AI
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ê—É–¥–∏–æ–ø–ª–µ–µ—Ä
- –ò–º–ø–æ—Ä—Ç –∏–∑ Excel (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–∞—à `check_book_ids.py`)
- –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ (5 –ø—Ä–æ–µ–∫—Ç–æ–≤)
- –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª–µ–π
- –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- API Gateway
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —á—Ç–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã (5 –ø—Ä–æ–µ–∫—Ç–æ–≤)
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä sitemap
- –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (4 –ø—Ä–æ–µ–∫—Ç–∞)
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ü–∏—Ç–∞—Ç
- –ò–≥—Ä–∞-–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞
- –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–Ω–∏–∂–Ω–∞—è –ø–æ–ª–∫–∞

### –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (2 –ø—Ä–æ–µ–∫—Ç–∞)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–µ–π
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —á—Ç–µ–Ω–∏—è

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (3 –ø—Ä–æ–µ–∫—Ç–∞)
- Goodreads
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å
- –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏

## –û—Å–æ–±–µ–Ω–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∏–¥–µ–∏:

1. –°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ Excel (#8) ‚Äî –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–∞—à `check_book_ids.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ API
2. Telegram-–±–æ—Ç (#3) ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –ø–æ–ª–µ–∑–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
3. –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥ (#4) ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
4. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (#5) ‚Äî ML-–ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

–í—Å–µ –∏–¥–µ–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª `–ò–î–ï–ò_–ü–†–û–ï–ö–¢–û–í.md`. –î–ª—è –∫–∞–∫–æ–π –∏–¥–µ–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –∏–ª–∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏?

---

**User**

—Å–º–æ—Ç—Ä–∏, —á—Ç–æ —è –ø—Ä–∏–¥—É–º–∞–ª–∞, —É –º–µ–Ω—è –µ—Å—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90  –º–æ–∂–Ω–æ –ª–∏ —Å–¥–µ–ª–∞—Ç—å –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ –∏ –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–∞—Ç –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –≤ –°–≤–µ—Ç–µ (—Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ API)

---

**Cursor**


–ò–∑—É—á–∞—é —Ñ–æ—Ä–º–∞—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É API. –°–æ–∑–¥–∞—é Telegram-–±–æ—Ç–∞ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏.



–°–æ–∑–¥–∞—é Telegram-–±–æ—Ç–∞ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏.


```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import aiohttp
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with aiohttp.ClientSession() as session:
            async with session.get(self.calendar_url) as response:
                if response.status == 200:
                    return await response.text()
                else:
                    raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        events = []
        
        try:
            # –ü–∞—Ä—Å–∏–º XML
            root = ET.fromstring(xml_content)
            
            # Yandex Calendar –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç HTML —Å —Å–æ–±—ã—Ç–∏—è–º–∏
            # –ü–∞—Ä—Å–∏–º –∫–∞–∫ —Ç–µ–∫—Å—Ç, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ HTML-—ç–∫—Å–ø–æ—Ä—Ç
            lines = xml_content.split('\n')
            
            current_event = None
            
            for line in lines:
                line = line.strip()
                
                # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
                if line.startswith('# '):
                    if current_event:
                        events.append(current_event)
                    
                    title = line[2:].strip()
                    current_event = {
                        'title': title,
                        'start_date': None,
                        'end_date': None,
                        'description': '',
                        'author_uuids': [],
                        'tags': [],
                        'links': []
                    }
                
                # –ò—â–µ–º –¥–∞—Ç—ã (—Ñ–æ—Ä–º–∞—Ç: DD MMMM YYYY HH:MM DD MMMM YYYY HH:MM)
                elif current_event and re.match(r'^\d{1,2}\s+\w+\s+\d{4}\s+\d{2}:\d{2}', line):
                    date_match = re.findall(r'(\d{1,2}\s+\w+\s+\d{4}\s+\d{2}:\d{2})', line)
                    if len(date_match) >= 1:
                        try:
                            # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É (—Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–π)
                            date_str = date_match[0]
                            # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
                            for fmt in ['%d %B %Y %H:%M', '%d %m %Y %H:%M', '%d.%m.%Y %H:%M']:
                                try:
                                    current_event['start_date'] = datetime.strptime(date_str, fmt)
                                    break
                                except ValueError:
                                    continue
                        except Exception as e:
                            logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: {e}")
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–Ω–∏–≥–∏
                elif current_event and 'example.com' in line:
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º URL
                    url_match = re.search(r'https?://[^\s<>"]+', line)
                    if url_match:
                        url = url_match.group(0)
                        current_event['links'].append(url)
                        
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º UUID –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ —Å—Å—ã–ª–æ–∫
                        parsed_url = urlparse(url)
                        query_params = parse_qs(parsed_url.query)
                        
                        if 'authors' in query_params:
                            author_uuids = query_params['authors']
                            current_event['author_uuids'].extend(author_uuids)
                        
                        if 'tags' in query_params:
                            tags = query_params['tags']
                            current_event['tags'].extend(tags)
                
                # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                elif current_event and line and not line.startswith('#'):
                    if current_event['description']:
                        current_event['description'] += '\n' + line
                    else:
                        current_event['description'] = line
            
            # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–±—ã—Ç–∏–µ
            if current_event:
                events.append(current_event)
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {e}")
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —Å—Ç—Ä–æ–∫–∞–º
            events = self._simple_parse(xml_content)
        
        return events
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_match = re.search(r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})', date_line)
                    if date_match:
                        day, month_ru, year, time = date_match.groups()
                        try:
                            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                            months_ru = {
                                '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12
                            }
                            month = months_ru.get(month_ru.lower(), 1)
                            hour, minute = map(int, time.split(':'))
                            event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                            break
                        except Exception as e:
                            logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: {e}")
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                for j in range(i + 1, min(i + 10, len(lines))):
                    link_line = lines[j]
                    if 'example.com' in link_line:
                        url_match = re.search(r'https?://[^\s<>"]+', link_line)
                        if url_match:
                            url = url_match.group(0)
                            event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            parsed_url = urlparse(url)
                            query_params = parse_qs(parsed_url.query)
                            
                            if 'authors' in query_params:
                                event['author_uuids'].extend(query_params['authors'])
                            if 'tags' in query_params:
                                event['tags'].extend(query_params['tags'])
                
                events.append(event)
            i += 1
        
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data and 'books' in data['data']:
                            return data['data']['books']
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())

```

```python
"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
"""

# –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
# –ü–æ–ª—É—á–∏—Ç–µ —É @BotFather –≤ Telegram: https://t.me/BotFather
BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"

# URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"

# URL GraphQL API
# –£–∑–Ω–∞–π—Ç–µ —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API –∏–ª–∏ –Ω–∞–π–¥–∏—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"

# ID –≥—Ä—É–ø–ø—ã –≤ Telegram
# –°–ø–æ—Å–æ–± 1: –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É, –æ–Ω –ø–æ–∫–∞–∂–µ—Ç ID
# –°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ @RawDataBot
# –°–ø–æ—Å–æ–± 3: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö –±–æ—Ç–∞
GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"

# –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (—á–∞—Å—ã)
SEND_HOUR = 9  # 9:00 —É—Ç—Ä–∞

# –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
TIMEZONE = "Europe/Moscow"

```

```pip-requirements
python-telegram-bot==20.7
aiohttp==3.9.1
asyncio

```

```markdown
# Telegram-–±–æ—Ç –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

–ë–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç".

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- üìÖ –ü–∞—Ä—Å–∏—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ Yandex Calendar
- üìö –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ GraphQL API
- üîó –§–æ—Ä–º–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏
- ‚è∞ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É –≤ –≥—Ä—É–ø–ø—É Telegram
- üé® –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏ –∏ —Å—Å—ã–ª–∫–∞–º–∏

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Telegram –±–æ—Ç (–ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —É @BotFather)
- –î–æ—Å—Ç—É–ø –∫ GraphQL API "–°–≤–µ—Ç"
- –ì—Ä—É–ø–ø–∞ –≤ Telegram –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
pip install -r requirements_bot.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

–û—Ç–∫—Ä–æ–π—Ç–µ `literary_calendar_bot_config.py` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```python
BOT_TOKEN = "–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞"
GRAPHQL_ENDPOINT = "https://–≤–∞—à-api-endpoint.com/graphql"
GROUP_CHAT_ID = "id_–≤–∞—à–µ–π_–≥—Ä—É–ø–ø—ã"
```

3. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**

- –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
- –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥

4. **–ü–æ–ª—É—á–∏—Ç–µ ID –≥—Ä—É–ø–ø—ã:**

- –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ [@userinfobot](https://t.me/userinfobot) –≤ –≤–∞—à—É –≥—Ä—É–ø–ø—É
- –û–Ω –ø–æ–∫–∞–∂–µ—Ç ID –≥—Ä—É–ø–ø—ã
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [@RawDataBot](https://t.me/RawDataBot)

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º

```python
from literary_calendar_bot import LiteraryCalendarBot
import asyncio
import literary_calendar_bot_config as config

async def main():
    bot = LiteraryCalendarBot(
        bot_token=config.BOT_TOKEN,
        calendar_url=config.CALENDAR_URL,
        graphql_endpoint=config.GRAPHQL_ENDPOINT,
        group_chat_id=config.GROUP_CHAT_ID
    )
    await bot.run_daily()

if __name__ == "__main__":
    asyncio.run(main())
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```python
from literary_calendar_bot import LiteraryCalendarBot
import asyncio
import literary_calendar_bot_config as config

async def test():
    bot = LiteraryCalendarBot(
        bot_token=config.BOT_TOKEN,
        calendar_url=config.CALENDAR_URL,
        graphql_endpoint=config.GRAPHQL_ENDPOINT,
        group_chat_id=config.GROUP_CHAT_ID
    )
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    await bot.send_daily_digest()

asyncio.run(test())
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ó–∞–ø—É—Å–∫ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å (Linux)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/literary-bot.service`:

```ini
[Unit]
Description=Literary Calendar Telegram Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/bot
ExecStart=/usr/bin/python3 /path/to/bot/literary_calendar_bot.py
Restart=always

[Install]
WantedBy=multi-user.target
```

–ó–∞–ø—É—Å–∫:

```bash
sudo systemctl enable literary-bot
sudo systemctl start literary-bot
```

## üìù –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
üìö –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É

üìÖ 29 —è–Ω–≤–∞—Ä—è 2026

–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

üìñ –ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:
‚Ä¢ –í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥
‚Ä¢ –î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π
‚Ä¢ –ü–∞–ª–∞—Ç–∞ ‚Ññ6

üîó –°—Å—ã–ª–∫–∏:
–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

–í `literary_calendar_bot_config.py`:

```python
SEND_HOUR = 9  # –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è (0-23)
```

–í –∫–æ–¥–µ –±–æ—Ç–∞ –∏–∑–º–µ–Ω–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–∏:

```python
if now.hour == SEND_HOUR and now.minute == 0:
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥

–í –º–µ—Ç–æ–¥–µ `format_event_message` –∏–∑–º–µ–Ω–∏—Ç–µ:

```python
for book in books[:5]:  # –ò–∑–º–µ–Ω–∏—Ç–µ 5 –Ω–∞ –Ω—É–∂–Ω–æ–µ —á–∏—Å–ª–æ
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

–î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ –º–µ—Ç–æ–¥ `get_today_events`:

```python
# –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è —Å –∞–≤—Ç–æ—Ä–∞–º–∏
today_events = [e for e in today_events if e['author_uuids']]
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –≥—Ä—É–ø–ø—ã
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

### –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

–ö–∞–ª–µ–Ω–¥–∞—Ä—å Yandex –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —Ñ–æ—Ä–º–∞—Ç. –ï—Å–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç XML/HTML –∫–∞–ª–µ–Ω–¥–∞—Ä—è
2. –û–±–Ω–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ `parse_calendar` –ø–æ–¥ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ `_simple_parse`

### –û—à–∏–±–∫–∏ API

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL GraphQL API
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ª–æ–≥–∞—Ö

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –±–æ—Ç—É

```python
from telegram import Update
from telegram.ext import Application, CommandHandler

async def start(update: Update, context):
    await update.message.reply_text("–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è.")

app = Application.builder().token(BOT_TOKEN).build()
app.add_handler(CommandHandler("start", start))
app.run_polling()
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É

–î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/today`:

```python
async def today_command(update: Update, context):
    bot = LiteraryCalendarBot(...)
    await bot.send_daily_digest()
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ `get_today_events` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤–ø–µ—Ä–µ–¥.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π.

## ü§ù –í–∫–ª–∞–¥

–ï—Å–ª–∏ –Ω–∞—à–ª–∏ –æ—à–∏–±–∫–∏ –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–ª—É—á—à–∏—Ç—å –±–æ—Ç–∞ - —Å–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ pull request!

```


–°–æ–∑–¥–∞—é —É–ø—Ä–æ—â—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–ª—É—á—à–∞—é –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:


```python
"""
–ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ–ª–Ω–æ–≥–æ –±–æ—Ç–∞
"""

import asyncio
import aiohttp
from literary_calendar_bot import LiteraryCalendarBot

async def test_calendar_parsing():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    async with aiohttp.ClientSession() as session:
        async with session.get(calendar_url) as response:
            if response.status == 200:
                content = await response.text()
                print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(content)} —Å–∏–º–≤–æ–ª–æ–≤)")
                
                # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
                bot = LiteraryCalendarBot(
                    bot_token="dummy",
                    calendar_url=calendar_url,
                    graphql_endpoint="dummy",
                    group_chat_id="dummy"
                )
                
                events = bot.parse_calendar(content)
                print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 —Å–æ–±—ã—Ç–∏—è
                for i, event in enumerate(events[:3], 1):
                    print(f"\nüìÖ –°–æ–±—ã—Ç–∏–µ {i}:")
                    print(f"   –ù–∞–∑–≤–∞–Ω–∏–µ: {event['title']}")
                    print(f"   –î–∞—Ç–∞: {event['start_date']}")
                    print(f"   –ê–≤—Ç–æ—Ä—ã UUID: {event['author_uuids']}")
                    print(f"   –¢–µ–≥–∏: {event['tags']}")
                    print(f"   –°—Å—ã–ª–∫–∏: {len(event['links'])}")
                
                return True
            else:
                print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {response.status}")
                return False

async def test_today_events():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
    print("\nüìÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    events = await bot.get_today_events()
    
    if events:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {len(events)}")
        for event in events:
            print(f"\nüìö {event['title']}")
            if event['start_date']:
                print(f"   –î–∞—Ç–∞: {event['start_date']}")
            if event['author_uuids']:
                print(f"   –ê–≤—Ç–æ—Ä—ã: {event['author_uuids']}")
    else:
        print("‚ÑπÔ∏è  –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ—Ç")
    
    return events

async def test_message_formatting():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    print("\nüí¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π...")
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url="dummy",
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
    test_event = {
        'title': '–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É',
        'start_date': None,
        'end_date': None,
        'description': '–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏',
        'author_uuids': ['c52f926c-dde3-4631-b1cf-4a8849ad5be9'],
        'tags': [],
        'links': ['https://example.com/catalog?authors=c52f926c-dde3-4631-b1cf-4a8849ad5be9&page=1']
    }
    
    test_books = [
        {'uuid': '1', 'name': '–í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥', 'slug': 'vishnevyy-sad'},
        {'uuid': '2', 'name': '–î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π', 'slug': 'dama-s-sobachkoy'}
    ]
    
    message = bot.format_event_message(test_event, test_books)
    print("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ:")
    print("\n" + "="*50)
    print(message)
    print("="*50)

async def main():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã"""
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è\n")
    
    # –¢–µ—Å—Ç 1: –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    await test_calendar_parsing()
    
    # –¢–µ—Å—Ç 2: –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    await test_today_events()
    
    # –¢–µ—Å—Ç 3: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
    await test_message_formatting()
    
    print("\n‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather")
    print("2. –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @userinfobot)")
    print("3. –£–∑–Ω–∞–π—Ç–µ URL GraphQL API")
    print("4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ literary_calendar_bot_config.py")
    print("5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ literary_calendar_bot.py")

if __name__ == "__main__":
    asyncio.run(main())

```


–°–æ–∑–¥–∞—é –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –±—ã—Å—Ç—Ä–æ–º—É —Å—Ç–∞—Ä—Ç—É:


```markdown
# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install python-telegram-bot aiohttp
```

## –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è –∏ username –¥–ª—è –±–æ—Ç–∞
4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

## –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É

1. –°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É –≤ Telegram –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É (—á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ –ø–æ username)
3. –°–¥–µ–ª–∞–π—Ç–µ –±–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

## –®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ ID –≥—Ä—É–ø–ø—ã

**–°–ø–æ—Å–æ–± 1 (–ø—Ä–æ—Å—Ç–æ–π):**
1. –î–æ–±–∞–≤—å—Ç–µ [@userinfobot](https://t.me/userinfobot) –≤ –≥—Ä—É–ø–ø—É
2. –û–Ω –ø–æ–∫–∞–∂–µ—Ç ID –≥—Ä—É–ø–ø—ã

**–°–ø–æ—Å–æ–± 2:**
1. –î–æ–±–∞–≤—å—Ç–µ [@RawDataBot](https://t.me/RawDataBot) –≤ –≥—Ä—É–ø–ø—É
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç JSON —Å `chat.id` - —ç—Ç–æ –∏ –µ—Å—Ç—å ID –≥—Ä—É–ø–ø—ã

**–°–ø–æ—Å–æ–± 3 (—á–µ—Ä–µ–∑ API):**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ `https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":-1001234567890}` - —ç—Ç–æ ID –≥—Ä—É–ø–ø—ã

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ `literary_calendar_bot_config.py` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```python
BOT_TOKEN = "123456789:ABCdefGHIjklMNOpqrsTUVwxyz"  # –í–∞—à —Ç–æ–∫–µ–Ω
GRAPHQL_ENDPOINT = "https://–≤–∞—à-api.com/graphql"     # URL API
GROUP_CHAT_ID = "-1001234567890"                     # ID –≥—Ä—É–ø–ø—ã
```

**–í–∞–∂–Ω–æ:** –£–∑–Ω–∞–π—Ç–µ URL GraphQL API —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏–ª–∏ –Ω–∞–π–¥–∏—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

## –®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:

```bash
python test_bot.py
```

–≠—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

## –®–∞–≥ 7: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç A: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `run_bot.py`:

```python
from literary_calendar_bot import LiteraryCalendarBot
import asyncio
import literary_calendar_bot_config as config

async def main():
    bot = LiteraryCalendarBot(
        bot_token=config.BOT_TOKEN,
        calendar_url=config.CALENDAR_URL,
        graphql_endpoint=config.GRAPHQL_ENDPOINT,
        group_chat_id=config.GROUP_CHAT_ID
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (–¥–ª—è —Ç–µ—Å—Ç–∞)
    await bot.send_daily_digest()
    
    # –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    # await bot.run_daily()

if __name__ == "__main__":
    asyncio.run(main())
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python run_bot.py
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞

–ò–∑–º–µ–Ω–∏—Ç–µ `run_bot.py`:

```python
# –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
await bot.run_daily()
```

–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è.

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –±–æ—Ç?

1. **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00** (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å
2. **–ù–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è** –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
3. **–ò—â–µ—Ç –∫–Ω–∏–≥–∏** –∞–≤—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ GraphQL API
4. **–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** —Å —ç–º–æ–¥–∑–∏ –∏ —Å—Å—ã–ª–∫–∞–º–∏
5. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –≥—Ä—É–ø–ø—É** Telegram

## üìù –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è

```
üìö –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É

üìÖ 29 —è–Ω–≤–∞—Ä—è 2026

–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

üìñ –ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:
‚Ä¢ –í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥
‚Ä¢ –î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π
‚Ä¢ –ü–∞–ª–∞—Ç–∞ ‚Ññ6

üîó –°—Å—ã–ª–∫–∏:
–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

–í `literary_calendar_bot.py` –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:

```python
if now.hour == 9 and now.minute == 0:
```

–ò–∑–º–µ–Ω–∏—Ç–µ `9` –Ω–∞ –Ω—É–∂–Ω—ã–π —á–∞—Å (0-23).

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –≥—Ä—É–ø–ø—ã

### –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `test_bot.py` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –û—à–∏–±–∫–∏ API

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL GraphQL API
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `README_BOT.md`

## üí° –ò–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/today` –¥–ª—è —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/tomorrow` –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–≤—Ç—Ä–∞—à–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–∏–ø–∞–º —Å–æ–±—ã—Ç–∏–π
- –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö

–£–¥–∞—á–∏! üöÄ

```


–£–ª—É—á—à–∞—é –ø–∞—Ä—Å–µ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø–æ–¥ —Ñ–æ—Ä–º–∞—Ç Yandex Calendar:


```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import aiohttp
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with aiohttp.ClientSession() as session:
            async with session.get(self.calendar_url) as response:
                if response.status == 200:
                    return await response.text()
                else:
                    raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_match = re.search(r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})', date_line)
                    if date_match:
                        day, month_ru, year, time = date_match.groups()
                        try:
                            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                            months_ru = {
                                '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12
                            }
                            month = months_ru.get(month_ru.lower(), 1)
                            hour, minute = map(int, time.split(':'))
                            event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                            break
                        except Exception as e:
                            logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: {e}")
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                for j in range(i + 1, min(i + 10, len(lines))):
                    link_line = lines[j]
                    if 'example.com' in link_line:
                        url_match = re.search(r'https?://[^\s<>"]+', link_line)
                        if url_match:
                            url = url_match.group(0)
                            event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            parsed_url = urlparse(url)
                            query_params = parse_qs(parsed_url.query)
                            
                            if 'authors' in query_params:
                                event['author_uuids'].extend(query_params['authors'])
                            if 'tags' in query_params:
                                event['tags'].extend(query_params['tags'])
                
                events.append(event)
            i += 1
        
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data and 'books' in data['data']:
                            return data['data']['books']
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import aiohttp
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with aiohttp.ClientSession() as session:
            async with session.get(self.calendar_url) as response:
                if response.status == 200:
                    return await response.text()
                else:
                    raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data and 'books' in data['data']:
                            return data['data']['books']
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```


–ü—Ä–æ–≤–µ—Ä—è—é –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ —Å–æ–∑–¥–∞—é —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
"""

import asyncio
import logging
from literary_calendar_bot import LiteraryCalendarBot

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
try:
    import literary_calendar_bot_config as config
except ImportError:
    print("‚ùå –û—à–∏–±–∫–∞: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª literary_calendar_bot_config.py —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏!")
    print("   –°–∫–æ–ø–∏—Ä—É–π—Ç–µ literary_calendar_bot_config.py –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ")
    exit(1)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    if config.BOT_TOKEN == "YOUR_BOT_TOKEN_HERE":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω BOT_TOKEN –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram")
        return
    
    if config.GRAPHQL_ENDPOINT == "https://your-api-endpoint.com/graphql":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GRAPHQL_ENDPOINT –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –£–∑–Ω–∞–π—Ç–µ URL API —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    if config.GROUP_CHAT_ID == "YOUR_GROUP_CHAT_ID":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROUP_CHAT_ID –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ @userinfobot")
        return
    
    # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
    bot = LiteraryCalendarBot(
        bot_token=config.BOT_TOKEN,
        calendar_url=config.CALENDAR_URL,
        graphql_endpoint=config.GRAPHQL_ENDPOINT,
        group_chat_id=config.GROUP_CHAT_ID
    )
    
    print("‚úÖ –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    print(f"üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å: {config.CALENDAR_URL[:50]}...")
    print(f"üîó API: {config.GRAPHQL_ENDPOINT}")
    print(f"üë• –ì—Ä—É–ø–ø–∞: {config.GROUP_CHAT_ID}")
    print("\n" + "="*50)
    print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:")
    print("1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (—Ç–µ—Å—Ç)")
    print("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É")
    print("="*50)
    
    # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É:
    
    # –†–µ–∂–∏–º 1: –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    print("\nüß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    await bot.send_daily_digest()
    print("‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    
    # –†–µ–∂–∏–º 2: –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    # print("\n‚è∞ –†–µ–∂–∏–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∑–∞–ø—É—â–µ–Ω")
    # print("–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00")
    # await bot.run_daily()


if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüëã –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π")

```


–°–æ–∑–¥–∞–Ω Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç. –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:

## –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`literary_calendar_bot.py`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–æ—Ç–∞
   - –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
   - –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ GraphQL API
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞

2. **`literary_calendar_bot_config.py`** ‚Äî —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –¢–æ–∫–µ–Ω –±–æ—Ç–∞
   - URL API
   - ID –≥—Ä—É–ø–ø—ã

3. **`test_bot.py`** ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
   - –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

4. **`run_bot.py`** ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

5. **`requirements_bot.txt`** ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

6. **`README_BOT.md`** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

7. **`QUICK_START.md`** ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ë–æ—Ç –ø–∞—Ä—Å–∏—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ URL
2. –ù–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç UUID –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ —Å—Å—ã–ª–æ–∫ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
4. –î–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ GraphQL API –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–Ω–∏–≥
5. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ –∏ —Å—Å—ã–ª–∫–∞–º–∏
6. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –≥—Ä—É–ø–ø—É Telegram

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install python-telegram-bot aiohttp
```

2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É [@BotFather](https://t.me/BotFather)

3. –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot)

4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ `literary_calendar_bot_config.py`

5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:
```bash
python test_bot.py
```

6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python run_bot.py
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ UUID –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ —Å—Å—ã–ª–æ–∫
- –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ GraphQL API
- –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
üìö –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É

üìÖ 29 —è–Ω–≤–∞—Ä—è 2026

–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

üìñ –ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:
‚Ä¢ –í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥
‚Ä¢ –î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π
‚Ä¢ –ü–∞–ª–∞—Ç–∞ ‚Ññ6

üîó –°—Å—ã–ª–∫–∏:
–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
```

## –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

1. –£–∑–Ω–∞—Ç—å URL GraphQL API (—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏–ª–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
2. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather
3. –£–∑–Ω–∞—Ç—å ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ @userinfobot
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª

–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∏–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ.

```shellscript
pip install python-telegram-bot aiohttp
```

```shellscript
python test_bot.py
```

```shellscript
python run_bot.py
```

```plaintext
üìö –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É

üìÖ 29 —è–Ω–≤–∞—Ä—è 2026

–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

üìñ –ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:
‚Ä¢ –í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥
‚Ä¢ –î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π
‚Ä¢ –ü–∞–ª–∞—Ç–∞ ‚Ññ6

üîó –°—Å—ã–ª–∫–∏:
–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
```

---

**User**

–∞–≥–∞, –∞ –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞–¥–æ –∑–∞–Ω–æ—Å–∏—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –Ø–Ω–¥–µ–∫—Å–µ?

---

**Cursor**


–î–∞, —Å–µ–π—á–∞—Å —Å–æ–±—ã—Ç–∏—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤—Ä—É—á–Ω—É—é. –ú–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å: —Å–æ–∑–¥–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–∞—à–µ–≥–æ GraphQL API.



–í —Å—Ö–µ–º–µ Author –µ—Å—Ç—å –ø–æ–ª—è `birthday` –∏ `deathday`. –°–æ–∑–¥–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç
–∏–∑ GraphQL API –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è/—Å–º–µ—Ä—Ç–∏
3. –°–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ
"""

import asyncio
import logging
import re
from datetime import datetime
from typing import List, Dict, Optional
import aiohttp

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class CalendarSync:
    """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å API"""
    
    def __init__(
        self,
        graphql_endpoint: str,
        yandex_calendar_token: Optional[str] = None,
        calendar_id: Optional[str] = None
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞
        
        Args:
            graphql_endpoint: URL GraphQL API
            yandex_calendar_token: –¢–æ–∫–µ–Ω –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
            calendar_id: ID –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –Ø–Ω–¥–µ–∫—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        """
        self.graphql_endpoint = graphql_endpoint
        self.yandex_calendar_token = yandex_calendar_token
        self.calendar_id = calendar_id
    
    async def get_all_authors(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API"""
        query = """
        query GetAllAuthors {
          authors(body: {
            limit: 1000
            page: 1
          }) {
            uuid
            firstName
            lastName
            patronymic
            birthday
            deathday
            slug
            isActive
          }
        }
        """
        
        all_authors = []
        page = 1
        
        try:
            async with aiohttp.ClientSession() as session:
                while True:
                    query_with_page = query.replace('page: 1', f'page: {page}')
                    
                    async with session.post(
                        self.graphql_endpoint,
                        json={"query": query_with_page},
                        headers={"Content-Type": "application/json"}
                    ) as response:
                        if response.status == 200:
                            data = await response.json()
                            if 'data' in data and 'authors' in data['data']:
                                authors = data['data']['authors']
                                if not authors:
                                    break
                                all_authors.extend(authors)
                                logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã {page}: {len(authors)}")
                                
                                # –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –º–µ–Ω—å—à–µ —á–µ–º limit, –∑–Ω–∞—á–∏—Ç —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                                if len(authors) < 1000:
                                    break
                                page += 1
                            else:
                                logger.error(f"–û—à–∏–±–∫–∞ API: {data}")
                                break
                        else:
                            logger.error(f"–û—à–∏–±–∫–∞ HTTP: {response.status}")
                            break
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤: {e}")
        
        logger.info(f"–í—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤: {len(all_authors)}")
        return all_authors
    
    def parse_date(self, date_str: str) -> Optional[datetime]:
        """
        –ü–∞—Ä—Å–∏—Ç –¥–∞—Ç—É –∏–∑ —Å—Ç—Ä–æ–∫–∏
        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã: "1905", "1905-01-01", "01.01.1905"
        """
        if not date_str:
            return None
        
        date_str = date_str.strip()
        
        # –¢–æ–ª—å–∫–æ –≥–æ–¥
        if re.match(r'^\d{4}$', date_str):
            year = int(date_str)
            return datetime(year, 1, 1)
        
        # –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
        formats = [
            '%Y-%m-%d',
            '%d.%m.%Y',
            '%d/%m/%Y',
            '%Y-%m-%dT%H:%M:%S',
            '%Y-%m-%d %H:%M:%S',
        ]
        
        for fmt in formats:
            try:
                return datetime.strptime(date_str, fmt)
            except ValueError:
                continue
        
        logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: {date_str}")
        return None
    
    def format_author_name(self, author: Dict) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ–µ –∏–º—è –∞–≤—Ç–æ—Ä–∞"""
        parts = []
        if author.get('lastName'):
            parts.append(author['lastName'])
        if author.get('firstName'):
            parts.append(author['firstName'])
        if author.get('patronymic'):
            parts.append(author['patronymic'])
        return ' '.join(parts) if parts else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'
    
    def create_calendar_event(
        self,
        author: Dict,
        event_type: str,  # 'birthday' –∏–ª–∏ 'deathday'
        date: datetime
    ) -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        """
        author_name = self.format_author_name(author)
        author_uuid = author.get('uuid', '')
        author_slug = author.get('slug', '')
        
        if event_type == 'birthday':
            title = f"{author_name} —Ä–æ–¥–∏–ª—Å—è –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è {author_name}"
        else:
            title = f"{author_name} —É–º–µ—Ä –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å –ø–∞–º—è—Ç–∏ {author_name}"
        
        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
        if author_uuid:
            link = f"https://example.com/catalog?authors={author_uuid}&page=1"
            description += f"\n\n–ö–Ω–∏–≥–∏ {author_name} –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª\n{link}"
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        # –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç: "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
        months_ru = {
            1: '—è–Ω–≤–∞—Ä—è', 2: '—Ñ–µ–≤—Ä–∞–ª—è', 3: '–º–∞—Ä—Ç–∞', 4: '–∞–ø—Ä–µ–ª—è',
            5: '–º–∞—è', 6: '–∏—é–Ω—è', 7: '–∏—é–ª—è', 8: '–∞–≤–≥—É—Å—Ç–∞',
            9: '—Å–µ–Ω—Ç—è–±—Ä—è', 10: '–æ–∫—Ç—è–±—Ä—è', 11: '–Ω–æ—è–±—Ä—è', 12: '–¥–µ–∫–∞–±—Ä—è'
        }
        
        date_str = f"{date.day} {months_ru[date.month]} {date.year} 00:00"
        
        return {
            'title': title,
            'description': description,
            'date': date_str,
            'author_uuid': author_uuid,
            'author_name': author_name,
            'link': link if author_uuid else None
        }
    
    def generate_calendar_export(self, events: List[Dict]) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        (—Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å)
        """
        lines = []
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –ø–æ –¥–∞—Ç–µ
        events_sorted = sorted(events, key=lambda x: x['date'])
        
        for event in events_sorted:
            lines.append(f"# {event['title']}")
            lines.append(event['date'])
            if event.get('link'):
                lines.append(event['link'])
            if event.get('description'):
                # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
                desc = event['description'][:200]
                if desc:
                    lines.append(desc)
            lines.append("")  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏
        
        return "\n".join(lines)
    
    async def sync_author_events(self) -> List[Dict]:
        """
        –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        """
        authors = await self.get_all_authors()
        events = []
        
        for author in authors:
            if not author.get('isActive', True):
                continue
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è
            if author.get('birthday'):
                birth_date = self.parse_date(author['birthday'])
                if birth_date:
                    # –°–æ–∑–¥–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å –∏ –º–µ—Å—è—Ü)
                    event = self.create_calendar_event(author, 'birthday', birth_date)
                    events.append(event)
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è –ø–∞–º—è—Ç–∏ (—Å–º–µ—Ä—Ç–∏)
            if author.get('deathday'):
                death_date = self.parse_date(author['deathday'])
                if death_date:
                    event = self.create_calendar_event(author, 'deathday', death_date)
                    events.append(event)
        
        logger.info(f"–°–æ–∑–¥–∞–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    def save_to_file(self, events: List[Dict], filename: str = "literary_calendar_export.txt"):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–∞–π–ª"""
        calendar_text = self.generate_calendar_export(events)
        
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(calendar_text)
        
        logger.info(f"–°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
        return filename


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    OUTPUT_FILE = "literary_calendar_export.txt"
    # =====================
    
    sync = CalendarSync(
        graphql_endpoint=GRAPHQL_ENDPOINT,
        yandex_calendar_token=None,  # –ü–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º API –Ø–Ω–¥–µ–∫—Å
        calendar_id=None
    )
    
    print("üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    print(f"üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API: {GRAPHQL_ENDPOINT}")
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ API
    events = await sync.sync_author_events()
    
    if not events:
        print("‚ùå –°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API.")
        return
    
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª
    filename = sync.save_to_file(events, OUTPUT_FILE)
    
    print(f"\nüìÑ –°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å: https://calendar.yandex.ru")
    print("2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å '–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –¥–∞—Ç—ã'")
    print("3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Ñ–∞–π–ª–∞ (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é)")
    print("4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è")
    print("5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π
    print("\nüìÖ –ü—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π (–ø–µ—Ä–≤—ã–µ 5):")
    for i, event in enumerate(events[:5], 1):
        print(f"\n{i}. {event['title']}")
        print(f"   –î–∞—Ç–∞: {event['date']}")
        if event.get('link'):
            print(f"   –°—Å—ã–ª–∫–∞: {event['link']}")


if __name__ == "__main__":
    asyncio.run(main())

```

```markdown
# üìÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç

## –û–±–∑–æ—Ä

–ï—Å—Ç—å **–¥–≤–∞ —Å–ø–æ—Å–æ–±–∞** —Ä–∞–±–æ—Ç—ã —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º:

### –°–ø–æ—Å–æ–± 1: –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ (—Ç–µ–∫—É—â–∏–π)
- ‚úÖ –í—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤—Ä—É—á–Ω—É—é
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ

### –°–ø–æ—Å–æ–± 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–Ω–æ–≤—ã–π)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö API
- ‚úÖ –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–°–∫—Ä–∏–ø—Ç `sync_calendar_from_api.py`** –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ GraphQL API
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è (`birthday`) –∏ —Å–º–µ—Ä—Ç–∏ (`deathday`)
3. –°–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install aiohttp
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:**

–û—Ç–∫—Ä–æ–π—Ç–µ `sync_calendar_from_api.py` –∏ —É–∫–∞–∂–∏—Ç–µ URL API:

```python
GRAPHQL_ENDPOINT = "https://–≤–∞—à-api-endpoint.com/graphql"
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**

```bash
python sync_calendar_from_api.py
```

4. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å:**

- –û—Ç–∫—Ä–æ–π—Ç–µ [–Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å](https://calendar.yandex.ru)
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –¥–∞—Ç—ã"
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `literary_calendar_export.txt`
- –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤—Ä—É—á–Ω—É—é

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü:

**Windows (Task Scheduler):**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–ø—É—Å–∫ `python sync_calendar_from_api.py` —Ä–∞–∑ –≤ –º–µ—Å—è—Ü

**Linux (cron):**
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab (–∑–∞–ø—É—Å–∫ 1 —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 00:00)
0 0 1 * * /usr/bin/python3 /path/to/sync_calendar_from_api.py
```

---

## üìã –§–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏–π

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
# –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É
29 —è–Ω–≤–∞—Ä—è 2026 00:00
https://example.com/catalog?authors=c52f926c-dde3-4631-b1cf-4a8849ad5be9&page=1
–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤

–ö–Ω–∏–≥–∏ –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª
https://example.com/catalog?authors=c52f926c-dde3-4631-b1cf-4a8849ad5be9&page=1
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –§–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ API

–°–∫—Ä–∏–ø—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç:
- `"1905"` - —Ç–æ–ª—å–∫–æ –≥–æ–¥
- `"1905-01-01"` - –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞
- `"01.01.1905"` - –¥–∞—Ç–∞ —Å —Ç–æ—á–∫–∞–º–∏

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–æ–≤

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç –±–µ—Ä–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤ (`isActive: true`).

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤ `sync_author_events()`:

```python
if not author.get('isActive', True):  # –ò–∑–º–µ–Ω–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ
    continue
```

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏–π:
- **–î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è** - –∏–∑ –ø–æ–ª—è `birthday`
- **–î–Ω–∏ –ø–∞–º—è—Ç–∏** - –∏–∑ –ø–æ–ª—è `deathday`

–ß—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å –æ–¥–∏–Ω –∏–∑ —Ç–∏–ø–æ–≤, –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –±–ª–æ–∫ –≤ –∫–æ–¥–µ.

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

1. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ –Ø–Ω–¥–µ–∫—Å:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —ç–∫—Å–ø–æ—Ä—Ç–∞ (–∫–∞–∫ –≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ)

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ URL –≤ –±–æ—Ç–µ:**
   - –í—Å—Ç–∞–≤—å—Ç–µ URL –≤ `literary_calendar_bot_config.py`
   - –ë–æ—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ —Å–ø–æ—Å–æ–±–∞:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –¥–æ–±–∞–≤–ª—è—Ç—å –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
2. **–í—Ä—É—á–Ω—É—é** –¥–æ–±–∞–≤–ª—è—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:
   - –ü—Ä–∞–∑–¥–Ω–∏–∫–∏ (–î–µ–Ω—å –±–∏–±–ª–∏–æ—Ç–µ–∫, –î–µ–Ω—å –∫–Ω–∏–≥–∏ –∏ —Ç.–¥.)
   - –Æ–±–∏–ª–µ–∏ –∫–Ω–∏–≥
   - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã

### –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
- **–†–∞–∑ –≤ –º–µ—Å—è—Ü** - –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤
- **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤** - –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ç–µ–∫—É—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å:
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –≤ —Ñ–∞–π–ª
- –•—Ä–∞–Ω–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –°–æ–±—ã—Ç–∏—è –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –∞–≤—Ç–æ—Ä–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–ª—è `birthday`/`deathday`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ API

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞—Ç—ã

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ API
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–≥–æ–¥, –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞)

### –î—É–±–ª–∏–∫–∞—Ç—ã —Å–æ–±—ã—Ç–∏–π

- ‚úÖ –ü–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞ –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π

–ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
- –Æ–±–∏–ª–µ–µ–≤ –∫–Ω–∏–≥ (–ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
- –°–æ–±—ã—Ç–∏–π –ø–æ —Ç–µ–≥–∞–º
- –°–æ–±—ã—Ç–∏–π –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ø–Ω–¥–µ–∫—Å Calendar API

–î–ª—è –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [–Ø–Ω–¥–µ–∫—Å Calendar API](https://yandex.ru/dev/calendar/):
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
- –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–π

---

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
python sync_calendar_from_api.py

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª
cat literary_calendar_export.txt

# 3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å
# (—á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

# 4. –û–±–Ω–æ–≤–∏—Ç–µ URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞
# (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π URL —ç–∫—Å–ø–æ—Ä—Ç–∞)

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
python run_bot.py
```

---

**–ò—Ç–æ–≥–æ:** –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏ —Ä—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞—Ç! üéâ

```


–ï—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º:

## –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ (—Ç–µ–∫—É—â–∏–π)

- –í—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤—Ä—É—á–Ω—É—é
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤, –Ω–æ –∏:
  - –ü—Ä–∞–∑–¥–Ω–∏–∫–∏ (–î–µ–Ω—å –±–∏–±–ª–∏–æ—Ç–µ–∫, –î–µ–Ω—å –∫–Ω–∏–≥–∏)
  - –Æ–±–∏–ª–µ–∏ –∫–Ω–∏–≥
  - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã
  - –°–æ–±—ã—Ç–∏—è –ø–æ —Ç–µ–≥–∞–º

## –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–Ω–æ–≤—ã–π)

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `sync_calendar_from_api.py`, –∫–æ—Ç–æ—Ä—ã–π:

1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ –≤–∞—à–µ–≥–æ GraphQL API
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è (`birthday`) –∏ —Å–º–µ—Ä—Ç–∏ (`deathday`)
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ URL API –≤ —Å–∫—Ä–∏–ø—Ç–µ
# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
python sync_calendar_from_api.py

# 3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª literary_calendar_export.txt –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤
- –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
- –≠–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –Ω–∞ —Ä—É—á–Ω–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç)
2. –í—Ä—É—á–Ω—É—é ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:
   - –ü—Ä–∞–∑–¥–Ω–∏–∫–∏
   - –Æ–±–∏–ª–µ–∏ –∫–Ω–∏–≥
   - –°–æ–±—ã—Ç–∏—è –ø–æ —Ç–µ–≥–∞–º/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:

1. –†–∞–∑ –≤ –º–µ—Å—è—Ü –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ `sync_calendar_from_api.py`
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç–µ –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å
3. –î–æ–±–∞–≤–ª—è–µ—Ç–µ –≤—Ä—É—á–Ω—É—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
4. –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

1. URL –≤–∞—à–µ–≥–æ GraphQL API (—É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É –∞–≤—Ç–æ—Ä–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–ª—è `birthday` –∏ `deathday` –≤ API

–°–∫—Ä–∏–ø—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π?

```shellscript
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ URL API –≤ —Å–∫—Ä–∏–ø—Ç–µ
# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
python sync_calendar_from_api.py

# 3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª literary_calendar_export.txt –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å
```

---

**User**

–∞ –≥–¥–µ —ç—Ç–æ—Ç –±–æ—Ç –º–æ–∂–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å?

---

**Cursor**


–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –±–æ—Ç–∞:


```markdown
# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—é Telegram-–±–æ—Ç–∞

## –û–±–∑–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

### üÜì –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
1. **Heroku** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
2. **Railway** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
3. **Render** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
4. **PythonAnywhere** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
5. **VPS** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)

### üí∞ –ü–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
1. **VPS** (DigitalOcean, Vultr, Hetzner)
2. **AWS/GCP/Azure** (–æ–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã)
3. **Docker + –ª—é–±–æ–π —Ö–æ—Å—Ç–∏–Ω–≥**

---

## üÜì –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ)

### 1. Railway.app ‚≠ê (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω —Å $5 –∫—Ä–µ–¥–∏—Ç–∞–º–∏ –≤ –º–µ—Å—è—Ü
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GitHub
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Python

**–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å:**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç:**
   - –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [railway.app](https://railway.app)
   - –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub

2. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–æ–µ–∫—Ç:**
   - –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `Procfile`:
   ```
   worker: python run_bot.py
   ```
   
   - –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `runtime.txt`:
   ```
   python-3.11.0
   ```

3. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - –í Railway: Settings ‚Üí Variables
   - –î–æ–±–∞–≤—å—Ç–µ:
     ```
     BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
     GRAPHQL_ENDPOINT=–≤–∞—à_api_url
     GROUP_CHAT_ID=id_–≥—Ä—É–ø–ø—ã
     CALENDAR_URL=url_–∫–∞–ª–µ–Ω–¥–∞—Ä—è
     ```

4. **–î–µ–ø–ª–æ–π:**
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–¥–æ $5/–º–µ—Å—è—Ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

### 2. Render.com ‚≠ê

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∏–∑ GitHub
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å:**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [render.com](https://render.com)**

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Web Service:**
   - Connect GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - Build Command: `pip install -r requirements_bot.txt`
   - Start Command: `python run_bot.py`

3. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - Environment ‚Üí Add Environment Variable
   - –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–∞–∫ Background Worker:**
   - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤—ã–±–µ—Ä–∏—Ç–µ "Background Worker" –≤–º–µ—Å—Ç–æ "Web Service"

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

---

### 3. PythonAnywhere

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Python
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å:**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [pythonanywhere.com](https://www.pythonanywhere.com)**

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã:**
   - Files ‚Üí Upload files
   - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã –±–æ—Ç–∞

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞–¥–∞—á—É:**
   - Tasks ‚Üí Create new task
   - Command: `python3.10 /home/–≤–∞—à_username/literary_calendar_bot.py`
   - Schedule: Daily at 9:00 AM

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - Files ‚Üí bashrc
   - –î–æ–±–∞–≤—å—Ç–µ:
   ```bash
   export BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"
   export GRAPHQL_ENDPOINT="–≤–∞—à_api_url"
   export GROUP_CHAT_ID="id_–≥—Ä—É–ø–ø—ã"
   ```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ùå –ó–∞–¥–∞—á–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- ‚ùå –ù–µ–ª—å–∑—è –¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º

---

### 4. Heroku (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–ø—É–ª—è—Ä–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- ‚úÖ –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –£–±—Ä–∞–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω (—Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω—ã–π)
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∫—Ä–µ–¥–∏—Ç–Ω—É—é –∫–∞—Ä—Ç—É

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –û—Ç $7/–º–µ—Å—è—Ü

---

## üí∞ –ü–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

### 1. VPS (DigitalOcean, Vultr, Hetzner)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!**

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚úÖ –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ($5-10/–º–µ—Å—è—Ü)
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

**–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å:**

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ VPS

**DigitalOcean:**
- –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [digitalocean.com](https://www.digitalocean.com)
- –°–æ–∑–¥–∞–π—Ç–µ Droplet (Ubuntu 22.04)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: $6/–º–µ—Å—è—Ü

**Hetzner (–¥–µ—à–µ–≤–ª–µ):**
- –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [hetzner.com](https://www.hetzner.com)
- Cloud ‚Üí Create Server
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: ‚Ç¨4/–º–µ—Å—è—Ü

#### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@–≤–∞—à_ip

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
apt update && apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python
apt install python3 python3-pip git -y

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/–≤–∞—à_username/literary-calendar-bot.git
cd literary-calendar-bot

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip3 install -r requirements_bot.txt
```

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ systemd —Å–µ—Ä–≤–∏—Å

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/literary-bot.service`:

```ini
[Unit]
Description=Literary Calendar Telegram Bot
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/literary-calendar-bot
Environment="BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω"
Environment="GRAPHQL_ENDPOINT=–≤–∞—à_api_url"
Environment="GROUP_CHAT_ID=id_–≥—Ä—É–ø–ø—ã"
Environment="CALENDAR_URL=url_–∫–∞–ª–µ–Ω–¥–∞—Ä—è"
ExecStart=/usr/bin/python3 /root/literary-calendar-bot/run_bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ systemd
systemctl daemon-reload

# –í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
systemctl enable literary-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
systemctl start literary-bot

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
systemctl status literary-bot
```

#### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
journalctl -u literary-bot -f

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
journalctl -u literary-bot --since "1 hour ago"
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $5-10/–º–µ—Å—è—Ü

---

### 2. Docker + –ª—é–±–æ–π —Ö–æ—Å—Ç–∏–Ω–≥

**–ü–ª—é—Å—ã:**
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –õ–µ–≥–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ

**–°–æ–∑–¥–∞–π—Ç–µ Dockerfile:**

```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements_bot.txt .
RUN pip install --no-cache-dir -r requirements_bot.txt

COPY . .

CMD ["python", "run_bot.py"]
```

**–°–æ–∑–¥–∞–π—Ç–µ docker-compose.yml:**

```yaml
version: '3.8'

services:
  bot:
    build: .
    restart: always
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - GRAPHQL_ENDPOINT=${GRAPHQL_ENDPOINT}
      - GROUP_CHAT_ID=${GROUP_CHAT_ID}
      - CALENDAR_URL=${CALENDAR_URL}
```

**–ó–∞–ø—É—Å–∫:**

```bash
docker-compose up -d
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í–º–µ—Å—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

### –û–±–Ω–æ–≤–∏—Ç–µ `run_bot.py`:

```python
import os

BOT_TOKEN = os.getenv('BOT_TOKEN')
GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
GROUP_CHAT_ID = os.getenv('GROUP_CHAT_ID')
CALENDAR_URL = os.getenv('CALENDAR_URL', 'https://calendar.yandex.ru/export/html.xml?private_token=...')
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `requirements_bot.txt`
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (`python test_bot.py`)

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- ‚úÖ **Railway** –∏–ª–∏ **Render** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ø—Ä–æ—Å—Ç–æ)

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- ‚úÖ **VPS** (DigitalOcean/Hetzner) - –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
- ‚úÖ **Docker** –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–∏–Ω–≥–µ

### –î–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
- ‚úÖ **PythonAnywhere** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ:
- ‚ùå –¢–æ–∫–µ–Ω—ã –±–æ—Ç–æ–≤
- ‚ùå API –∫–ª—é—á–∏
- ‚ùå ID –≥—Ä—É–ø–ø
- ‚ùå –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ URL

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `.env` —Ñ–∞–π–ª (–¥–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`)
- ‚úÖ –°–µ–∫—Ä–µ—Ç—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ö–æ—Å—Ç–∏–Ω–≥–∞

### –°–æ–∑–¥–∞–π—Ç–µ `.gitignore`:

```
.env
*.pyc
__pycache__/
*.log
literary_calendar_bot_config.py
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ë–æ—Ç —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –¥–æ–±–∞–≤—å—Ç–µ:

```python
import logging
from logging.handlers import RotatingFileHandler

handler = RotatingFileHandler(
    'bot.log',
    maxBytes=10485760,  # 10MB
    backupCount=5
)
handler.setFormatter(logging.Formatter(
    '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
))
logger.addHandler(handler)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è

–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ—Å—Ç–æ–π health check:

```python
async def health_check():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞"""
    try:
        await bot.get_me()
        return True
    except:
        return False
```

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   journalctl -u literary-bot -n 50
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   env | grep BOT_TOKEN
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API:
   ```bash
   curl $GRAPHQL_ENDPOINT
   ```

### –ë–æ—Ç –ø–∞–¥–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### –ë–æ—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –≥—Ä—É–ø–ø—ã
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Railway.app](https://railway.app)
- [Render.com](https://render.com)
- [PythonAnywhere](https://www.pythonanywhere.com)
- [DigitalOcean](https://www.digitalocean.com)
- [Hetzner Cloud](https://www.hetzner.com/cloud)

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–Ω–∏—Ç–µ —Å **Railway** –∏–ª–∏ **Render** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ **VPS** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞! üöÄ

```

```plaintext
worker: python run_bot.py

```

```plaintext
python-3.11.0

```

```ignore
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
ENV/
.venv

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
.env
literary_calendar_bot_config.py
*.log

# IDE
.vscode/
.idea/
*.swp
*.swo

# –≠–∫—Å–ø–æ—Ä—Ç—ã
literary_calendar_export.txt
*.txt.bak

# –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
.DS_Store
Thumbs.db

```

```dockerfile
FROM python:3.11-slim

WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
COPY requirements_bot.txt .
RUN pip install --no-cache-dir -r requirements_bot.txt

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–¥
COPY . .

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
CMD ["python", "run_bot.py"]

```

```dockercompose
version: '3.8'

services:
  literary-bot:
    build: .
    restart: always
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - GRAPHQL_ENDPOINT=${GRAPHQL_ENDPOINT}
      - GROUP_CHAT_ID=${GROUP_CHAT_ID}
      - CALENDAR_URL=${CALENDAR_URL}
    volumes:
      - ./logs:/app/logs
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

```


–û–±–Ω–æ–≤–ª—è—é `run_bot.py` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
"""

import asyncio
import logging
import os
from literary_calendar_bot import LiteraryCalendarBot

# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–¥–ª—è –¥–µ–ø–ª–æ—è)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
BOT_TOKEN = os.getenv('BOT_TOKEN')
GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
GROUP_CHAT_ID = os.getenv('GROUP_CHAT_ID')
CALENDAR_URL = os.getenv('CALENDAR_URL')

# –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–¥–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
if not all([BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID]):
    try:
        import literary_calendar_bot_config as config
        BOT_TOKEN = BOT_TOKEN or config.BOT_TOKEN
        GRAPHQL_ENDPOINT = GRAPHQL_ENDPOINT or config.GRAPHQL_ENDPOINT
        GROUP_CHAT_ID = GROUP_CHAT_ID or config.GROUP_CHAT_ID
        CALENDAR_URL = CALENDAR_URL or config.CALENDAR_URL
    except ImportError:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª!")
        print("   –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID, CALENDAR_URL")
        print("   –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª literary_calendar_bot_config.py")
        exit(1)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    if config.BOT_TOKEN == "YOUR_BOT_TOKEN_HERE":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω BOT_TOKEN –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram")
        return
    
    if config.GRAPHQL_ENDPOINT == "https://your-api-endpoint.com/graphql":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GRAPHQL_ENDPOINT –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –£–∑–Ω–∞–π—Ç–µ URL API —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    if config.GROUP_CHAT_ID == "YOUR_GROUP_CHAT_ID":
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROUP_CHAT_ID –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
        print("   –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ @userinfobot")
        return
    
    # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
    bot = LiteraryCalendarBot(
        bot_token=config.BOT_TOKEN,
        calendar_url=config.CALENDAR_URL,
        graphql_endpoint=config.GRAPHQL_ENDPOINT,
        group_chat_id=config.GROUP_CHAT_ID
    )
    
    print("‚úÖ –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    print(f"üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å: {config.CALENDAR_URL[:50]}...")
    print(f"üîó API: {config.GRAPHQL_ENDPOINT}")
    print(f"üë• –ì—Ä—É–ø–ø–∞: {config.GROUP_CHAT_ID}")
    print("\n" + "="*50)
    print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:")
    print("1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (—Ç–µ—Å—Ç)")
    print("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É")
    print("="*50)
    
    # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É:
    
    # –†–µ–∂–∏–º 1: –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    print("\nüß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    await bot.send_daily_digest()
    print("‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    
    # –†–µ–∂–∏–º 2: –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    # print("\n‚è∞ –†–µ–∂–∏–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∑–∞–ø—É—â–µ–Ω")
    # print("–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00")
    # await bot.run_daily()


if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüëã –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π")


```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
"""

import asyncio
import logging
import os
from literary_calendar_bot import LiteraryCalendarBot

# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–¥–ª—è –¥–µ–ø–ª–æ—è)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
BOT_TOKEN = os.getenv('BOT_TOKEN')
GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
GROUP_CHAT_ID = os.getenv('GROUP_CHAT_ID')
CALENDAR_URL = os.getenv('CALENDAR_URL')

# –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–¥–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
if not all([BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID]):
    try:
        import literary_calendar_bot_config as config
        BOT_TOKEN = BOT_TOKEN or config.BOT_TOKEN
        GRAPHQL_ENDPOINT = GRAPHQL_ENDPOINT or config.GRAPHQL_ENDPOINT
        GROUP_CHAT_ID = GROUP_CHAT_ID or config.GROUP_CHAT_ID
        CALENDAR_URL = CALENDAR_URL or config.CALENDAR_URL
    except ImportError:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª!")
        print("   –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID, CALENDAR_URL")
        print("   –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª literary_calendar_bot_config.py")
        exit(1)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    if BOT_TOKEN == "YOUR_BOT_TOKEN_HERE" or not BOT_TOKEN:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω BOT_TOKEN!")
        print("   –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export BOT_TOKEN='–≤–∞—à_—Ç–æ–∫–µ–Ω'")
        return
    
    if GRAPHQL_ENDPOINT == "https://your-api-endpoint.com/graphql" or not GRAPHQL_ENDPOINT:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GRAPHQL_ENDPOINT!")
        print("   –£–∑–Ω–∞–π—Ç–µ URL API —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export GRAPHQL_ENDPOINT='–≤–∞—à_api_url'")
        return
    
    if GROUP_CHAT_ID == "YOUR_GROUP_CHAT_ID" or not GROUP_CHAT_ID:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROUP_CHAT_ID!")
        print("   –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ @userinfobot")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export GROUP_CHAT_ID='id_–≥—Ä—É–ø–ø—ã'")
        return
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω
    if not CALENDAR_URL:
        CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    print("‚úÖ –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    print(f"üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å: {CALENDAR_URL[:50]}...")
    print(f"üîó API: {GRAPHQL_ENDPOINT}")
    print(f"üë• –ì—Ä—É–ø–ø–∞: {GROUP_CHAT_ID}")
    print("\n" + "="*50)
    print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:")
    print("1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (—Ç–µ—Å—Ç)")
    print("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É")
    print("="*50)
    
    # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É:
    
    # –†–µ–∂–∏–º 1: –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    print("\nüß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    await bot.send_daily_digest()
    print("‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    
    # –†–µ–∂–∏–º 2: –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    # print("\n‚è∞ –†–µ–∂–∏–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∑–∞–ø—É—â–µ–Ω")
    # print("–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00")
    # await bot.run_daily()


if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüëã –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π")


```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
"""

import asyncio
import logging
import os
from literary_calendar_bot import LiteraryCalendarBot

# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–¥–ª—è –¥–µ–ø–ª–æ—è)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
BOT_TOKEN = os.getenv('BOT_TOKEN')
GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
GROUP_CHAT_ID = os.getenv('GROUP_CHAT_ID')
CALENDAR_URL = os.getenv('CALENDAR_URL')

# –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–¥–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
if not all([BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID]):
    try:
        import literary_calendar_bot_config as config
        BOT_TOKEN = BOT_TOKEN or config.BOT_TOKEN
        GRAPHQL_ENDPOINT = GRAPHQL_ENDPOINT or config.GRAPHQL_ENDPOINT
        GROUP_CHAT_ID = GROUP_CHAT_ID or config.GROUP_CHAT_ID
        CALENDAR_URL = CALENDAR_URL or config.CALENDAR_URL
    except ImportError:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª!")
        print("   –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID, CALENDAR_URL")
        print("   –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª literary_calendar_bot_config.py")
        exit(1)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    if BOT_TOKEN == "YOUR_BOT_TOKEN_HERE" or not BOT_TOKEN:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω BOT_TOKEN!")
        print("   –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export BOT_TOKEN='–≤–∞—à_—Ç–æ–∫–µ–Ω'")
        return
    
    if GRAPHQL_ENDPOINT == "https://your-api-endpoint.com/graphql" or not GRAPHQL_ENDPOINT:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GRAPHQL_ENDPOINT!")
        print("   –£–∑–Ω–∞–π—Ç–µ URL API —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export GRAPHQL_ENDPOINT='–≤–∞—à_api_url'")
        return
    
    if GROUP_CHAT_ID == "YOUR_GROUP_CHAT_ID" or not GROUP_CHAT_ID:
        print("‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROUP_CHAT_ID!")
        print("   –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ @userinfobot")
        print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: export GROUP_CHAT_ID='id_–≥—Ä—É–ø–ø—ã'")
        return
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω
    if not CALENDAR_URL:
        CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    print("‚úÖ –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    print(f"üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å: {CALENDAR_URL[:50]}...")
    print(f"üîó API: {GRAPHQL_ENDPOINT}")
    print(f"üë• –ì—Ä—É–ø–ø–∞: {GROUP_CHAT_ID}")
    print("\n" + "="*50)
    print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:")
    print("1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (—Ç–µ—Å—Ç)")
    print("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É")
    print("="*50)
    
    # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É:
    
    # –†–µ–∂–∏–º 1: –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    print("\nüß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    await bot.send_daily_digest()
    print("‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    
    # –†–µ–∂–∏–º 2: –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
    # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:
    print("\n‚è∞ –†–µ–∂–∏–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∑–∞–ø—É—â–µ–Ω")
    print("–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00")
    await bot.run_daily()


if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüëã –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π")


```


–°–æ–∑–¥–∞—é –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –±—ã—Å—Ç—Ä–æ–º—É –¥–µ–ø–ª–æ—é:


```markdown
# ‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –±–æ—Ç–∞

## üöÄ –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±: Railway.app

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/–≤–∞—à_username/literary-calendar-bot.git
   git push -u origin main
   ```

### –®–∞–≥ 2: –î–µ–ø–ª–æ–π –Ω–∞ Railway

1. **–ó–∞–π–¥–∏—Ç–µ –Ω–∞ [railway.app](https://railway.app)**
2. **–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub**
3. **New Project ‚Üí Deploy from GitHub repo**
4. **–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–í Railway: **Settings ‚Üí Variables** ‚Üí Add:

```
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
GRAPHQL_ENDPOINT=https://–≤–∞—à-api.com/graphql
GROUP_CHAT_ID=id_–≤–∞—à–µ–π_–≥—Ä—É–ø–ø—ã
CALENDAR_URL=https://calendar.yandex.ru/export/html.xml?...
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –±–æ—Ç–∞! ‚úÖ

---

## üê≥ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Docker

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/–≤–∞—à_username/literary-calendar-bot.git
cd literary-calendar-bot

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cat > .env << EOF
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
GRAPHQL_ENDPOINT=https://–≤–∞—à-api.com/graphql
GROUP_CHAT_ID=id_–≥—Ä—É–ø–ø—ã
CALENDAR_URL=https://calendar.yandex.ru/export/html.xml?...
EOF

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Docker
docker-compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs -f
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ —Ñ–∞–π–ª—ã –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
- [ ] `requirements_bot.txt` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ë–æ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ (`python test_bot.py`)

---

**–ì–æ—Ç–æ–≤–æ! –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7** üéâ

```


–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—é –±–æ—Ç–∞. –í–∞—Ä–∏–∞–Ω—Ç—ã:

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

### 1. Railway.app (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)

–ü–ª—é—Å—ã:
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω ($5 –∫—Ä–µ–¥–∏—Ç–æ–≤/–º–µ—Å—è—Ü)
- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GitHub
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –≤ GitHub
2. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [railway.app](https://railway.app)
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
5. –ì–æ—Ç–æ–≤–æ

–°—Ç–æ–∏–º–æ—Å—Ç—å: –±–µ—Å–ø–ª–∞—Ç–Ω–æ (–¥–æ $5/–º–µ—Å—è—Ü)

---

### 2. Render.com

–ü–ª—é—Å—ã:
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∏–∑ GitHub
- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–°—Ç–æ–∏–º–æ—Å—Ç—å: –±–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

---

### 3. VPS (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–ü–ª—é—Å—ã:
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ($5‚Äì10/–º–µ—Å—è—Ü)
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

–í–∞—Ä–∏–∞–Ω—Ç—ã:
- DigitalOcean ‚Äî –æ—Ç $6/–º–µ—Å—è—Ü
- Hetzner ‚Äî –æ—Ç ‚Ç¨4/–º–µ—Å—è—Ü
- Vultr ‚Äî –æ—Ç $6/–º–µ—Å—è—Ü

---

### 4. Docker (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ)

–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–∏–Ω–≥–µ —Å Docker:
- VPS
- AWS/GCP/Azure
- –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

---

## –ß—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ

1. `DEPLOYMENT_GUIDE.md` ‚Äî –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
2. `QUICK_DEPLOY.md` ‚Äî –±—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
3. `Procfile` ‚Äî –¥–ª—è Railway/Render
4. `Dockerfile` ‚Äî –¥–ª—è Docker
5. `docker-compose.yml` ‚Äî –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
6. `.gitignore` ‚Äî –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
7. –û–±–Ω–æ–≤–ª–µ–Ω `run_bot.py` ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Railway)

```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∫–æ–¥ –≤ GitHub
git add .
git commit -m "Ready for deploy"
git push

# 2. –ù–∞ Railway:
# - New Project ‚Üí GitHub repo
# - –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# - –ì–æ—Ç–æ–≤–æ!
```

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ Git (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–ù–∞—á–Ω–∏—Ç–µ —Å Railway –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞—Ç–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ VPS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ `DEPLOYMENT_GUIDE.md`. –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞?

```shellscript
# 1. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∫–æ–¥ –≤ GitHub
git add .
git commit -m "Ready for deploy"
git push

# 2. –ù–∞ Railway:
# - New Project ‚Üí GitHub repo
# - –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# - –ì–æ—Ç–æ–≤–æ!
```

---

**User**

–∞ –µ—Å–ª–∏ –Ω–∞ vercel –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å? —ç—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä –≤—ã–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º —Ä–∞—Å—Å—ã–ª–∫—É —ç—Ç–æ–≥–æ –±–æ—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å?

---

**Cursor**


–ü—Ä–æ–≤–µ—Ä—è—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Vercel —Å —ç—Ç–∏–º –±–æ—Ç–æ–º –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —Ä–µ—à–µ–Ω–∏–µ:


```markdown
# üöÄ –î–µ–ø–ª–æ–π –±–æ—Ç–∞ –Ω–∞ Vercel

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Vercel

Vercel **–ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç** –¥–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–∫–∞–∫ –Ω–∞—à –±–æ—Ç —Å `run_daily()`).

**–ü–æ—á–µ–º—É:**
- ‚ùå Vercel —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ serverless —Ñ—É–Ω–∫—Ü–∏—è—Ö
- ‚ùå –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 60 —Å–µ–∫—É–Ω–¥ (–Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º –ø–ª–∞–Ω–µ)
- ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- ‚ùå –§—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: Vercel Cron Jobs + Serverless —Ñ—É–Ω–∫—Ü–∏—è

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Vercel **Cron Jobs** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é!

---

## üìã –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel Cron Jobs (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Serverless —Ñ—É–Ω–∫—Ü–∏—è** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (—á–µ—Ä–µ–∑ Cron)
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
3. –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

```
vercel-bot/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ send-daily.js  (–∏–ª–∏ send-daily.py)
‚îú‚îÄ‚îÄ vercel.json
‚îî‚îÄ‚îÄ requirements.txt
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ serverless —Ñ—É–Ω–∫—Ü–∏—é

**`api/send-daily.py`** (Python —á–µ—Ä–µ–∑ Vercel Python Runtime):

```python
from http.server import BaseHTTPRequestHandler
import json
import asyncio
import os
from literary_calendar_bot import LiteraryCalendarBot

class handler(BaseHTTPRequestHandler):
    def do_POST(self):
        # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        bot_token = os.environ.get('BOT_TOKEN')
        graphql_endpoint = os.environ.get('GRAPHQL_ENDPOINT')
        group_chat_id = os.environ.get('GROUP_CHAT_ID')
        calendar_url = os.environ.get('CALENDAR_URL')
        
        # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
        bot = LiteraryCalendarBot(
            bot_token=bot_token,
            calendar_url=calendar_url,
            graphql_endpoint=graphql_endpoint,
            group_chat_id=group_chat_id
        )
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É
        try:
            asyncio.run(bot.send_daily_digest())
            
            self.send_response(200)
            self.send_header('Content-type', 'application/json')
            self.end_headers()
            self.wfile.write(json.dumps({
                'status': 'success',
                'message': 'Daily digest sent'
            }).encode())
        except Exception as e:
            self.send_response(500)
            self.send_header('Content-type', 'application/json')
            self.end_headers()
            self.wfile.write(json.dumps({
                'status': 'error',
                'message': str(e)
            }).encode())
```

**–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Node.js** (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ –Ω–∞ Vercel):

**`api/send-daily.js`**:

```javascript
const { spawn } = require('child_process');

export default async function handler(req, res) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  if (req.headers.authorization !== `Bearer ${process.env.CRON_SECRET}`) {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  // –ó–∞–ø—É—Å–∫–∞–µ–º Python —Å–∫—Ä–∏–ø—Ç
  const python = spawn('python3', ['send_daily.py']);
  
  let output = '';
  python.stdout.on('data', (data) => {
    output += data.toString();
  });

  python.on('close', (code) => {
    if (code === 0) {
      res.status(200).json({ 
        status: 'success',
        output: output 
      });
    } else {
      res.status(500).json({ 
        status: 'error',
        output: output 
      });
    }
  });
}
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Cron –≤ `vercel.json`

```json
{
  "crons": [
    {
      "path": "/api/send-daily",
      "schedule": "0 9 * * *"
    }
  ],
  "functions": {
    "api/send-daily.js": {
      "maxDuration": 60
    }
  }
}
```

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ Cron:**
- `0 9 * * *` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 UTC
- `0 12 * * *` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 12:00 UTC (–¥–ª—è –ú–æ—Å–∫–≤—ã +3 —á–∞—Å–∞ = 15:00)

### –®–∞–≥ 4: –°–æ–∑–¥–∞–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

**`send_daily.py`** (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞):

```python
import asyncio
import os
import sys
from literary_calendar_bot import LiteraryCalendarBot

async def main():
    bot = LiteraryCalendarBot(
        bot_token=os.environ['BOT_TOKEN'],
        calendar_url=os.environ['CALENDAR_URL'],
        graphql_endpoint=os.environ['GRAPHQL_ENDPOINT'],
        group_chat_id=os.environ['GROUP_CHAT_ID']
    )
    
    await bot.send_daily_digest()
    print("‚úÖ Daily digest sent successfully")

if __name__ == "__main__":
    asyncio.run(main())
```

### –®–∞–≥ 5: –î–µ–ø–ª–æ–π –Ω–∞ Vercel

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI
npm i -g vercel

# –í–æ–π–¥–∏—Ç–µ
vercel login

# –î–µ–ø–ª–æ–π
vercel

# –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
vercel env add BOT_TOKEN
vercel env add GRAPHQL_ENDPOINT
vercel env add GROUP_CHAT_ID
vercel env add CALENDAR_URL
vercel env add CRON_SECRET  # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```

---

## üìã –í–∞—Ä–∏–∞–Ω—Ç 2: Vercel + External Cron (–ü—Ä–æ—â–µ)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

### –í–∞—Ä–∏–∞–Ω—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö cron —Å–µ—Ä–≤–∏—Å–æ–≤:

1. **cron-job.org** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
2. **EasyCron** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
3. **UptimeRobot** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

1. **–°–æ–∑–¥–∞–π—Ç–µ API endpoint –Ω–∞ Vercel:**

**`api/send-daily.js`**:

```javascript
export default async function handler(req, res) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
  const secret = req.query.secret || req.headers['x-cron-secret'];
  if (secret !== process.env.CRON_SECRET) {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å Python —á–µ—Ä–µ–∑ API –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Node.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
  // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º HTTP –∑–∞–ø—Ä–æ—Å –∫ –¥—Ä—É–≥–æ–º—É endpoint
  
  try {
    // –í—ã–ø–æ–ª–Ω—è–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É
    const response = await fetch(process.env.INTERNAL_API_URL + '/send', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${process.env.INTERNAL_SECRET}`
      }
    });
    
    res.status(200).json({ status: 'success' });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
}
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron-job.org:**
   - URL: `https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.vercel.app/api/send-daily?secret=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç`
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 9:00
   - –ú–µ—Ç–æ–¥: GET –∏–ª–∏ POST

---

## ‚ö° –í–∞—Ä–∏–∞–Ω—Ç 3: Vercel + GitHub Actions (–õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç!)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GitHub Actions –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

### `.github/workflows/daily-bot.yml`:

```yaml
name: Daily Bot Send

on:
  schedule:
    - cron: '0 9 * * *'  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 UTC
  workflow_dispatch:  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install -r requirements_bot.txt
      
      - name: Send daily digest
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          GRAPHQL_ENDPOINT: ${{ secrets.GRAPHQL_ENDPOINT }}
          GROUP_CHAT_ID: ${{ secrets.GROUP_CHAT_ID }}
          CALENDAR_URL: ${{ secrets.CALENDAR_URL }}
        run: |
          python send_daily.py
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Vercel
- ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∏ –ª–∏–º–∏—Ç—ã Vercel

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω:
- ‚úÖ 100 GB-hours —Ñ—É–Ω–∫—Ü–∏–π –≤ –º–µ—Å—è—Ü
- ‚úÖ Cron jobs –≤–∫–ª—é—á–µ–Ω—ã
- ‚ö†Ô∏è –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 60 —Å–µ–∫—É–Ω–¥
- ‚ö†Ô∏è –§—É–Ω–∫—Ü–∏–∏ "–∑–∞—Å—ã–ø–∞—é—Ç" –ø–æ—Å–ª–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### Pro –ø–ª–∞–Ω ($20/–º–µ—Å—è—Ü):
- ‚úÖ 1000 GB-hours —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 300 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ë–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è —ç—Ç–æ–≥–æ –±–æ—Ç–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

1. **Railway.app** ‚≠ê (–ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
   - –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

2. **GitHub Actions + Vercel** (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ Vercel)
   - GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - Vercel —Ö—Ä–∞–Ω–∏—Ç –∫–æ–¥
   - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ

3. **Render.com** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Railway)
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ Railway
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

**Vercel —Å–∞–º –ø–æ —Å–µ–±–µ –ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç** –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –±–æ—Ç–∞, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å GitHub Actions –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–º–∏ cron —Å–µ—Ä–≤–∏—Å–∞–º–∏.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

| –í–∞—Ä–∏–∞–Ω—Ç | –°—Ç–æ–∏–º–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –ü—Ä–æ—Å—Ç–æ—Ç–∞ | –ü–æ–¥—Ö–æ–¥–∏—Ç? |
|---------|-----------|------------|----------|-----------|
| Vercel Cron | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
| Vercel + GitHub Actions | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚úÖ –î–∞ |
| Railway | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚úÖ‚úÖ –õ—É—á—à–∏–π |
| Render | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚úÖ –î–∞ |
| VPS | $5-10/–º–µ—Å | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚úÖ‚úÖ –ü—Ä–æ–¥–∞–∫—à–µ–Ω |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Vercel + GitHub Actions

1. **–°–æ–∑–¥–∞–π—Ç–µ `.github/workflows/daily-bot.yml`** (–∫–æ–¥ –≤—ã—à–µ)

2. **–î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:**
   - Settings ‚Üí Secrets ‚Üí Actions ‚Üí New secret
   - –î–æ–±–∞–≤—å—Ç–µ: `BOT_TOKEN`, `GRAPHQL_ENDPOINT`, `GROUP_CHAT_ID`, `CALENDAR_URL`

3. **–ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ø—É—à—å—Ç–µ:**
   ```bash
   git add .github/workflows/daily-bot.yml
   git commit -m "Add daily bot workflow"
   git push
   ```

4. **–ì–æ—Ç–æ–≤–æ!** GitHub Actions –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 UTC

---

**–í—ã–≤–æ–¥:** Vercel —Å–∞–º –ø–æ —Å–µ–±–µ –Ω–µ –≤—ã–¥–µ—Ä–∂–∏—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –±–æ—Ç, –Ω–æ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å GitHub Actions –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–º–∏ cron —Å–µ—Ä–≤–∏—Å–∞–º–∏ - –¥–∞! üéâ

```

```yaml
name: Daily Literary Calendar Bot

on:
  schedule:
    # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 UTC (12:00 –ø–æ –ú–æ—Å–∫–≤–µ)
    - cron: '0 9 * * *'
  workflow_dispatch:  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

jobs:
  send-daily-digest:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install -r requirements_bot.txt
      
      - name: Send daily digest
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          GRAPHQL_ENDPOINT: ${{ secrets.GRAPHQL_ENDPOINT }}
          GROUP_CHAT_ID: ${{ secrets.GROUP_CHAT_ID }}
          CALENDAR_URL: ${{ secrets.CALENDAR_URL }}
        run: |
          python send_daily.py
      
      - name: Notify on failure
        if: failure()
        run: |
          echo "‚ùå Daily digest failed to send"
          # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram –∏–ª–∏ email

```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏
–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ cron/GitHub Actions
"""

import asyncio
import logging
import os
import sys
from literary_calendar_bot import LiteraryCalendarBot

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏"""
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    bot_token = os.getenv('BOT_TOKEN')
    graphql_endpoint = os.getenv('GRAPHQL_ENDPOINT')
    group_chat_id = os.getenv('GROUP_CHAT_ID')
    calendar_url = os.getenv('CALENDAR_URL')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    if not all([bot_token, graphql_endpoint, group_chat_id]):
        logger.error("‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è!")
        logger.error("–¢—Ä–µ–±—É—é—Ç—Å—è: BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID")
        sys.exit(1)
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω
    if not calendar_url:
        calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
        logger.info("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è")
    
    logger.info("üöÄ –ó–∞–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏...")
    logger.info(f"üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å: {calendar_url[:50]}...")
    logger.info(f"üîó API: {graphql_endpoint}")
    logger.info(f"üë• –ì—Ä—É–ø–ø–∞: {group_chat_id}")
    
    try:
        # –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
        bot = LiteraryCalendarBot(
            bot_token=bot_token,
            calendar_url=calendar_url,
            graphql_endpoint=graphql_endpoint,
            group_chat_id=group_chat_id
        )
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–∞—Å—Å—ã–ª–∫—É
        await bot.send_daily_digest()
        
        logger.info("‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!")
        sys.exit(0)
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}", exc_info=True)
        sys.exit(1)


if __name__ == "__main__":
    asyncio.run(main())

```

```json
{
  "functions": {
    "api/*.js": {
      "maxDuration": 60
    },
    "api/*.py": {
      "runtime": "python3.9",
      "maxDuration": 60
    }
  },
  "crons": [
    {
      "path": "/api/send-daily",
      "schedule": "0 9 * * *"
    }
  ]
}

```

```javascript
/**
 * Vercel Serverless Function –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏
 * –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Vercel Cron Jobs
 */

export default async function handler(req, res) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö cron)
  const cronSecret = req.headers['x-cron-secret'] || req.query.secret;
  const expectedSecret = process.env.CRON_SECRET;
  
  if (expectedSecret && cronSecret !== expectedSecret) {
    return res.status(401).json({ 
      error: 'Unauthorized',
      message: 'Invalid cron secret' 
    });
  }
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–æ–¥ (–¥–ª—è Vercel Cron –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å GET)
  if (req.method !== 'GET' && req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }
  
  try {
    // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º Python —Å–∫—Ä–∏–ø—Ç —á–µ—Ä–µ–∑ child_process
    const { spawn } = require('child_process');
    const path = require('path');
    
    return new Promise((resolve, reject) => {
      const pythonScript = spawn('python3', [
        path.join(process.cwd(), 'send_daily.py')
      ], {
        env: {
          ...process.env,
          BOT_TOKEN: process.env.BOT_TOKEN,
          GRAPHQL_ENDPOINT: process.env.GRAPHQL_ENDPOINT,
          GROUP_CHAT_ID: process.env.GROUP_CHAT_ID,
          CALENDAR_URL: process.env.CALENDAR_URL
        }
      });
      
      let output = '';
      let errorOutput = '';
      
      pythonScript.stdout.on('data', (data) => {
        output += data.toString();
        console.log(data.toString());
      });
      
      pythonScript.stderr.on('data', (data) => {
        errorOutput += data.toString();
        console.error(data.toString());
      });
      
      pythonScript.on('close', (code) => {
        if (code === 0) {
          res.status(200).json({
            status: 'success',
            message: 'Daily digest sent successfully',
            output: output
          });
          resolve();
        } else {
          res.status(500).json({
            status: 'error',
            message: 'Failed to send daily digest',
            error: errorOutput,
            code: code
          });
          reject(new Error(`Python script exited with code ${code}`));
        }
      });
      
      pythonScript.on('error', (error) => {
        res.status(500).json({
          status: 'error',
          message: 'Failed to start Python script',
          error: error.message
        });
        reject(error);
      });
    });
    
  } catch (error) {
    console.error('Error:', error);
    return res.status(500).json({
      status: 'error',
      message: 'Internal server error',
      error: error.message
    });
  }
}

```


–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: Vercel —Å–∞–º –ø–æ —Å–µ–±–µ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –±–æ—Ç–∞, –Ω–æ –µ—Å—Ç—å —Ä–∞–±–æ—á–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

## –ü—Ä–æ–±–ª–µ–º–∞ —Å Vercel

Vercel ‚Äî serverless-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞:
- –§—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ –∑–∞–ø—Ä–æ—Å—É
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 60 —Å–µ–∫—É–Ω–¥ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ë–æ—Ç —Å `run_daily()` –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

## –†–µ—à–µ–Ω–∏—è –¥–ª—è Vercel

### –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel + GitHub Actions (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GitHub Actions –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

1. –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.github/workflows/daily-bot.yml` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 UTC
2. –°–æ–∑–¥–∞–Ω `send_daily.py` ‚Äî —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
3. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ

–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```bash
# 1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:
# Settings ‚Üí Secrets ‚Üí Actions ‚Üí New secret
# BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID, CALENDAR_URL

# 2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª—ã
git add .github/workflows/daily-bot.yml send_daily.py
git commit -m "Add GitHub Actions workflow"
git push

# 3. –ì–æ—Ç–æ–≤–æ! GitHub Actions –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Vercel Cron Jobs

–°–æ–∑–¥–∞–Ω `api/send-daily.js` –∏ `vercel.json` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Vercel Cron.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ú–∞–∫—Å–∏–º—É–º 60 —Å–µ–∫—É–Ω–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ú–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ—Ç—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–î–ª—è —ç—Ç–æ–≥–æ –±–æ—Ç–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

1. Railway.app ‚Äî –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
   - –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

2. GitHub Actions + Vercel (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω Vercel)
   - GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - Vercel —Ö—Ä–∞–Ω–∏—Ç –∫–æ–¥
   - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ

3. Render.com ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Railway
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ Railway
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –í–∞—Ä–∏–∞–Ω—Ç | –í—ã–¥–µ—Ä–∂–∏—Ç —Ä–∞—Å—Å—ã–ª–∫—É? | –°—Ç–æ–∏–º–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å |
|---------|-------------------|-----------|------------|
| Vercel Cron | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (60 —Å–µ–∫) | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê |
| Vercel + GitHub Actions | ‚úÖ –î–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê |
| Railway | ‚úÖ‚úÖ –î–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Render | ‚úÖ –î–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | ‚≠ê‚≠ê‚≠ê‚≠ê |

## –í—ã–≤–æ–¥

Vercel —Å–∞–º –ø–æ —Å–µ–±–µ –Ω–µ –≤—ã–¥–µ—Ä–∂–∏—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –±–æ—Ç, –Ω–æ:
- Vercel + GitHub Actions ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- Railway ‚Äî –ø—Ä–æ—â–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ

–°–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã:
- `vercel_deployment.md` ‚Äî –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `.github/workflows/daily-bot.yml` ‚Äî GitHub Actions workflow
- `send_daily.py` ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- `api/send-daily.js` ‚Äî Vercel serverless —Ñ—É–Ω–∫—Ü–∏—è

–†–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞—á–∞—Ç—å —Å Railway –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Actions —Å Vercel. –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞?

```shellscript
# 1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:
# Settings ‚Üí Secrets ‚Üí Actions ‚Üí New secret
# BOT_TOKEN, GRAPHQL_ENDPOINT, GROUP_CHAT_ID, CALENDAR_URL

# 2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª—ã
git add .github/workflows/daily-bot.yml send_daily.py
git commit -m "Add GitHub Actions workflow"
git push

# 3. –ì–æ—Ç–æ–≤–æ! GitHub Actions –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
```

---

**User**

@powershell (1-196) –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

**Cursor**


–ü—Ä–æ–±–ª–µ–º–∞: `aiohttp` —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –∞ –Ω–∞ Windows –Ω—É–∂–Ω—ã Microsoft C++ Build Tools. –û–±–Ω–æ–≤–ª—è—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:


```pip-requirements
python-telegram-bot>=20.7
aiohttp>=3.10.0


```


–ü—Ä–æ–±–ª–µ–º–∞: `aiohttp` —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –∞ –Ω–∞ Windows –Ω—É–∂–Ω—ã Microsoft Visual C++ Build Tools. –ò—Å–ø—Ä–∞–≤–ª—è—é: –æ–±–Ω–æ–≤–ª—è—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ø–µ—Ä–µ–≤–æ–∂—É –∫–æ–¥ –Ω–∞ `httpx` (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏).


```pip-requirements
python-telegram-bot>=20.7
httpx>=0.25.0


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with aiohttp.ClientSession() as session:
            async with session.get(self.calendar_url) as response:
                if response.status == 200:
                    return await response.text()
                else:
                    raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data and 'books' in data['data']:
                            return data['data']['books']
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data and 'books' in data['data']:
                            return data['data']['books']
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"}
                ) as response:
                    if response.status == 200:
                        data = await response.json()
                        if 'data' in data:
                            # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                            if 'tags' in data['data'] and data['data']['tags']:
                                tag_data = data['data']['tags'][0]
                                if 'books' in tag_data:
                                    return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        today = datetime.now().date()
        today_events = []
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if event_date == today:
                    today_events.append(event)
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```


–û–±–Ω–æ–≤–ª—è—é `sync_calendar_from_api.py`:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç
–∏–∑ GraphQL API –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è/—Å–º–µ—Ä—Ç–∏
3. –°–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ
"""

import asyncio
import logging
import re
from datetime import datetime
from typing import List, Dict, Optional
import httpx

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class CalendarSync:
    """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å API"""
    
    def __init__(
        self,
        graphql_endpoint: str,
        yandex_calendar_token: Optional[str] = None,
        calendar_id: Optional[str] = None
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞
        
        Args:
            graphql_endpoint: URL GraphQL API
            yandex_calendar_token: –¢–æ–∫–µ–Ω –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
            calendar_id: ID –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –Ø–Ω–¥–µ–∫—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        """
        self.graphql_endpoint = graphql_endpoint
        self.yandex_calendar_token = yandex_calendar_token
        self.calendar_id = calendar_id
    
    async def get_all_authors(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API"""
        query = """
        query GetAllAuthors {
          authors(body: {
            limit: 1000
            page: 1
          }) {
            uuid
            firstName
            lastName
            patronymic
            birthday
            deathday
            slug
            isActive
          }
        }
        """
        
        all_authors = []
        page = 1
        
        try:
            async with aiohttp.ClientSession() as session:
                while True:
                    query_with_page = query.replace('page: 1', f'page: {page}')
                    
                    async with session.post(
                        self.graphql_endpoint,
                        json={"query": query_with_page},
                        headers={"Content-Type": "application/json"}
                    ) as response:
                        if response.status == 200:
                            data = await response.json()
                            if 'data' in data and 'authors' in data['data']:
                                authors = data['data']['authors']
                                if not authors:
                                    break
                                all_authors.extend(authors)
                                logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã {page}: {len(authors)}")
                                
                                # –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –º–µ–Ω—å—à–µ —á–µ–º limit, –∑–Ω–∞—á–∏—Ç —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                                if len(authors) < 1000:
                                    break
                                page += 1
                            else:
                                logger.error(f"–û—à–∏–±–∫–∞ API: {data}")
                                break
                        else:
                            logger.error(f"–û—à–∏–±–∫–∞ HTTP: {response.status}")
                            break
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤: {e}")
        
        logger.info(f"–í—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤: {len(all_authors)}")
        return all_authors
    
    def parse_date(self, date_str: str) -> Optional[datetime]:
        """
        –ü–∞—Ä—Å–∏—Ç –¥–∞—Ç—É –∏–∑ —Å—Ç—Ä–æ–∫–∏
        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã: "1905", "1905-01-01", "01.01.1905"
        """
        if not date_str:
            return None
        
        date_str = date_str.strip()
        
        # –¢–æ–ª—å–∫–æ –≥–æ–¥
        if re.match(r'^\d{4}$', date_str):
            year = int(date_str)
            return datetime(year, 1, 1)
        
        # –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
        formats = [
            '%Y-%m-%d',
            '%d.%m.%Y',
            '%d/%m/%Y',
            '%Y-%m-%dT%H:%M:%S',
            '%Y-%m-%d %H:%M:%S',
        ]
        
        for fmt in formats:
            try:
                return datetime.strptime(date_str, fmt)
            except ValueError:
                continue
        
        logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: {date_str}")
        return None
    
    def format_author_name(self, author: Dict) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ–µ –∏–º—è –∞–≤—Ç–æ—Ä–∞"""
        parts = []
        if author.get('lastName'):
            parts.append(author['lastName'])
        if author.get('firstName'):
            parts.append(author['firstName'])
        if author.get('patronymic'):
            parts.append(author['patronymic'])
        return ' '.join(parts) if parts else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'
    
    def create_calendar_event(
        self,
        author: Dict,
        event_type: str,  # 'birthday' –∏–ª–∏ 'deathday'
        date: datetime
    ) -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        """
        author_name = self.format_author_name(author)
        author_uuid = author.get('uuid', '')
        author_slug = author.get('slug', '')
        
        if event_type == 'birthday':
            title = f"{author_name} —Ä–æ–¥–∏–ª—Å—è –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è {author_name}"
        else:
            title = f"{author_name} —É–º–µ—Ä –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å –ø–∞–º—è—Ç–∏ {author_name}"
        
        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
        if author_uuid:
            link = f"https://example.com/catalog?authors={author_uuid}&page=1"
            description += f"\n\n–ö–Ω–∏–≥–∏ {author_name} –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª\n{link}"
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        # –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç: "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
        months_ru = {
            1: '—è–Ω–≤–∞—Ä—è', 2: '—Ñ–µ–≤—Ä–∞–ª—è', 3: '–º–∞—Ä—Ç–∞', 4: '–∞–ø—Ä–µ–ª—è',
            5: '–º–∞—è', 6: '–∏—é–Ω—è', 7: '–∏—é–ª—è', 8: '–∞–≤–≥—É—Å—Ç–∞',
            9: '—Å–µ–Ω—Ç—è–±—Ä—è', 10: '–æ–∫—Ç—è–±—Ä—è', 11: '–Ω–æ—è–±—Ä—è', 12: '–¥–µ–∫–∞–±—Ä—è'
        }
        
        date_str = f"{date.day} {months_ru[date.month]} {date.year} 00:00"
        
        return {
            'title': title,
            'description': description,
            'date': date_str,
            'author_uuid': author_uuid,
            'author_name': author_name,
            'link': link if author_uuid else None
        }
    
    def generate_calendar_export(self, events: List[Dict]) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        (—Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å)
        """
        lines = []
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –ø–æ –¥–∞—Ç–µ
        events_sorted = sorted(events, key=lambda x: x['date'])
        
        for event in events_sorted:
            lines.append(f"# {event['title']}")
            lines.append(event['date'])
            if event.get('link'):
                lines.append(event['link'])
            if event.get('description'):
                # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
                desc = event['description'][:200]
                if desc:
                    lines.append(desc)
            lines.append("")  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏
        
        return "\n".join(lines)
    
    async def sync_author_events(self) -> List[Dict]:
        """
        –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        """
        authors = await self.get_all_authors()
        events = []
        
        for author in authors:
            if not author.get('isActive', True):
                continue
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è
            if author.get('birthday'):
                birth_date = self.parse_date(author['birthday'])
                if birth_date:
                    # –°–æ–∑–¥–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å –∏ –º–µ—Å—è—Ü)
                    event = self.create_calendar_event(author, 'birthday', birth_date)
                    events.append(event)
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è –ø–∞–º—è—Ç–∏ (—Å–º–µ—Ä—Ç–∏)
            if author.get('deathday'):
                death_date = self.parse_date(author['deathday'])
                if death_date:
                    event = self.create_calendar_event(author, 'deathday', death_date)
                    events.append(event)
        
        logger.info(f"–°–æ–∑–¥–∞–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    def save_to_file(self, events: List[Dict], filename: str = "literary_calendar_export.txt"):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–∞–π–ª"""
        calendar_text = self.generate_calendar_export(events)
        
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(calendar_text)
        
        logger.info(f"–°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
        return filename


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    OUTPUT_FILE = "literary_calendar_export.txt"
    # =====================
    
    sync = CalendarSync(
        graphql_endpoint=GRAPHQL_ENDPOINT,
        yandex_calendar_token=None,  # –ü–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º API –Ø–Ω–¥–µ–∫—Å
        calendar_id=None
    )
    
    print("üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    print(f"üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API: {GRAPHQL_ENDPOINT}")
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ API
    events = await sync.sync_author_events()
    
    if not events:
        print("‚ùå –°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API.")
        return
    
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª
    filename = sync.save_to_file(events, OUTPUT_FILE)
    
    print(f"\nüìÑ –°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å: https://calendar.yandex.ru")
    print("2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å '–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –¥–∞—Ç—ã'")
    print("3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Ñ–∞–π–ª–∞ (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é)")
    print("4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è")
    print("5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π
    print("\nüìÖ –ü—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π (–ø–µ—Ä–≤—ã–µ 5):")
    for i, event in enumerate(events[:5], 1):
        print(f"\n{i}. {event['title']}")
        print(f"   –î–∞—Ç–∞: {event['date']}")
        if event.get('link'):
            print(f"   –°—Å—ã–ª–∫–∞: {event['link']}")


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç
–∏–∑ GraphQL API –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è/—Å–º–µ—Ä—Ç–∏
3. –°–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ
"""

import asyncio
import logging
import re
from datetime import datetime
from typing import List, Dict, Optional
import httpx

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class CalendarSync:
    """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å API"""
    
    def __init__(
        self,
        graphql_endpoint: str,
        yandex_calendar_token: Optional[str] = None,
        calendar_id: Optional[str] = None
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞
        
        Args:
            graphql_endpoint: URL GraphQL API
            yandex_calendar_token: –¢–æ–∫–µ–Ω –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
            calendar_id: ID –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –Ø–Ω–¥–µ–∫—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        """
        self.graphql_endpoint = graphql_endpoint
        self.yandex_calendar_token = yandex_calendar_token
        self.calendar_id = calendar_id
    
    async def get_all_authors(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API"""
        query = """
        query GetAllAuthors {
          authors(body: {
            limit: 1000
            page: 1
          }) {
            uuid
            firstName
            lastName
            patronymic
            birthday
            deathday
            slug
            isActive
          }
        }
        """
        
        all_authors = []
        page = 1
        
        try:
            async with httpx.AsyncClient(timeout=60.0) as client:
                while True:
                    query_with_page = query.replace('page: 1', f'page: {page}')
                    
                    response = await client.post(
                        self.graphql_endpoint,
                        json={"query": query_with_page},
                        headers={"Content-Type": "application/json"}
                    )
                    
                    if response.status_code == 200:
                        data = response.json()
                        if 'data' in data and 'authors' in data['data']:
                            authors = data['data']['authors']
                            if not authors:
                                break
                            all_authors.extend(authors)
                            logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã {page}: {len(authors)}")
                            
                            # –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –º–µ–Ω—å—à–µ —á–µ–º limit, –∑–Ω–∞—á–∏—Ç —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                            if len(authors) < 1000:
                                break
                            page += 1
                        else:
                            logger.error(f"–û—à–∏–±–∫–∞ API: {data}")
                            break
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ HTTP: {response.status_code}")
                        break
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤: {e}")
        
        logger.info(f"–í—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ –∞–≤—Ç–æ—Ä–æ–≤: {len(all_authors)}")
        return all_authors
    
    def parse_date(self, date_str: str) -> Optional[datetime]:
        """
        –ü–∞—Ä—Å–∏—Ç –¥–∞—Ç—É –∏–∑ —Å—Ç—Ä–æ–∫–∏
        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã: "1905", "1905-01-01", "01.01.1905"
        """
        if not date_str:
            return None
        
        date_str = date_str.strip()
        
        # –¢–æ–ª—å–∫–æ –≥–æ–¥
        if re.match(r'^\d{4}$', date_str):
            year = int(date_str)
            return datetime(year, 1, 1)
        
        # –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
        formats = [
            '%Y-%m-%d',
            '%d.%m.%Y',
            '%d/%m/%Y',
            '%Y-%m-%dT%H:%M:%S',
            '%Y-%m-%d %H:%M:%S',
        ]
        
        for fmt in formats:
            try:
                return datetime.strptime(date_str, fmt)
            except ValueError:
                continue
        
        logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: {date_str}")
        return None
    
    def format_author_name(self, author: Dict) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ–µ –∏–º—è –∞–≤—Ç–æ—Ä–∞"""
        parts = []
        if author.get('lastName'):
            parts.append(author['lastName'])
        if author.get('firstName'):
            parts.append(author['firstName'])
        if author.get('patronymic'):
            parts.append(author['patronymic'])
        return ' '.join(parts) if parts else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'
    
    def create_calendar_event(
        self,
        author: Dict,
        event_type: str,  # 'birthday' –∏–ª–∏ 'deathday'
        date: datetime
    ) -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        """
        author_name = self.format_author_name(author)
        author_uuid = author.get('uuid', '')
        author_slug = author.get('slug', '')
        
        if event_type == 'birthday':
            title = f"{author_name} —Ä–æ–¥–∏–ª—Å—è –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è {author_name}"
        else:
            title = f"{author_name} —É–º–µ—Ä –≤ {date.year} –≥–æ–¥—É"
            description = f"–î–µ–Ω—å –ø–∞–º—è—Ç–∏ {author_name}"
        
        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
        if author_uuid:
            link = f"https://example.com/catalog?authors={author_uuid}&page=1"
            description += f"\n\n–ö–Ω–∏–≥–∏ {author_name} –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª\n{link}"
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        # –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç: "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
        months_ru = {
            1: '—è–Ω–≤–∞—Ä—è', 2: '—Ñ–µ–≤—Ä–∞–ª—è', 3: '–º–∞—Ä—Ç–∞', 4: '–∞–ø—Ä–µ–ª—è',
            5: '–º–∞—è', 6: '–∏—é–Ω—è', 7: '–∏—é–ª—è', 8: '–∞–≤–≥—É—Å—Ç–∞',
            9: '—Å–µ–Ω—Ç—è–±—Ä—è', 10: '–æ–∫—Ç—è–±—Ä—è', 11: '–Ω–æ—è–±—Ä—è', 12: '–¥–µ–∫–∞–±—Ä—è'
        }
        
        date_str = f"{date.day} {months_ru[date.month]} {date.year} 00:00"
        
        return {
            'title': title,
            'description': description,
            'date': date_str,
            'author_uuid': author_uuid,
            'author_name': author_name,
            'link': link if author_uuid else None
        }
    
    def generate_calendar_export(self, events: List[Dict]) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        (—Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å)
        """
        lines = []
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –ø–æ –¥–∞—Ç–µ
        events_sorted = sorted(events, key=lambda x: x['date'])
        
        for event in events_sorted:
            lines.append(f"# {event['title']}")
            lines.append(event['date'])
            if event.get('link'):
                lines.append(event['link'])
            if event.get('description'):
                # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
                desc = event['description'][:200]
                if desc:
                    lines.append(desc)
            lines.append("")  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏
        
        return "\n".join(lines)
    
    async def sync_author_events(self) -> List[Dict]:
        """
        –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ API
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        """
        authors = await self.get_all_authors()
        events = []
        
        for author in authors:
            if not author.get('isActive', True):
                continue
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è
            if author.get('birthday'):
                birth_date = self.parse_date(author['birthday'])
                if birth_date:
                    # –°–æ–∑–¥–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å –∏ –º–µ—Å—è—Ü)
                    event = self.create_calendar_event(author, 'birthday', birth_date)
                    events.append(event)
            
            # –°–æ–±—ã—Ç–∏–µ –¥–Ω—è –ø–∞–º—è—Ç–∏ (—Å–º–µ—Ä—Ç–∏)
            if author.get('deathday'):
                death_date = self.parse_date(author['deathday'])
                if death_date:
                    event = self.create_calendar_event(author, 'deathday', death_date)
                    events.append(event)
        
        logger.info(f"–°–æ–∑–¥–∞–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    def save_to_file(self, events: List[Dict], filename: str = "literary_calendar_export.txt"):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–∞–π–ª"""
        calendar_text = self.generate_calendar_export(events)
        
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(calendar_text)
        
        logger.info(f"–°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
        return filename


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    OUTPUT_FILE = "literary_calendar_export.txt"
    # =====================
    
    sync = CalendarSync(
        graphql_endpoint=GRAPHQL_ENDPOINT,
        yandex_calendar_token=None,  # –ü–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º API –Ø–Ω–¥–µ–∫—Å
        calendar_id=None
    )
    
    print("üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    print(f"üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API: {GRAPHQL_ENDPOINT}")
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ API
    events = await sync.sync_author_events()
    
    if not events:
        print("‚ùå –°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API.")
        return
    
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª
    filename = sync.save_to_file(events, OUTPUT_FILE)
    
    print(f"\nüìÑ –°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å: https://calendar.yandex.ru")
    print("2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å '–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –¥–∞—Ç—ã'")
    print("3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Ñ–∞–π–ª–∞ (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é)")
    print("4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è")
    print("5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π
    print("\nüìÖ –ü—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π (–ø–µ—Ä–≤—ã–µ 5):")
    for i, event in enumerate(events[:5], 1):
        print(f"\n{i}. {event['title']}")
        print(f"   –î–∞—Ç–∞: {event['date']}")
        if event.get('link'):
            print(f"   –°—Å—ã–ª–∫–∞: {event['link']}")


if __name__ == "__main__":
    asyncio.run(main())


```


–û–±–Ω–æ–≤–ª—è—é `test_bot.py`:


```python
"""
–ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ–ª–Ω–æ–≥–æ –±–æ—Ç–∞
"""

import asyncio
import httpx
from literary_calendar_bot import LiteraryCalendarBot

async def test_calendar_parsing():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    async with httpx.AsyncClient() as client:
        response = await client.get(calendar_url)
        if response.status_code == 200:
            content = response.text
            print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(content)} —Å–∏–º–≤–æ–ª–æ–≤)")
                
                # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
                bot = LiteraryCalendarBot(
                    bot_token="dummy",
                    calendar_url=calendar_url,
                    graphql_endpoint="dummy",
                    group_chat_id="dummy"
                )
                
                events = bot.parse_calendar(content)
                print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 —Å–æ–±—ã—Ç–∏—è
                for i, event in enumerate(events[:3], 1):
                    print(f"\nüìÖ –°–æ–±—ã—Ç–∏–µ {i}:")
                    print(f"   –ù–∞–∑–≤–∞–Ω–∏–µ: {event['title']}")
                    print(f"   –î–∞—Ç–∞: {event['start_date']}")
                    print(f"   –ê–≤—Ç–æ—Ä—ã UUID: {event['author_uuids']}")
                    print(f"   –¢–µ–≥–∏: {event['tags']}")
                    print(f"   –°—Å—ã–ª–∫–∏: {len(event['links'])}")
                
                return True
            else:
                print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {response.status}")
                return False

async def test_today_events():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
    print("\nüìÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    events = await bot.get_today_events()
    
    if events:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {len(events)}")
        for event in events:
            print(f"\nüìö {event['title']}")
            if event['start_date']:
                print(f"   –î–∞—Ç–∞: {event['start_date']}")
            if event['author_uuids']:
                print(f"   –ê–≤—Ç–æ—Ä—ã: {event['author_uuids']}")
    else:
        print("‚ÑπÔ∏è  –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ—Ç")
    
    return events

async def test_message_formatting():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    print("\nüí¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π...")
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url="dummy",
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
    test_event = {
        'title': '–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É',
        'start_date': None,
        'end_date': None,
        'description': '–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏',
        'author_uuids': ['c52f926c-dde3-4631-b1cf-4a8849ad5be9'],
        'tags': [],
        'links': ['https://example.com/catalog?authors=c52f926c-dde3-4631-b1cf-4a8849ad5be9&page=1']
    }
    
    test_books = [
        {'uuid': '1', 'name': '–í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥', 'slug': 'vishnevyy-sad'},
        {'uuid': '2', 'name': '–î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π', 'slug': 'dama-s-sobachkoy'}
    ]
    
    message = bot.format_event_message(test_event, test_books)
    print("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ:")
    print("\n" + "="*50)
    print(message)
    print("="*50)

async def main():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã"""
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è\n")
    
    # –¢–µ—Å—Ç 1: –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    await test_calendar_parsing()
    
    # –¢–µ—Å—Ç 2: –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    await test_today_events()
    
    # –¢–µ—Å—Ç 3: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
    await test_message_formatting()
    
    print("\n‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather")
    print("2. –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @userinfobot)")
    print("3. –£–∑–Ω–∞–π—Ç–µ URL GraphQL API")
    print("4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ literary_calendar_bot_config.py")
    print("5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ literary_calendar_bot.py")

if __name__ == "__main__":
    asyncio.run(main())


```

```markdown
# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `aiohttp==3.9.1` –Ω–∞ Windows –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
error: Microsoft Visual C++ 14.0 or greater is required
```

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è `aiohttp` —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–Ø –∑–∞–º–µ–Ω–∏–ª `aiohttp` –Ω–∞ `httpx`, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- ‚úÖ –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `python-telegram-bot`
- ‚úÖ –ò–º–µ–µ—Ç –ø–æ—Ö–æ–∂–∏–π API
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

1. **`requirements_bot.txt`** - –∑–∞–º–µ–Ω–µ–Ω `aiohttp` –Ω–∞ `httpx`
2. **`literary_calendar_bot.py`** - –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `httpx`
3. **`sync_calendar_from_api.py`** - –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `httpx`
4. **`test_bot.py`** - –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `httpx`

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
pip install -r requirements_bot.txt
```

–î–æ–ª–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫! ‚úÖ

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
python test_bot.py
```

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—Ç–ª–∏—á–Ω–æ! üéâ

## üìù –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å aiohttp)

–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ `aiohttp`, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Microsoft C++ Build Tools:

1. –°–∫–∞—á–∞–π—Ç–µ: https://visualstudio.microsoft.com/visual-cpp-build-tools/
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ "Desktop development with C++"
3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ù–æ `httpx` —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤! üëç

```


–ò—Å–ø—Ä–∞–≤–∏–ª –ø—Ä–æ–±–ª–µ–º—É. –í–æ—Ç —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

## –ü—Ä–æ–±–ª–µ–º–∞

`aiohttp==3.9.1` —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –Ω–∞ Windows, –¥–ª—è —á–µ–≥–æ –Ω—É–∂–Ω—ã Microsoft Visual C++ Build Tools.

## –†–µ—à–µ–Ω–∏–µ

–ó–∞–º–µ–Ω–µ–Ω `aiohttp` –Ω–∞ `httpx`, –∫–æ—Ç–æ—Ä—ã–π:
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `python-telegram-bot`
- –ò–º–µ–µ—Ç –ø–æ—Ö–æ–∂–∏–π API
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

## –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

1. `requirements_bot.txt` ‚Äî –∑–∞–º–µ–Ω–µ–Ω `aiohttp` –Ω–∞ `httpx`, —É–±—Ä–∞–Ω `asyncio` (–æ–Ω –≤—Å—Ç—Ä–æ–µ–Ω –≤ Python)
2. `literary_calendar_bot.py` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `httpx`
3. `sync_calendar_from_api.py` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥
4. `test_bot.py` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–¢–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
pip install -r requirements_bot.txt
```

–î–æ–ª–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:

```bash
python test_bot.py
```

–≠—Ç–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π.

## –ß—Ç–æ –¥–∞–ª—å—à–µ

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements_bot.txt`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ: `python test_bot.py`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: –∑–∞–ø–æ–ª–Ω–∏—Ç–µ `literary_calendar_bot_config.py`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python run_bot.py`

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã ‚Äî —Å–æ–æ–±—â–∏—Ç–µ.

```shellscript
pip install -r requirements_bot.txt
```

```shellscript
python test_bot.py
```

---

**User**

@powershell (217-220) 

---

**Cursor**


–ü—Ä–æ–≤–µ—Ä—è—é –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é –æ—à–∏–±–∫—É –æ—Ç—Å—Ç—É–ø–æ–≤ –≤ `test_bot.py`:



–ò—Å–ø—Ä–∞–≤–ª—è—é –æ—Ç—Å—Ç—É–ø—ã –∏ –∑–∞–º–µ–Ω—è—é `response.status` –Ω–∞ `response.status_code`:


```python
"""
–ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ–ª–Ω–æ–≥–æ –±–æ—Ç–∞
"""

import asyncio
import httpx
from literary_calendar_bot import LiteraryCalendarBot

async def test_calendar_parsing():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    async with httpx.AsyncClient() as client:
        response = await client.get(calendar_url)
        if response.status_code == 200:
            content = response.text
            print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(content)} —Å–∏–º–≤–æ–ª–æ–≤)")
            
            # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
            bot = LiteraryCalendarBot(
                bot_token="dummy",
                calendar_url=calendar_url,
                graphql_endpoint="dummy",
                group_chat_id="dummy"
            )
            
            events = bot.parse_calendar(content)
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 —Å–æ–±—ã—Ç–∏—è
            for i, event in enumerate(events[:3], 1):
                print(f"\nüìÖ –°–æ–±—ã—Ç–∏–µ {i}:")
                print(f"   –ù–∞–∑–≤–∞–Ω–∏–µ: {event['title']}")
                print(f"   –î–∞—Ç–∞: {event['start_date']}")
                print(f"   –ê–≤—Ç–æ—Ä—ã UUID: {event['author_uuids']}")
                print(f"   –¢–µ–≥–∏: {event['tags']}")
                print(f"   –°—Å—ã–ª–∫–∏: {len(event['links'])}")
            
            return True
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {response.status_code}")
            return False

async def test_today_events():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
    print("\nüìÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è...")
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    events = await bot.get_today_events()
    
    if events:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {len(events)}")
        for event in events:
            print(f"\nüìö {event['title']}")
            if event['start_date']:
                print(f"   –î–∞—Ç–∞: {event['start_date']}")
            if event['author_uuids']:
                print(f"   –ê–≤—Ç–æ—Ä—ã: {event['author_uuids']}")
    else:
        print("‚ÑπÔ∏è  –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ—Ç")
    
    return events

async def test_message_formatting():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    print("\nüí¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π...")
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url="dummy",
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
    test_event = {
        'title': '–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É',
        'start_date': None,
        'end_date': None,
        'description': '–ö–Ω–∏–≥–∏ –ß–µ—Ö–æ–≤–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏',
        'author_uuids': ['c52f926c-dde3-4631-b1cf-4a8849ad5be9'],
        'tags': [],
        'links': ['https://example.com/catalog?authors=c52f926c-dde3-4631-b1cf-4a8849ad5be9&page=1']
    }
    
    test_books = [
        {'uuid': '1', 'name': '–í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥', 'slug': 'vishnevyy-sad'},
        {'uuid': '2', 'name': '–î–∞–º–∞ —Å —Å–æ–±–∞—á–∫–æ–π', 'slug': 'dama-s-sobachkoy'}
    ]
    
    message = bot.format_event_message(test_event, test_books)
    print("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ:")
    print("\n" + "="*50)
    print(message)
    print("="*50)

async def main():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã"""
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è\n")
    
    # –¢–µ—Å—Ç 1: –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    await test_calendar_parsing()
    
    # –¢–µ—Å—Ç 2: –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    await test_today_events()
    
    # –¢–µ—Å—Ç 3: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
    await test_message_formatting()
    
    print("\n‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("\nüìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather")
    print("2. –£–∑–Ω–∞–π—Ç–µ ID –≥—Ä—É–ø–ø—ã (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ @userinfobot)")
    print("3. –£–∑–Ω–∞–π—Ç–µ URL GraphQL API")
    print("4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ literary_calendar_bot_config.py")
    print("5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ literary_calendar_bot.py")

if __name__ == "__main__":
    asyncio.run(main())


```


–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ `test_bot.py`. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç—Å—Ç—É–ø–∞—Ö –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 20.

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 21-42
2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ `response.status` ‚Üí `response.status_code` (–¥–ª—è httpx)

–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:

```bash
python test_bot.py
```

–î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫.

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:
- –ó–∞–≥—Ä—É–∑–∫—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

–ï—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ ‚Äî —Å–æ–æ–±—â–∏—Ç–µ.

```shellscript
python test_bot.py
```

---

**User**

—á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–π–º—É. —Å–µ–≥–æ–¥–Ω—è 6 –¥–µ–∫–∞–±—Ä—è 2025 –≥–æ–¥–∞. –∏ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏–µ!

---

**Cursor**


–ü—Ä–æ–≤–µ—Ä—è—é –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è. –í–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –∏–ª–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –¥–∞—Ç. –ò–∑—É—á–∞—é –∫–æ–¥:



–ü—Ä–æ–≤–µ—Ä—è—é –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç–æ–π. –°–æ–∑–¥–∞—é –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:


```python
"""
–û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
"""

import asyncio
import httpx
from datetime import datetime
from literary_calendar_bot import LiteraryCalendarBot

async def debug_calendar():
    """–û—Ç–ª–∞–¥–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""
    
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    print("=" * 60)
    print("üîç –û–¢–õ–ê–î–ö–ê –ü–ê–†–°–ò–ù–ì–ê –ö–ê–õ–ï–ù–î–ê–†–Ø")
    print("=" * 60)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    print("\n1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    xml_content = await bot.fetch_calendar()
    print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤)")
    
    # –ü–∞—Ä—Å–∏–º —Å–æ–±—ã—Ç–∏—è
    print("\n2Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...")
    all_events = bot.parse_calendar(xml_content)
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ –≤—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π: {len(all_events)}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
    today = datetime.now().date()
    print(f"\nüìÖ –°–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞: {today}")
    print(f"   –§–æ—Ä–º–∞—Ç: {today.strftime('%d.%m.%Y')}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å –¥–∞—Ç–∞–º–∏
    print("\n3Ô∏è‚É£ –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Å –¥–∞—Ç–∞–º–∏:")
    print("-" * 60)
    
    today_events = []
    for i, event in enumerate(all_events[:20], 1):  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 20
        if event['start_date']:
            event_date = event['start_date']
            event_date_only = event_date.date()
            is_today = event_date_only == today
            
            status = "‚úÖ –°–ï–ì–û–î–ù–Ø!" if is_today else "  "
            
            print(f"{status} {i}. {event['title'][:50]}")
            print(f"      –î–∞—Ç–∞: {event_date.strftime('%d.%m.%Y %H:%M')}")
            print(f"      –¢–æ–ª—å–∫–æ –¥–∞—Ç–∞: {event_date_only}")
            print(f"      –°–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Å–µ–≥–æ–¥–Ω—è: {is_today}")
            
            if is_today:
                today_events.append(event)
        else:
            print(f"   {i}. {event['title'][:50]} - –ë–ï–ó –î–ê–¢–´")
    
    print("-" * 60)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    print(f"\n4Ô∏è‚É£ –°–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è ({today}):")
    if today_events:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {len(today_events)}")
        for event in today_events:
            print(f"\nüìö {event['title']}")
            print(f"   –î–∞—Ç–∞: {event['start_date']}")
            print(f"   –ê–≤—Ç–æ—Ä—ã UUID: {event['author_uuids']}")
            print(f"   –°—Å—ã–ª–∫–∏: {len(event['links'])}")
    else:
        print("‚ùå –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è
        print("\n5Ô∏è‚É£ –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 7 –¥–Ω–µ–π):")
        from datetime import timedelta
        week_later = today + timedelta(days=7)
        
        upcoming = []
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                if today <= event_date <= week_later:
                    upcoming.append((event_date, event))
        
        upcoming.sort(key=lambda x: x[0])
        
        for event_date, event in upcoming[:10]:
            days_diff = (event_date - today).days
            if days_diff == 0:
                print(f"   üéØ –°–ï–ì–û–î–ù–Ø: {event['title'][:50]}")
            elif days_diff == 1:
                print(f"   üìÖ –ó–ê–í–¢–†–ê: {event['title'][:50]}")
            else:
                print(f"   üìÖ –ß–µ—Ä–µ–∑ {days_diff} –¥–Ω–µ–π ({event_date}): {event['title'][:50]}")
    
    print("\n" + "=" * 60)
    print("‚úÖ –û—Ç–ª–∞–¥–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    print("=" * 60)

if __name__ == "__main__":
    asyncio.run(debug_calendar())

```


–°–æ–∑–¥–∞–Ω –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

```bash
python debug_calendar.py
```

–û–Ω –ø–æ–∫–∞–∂–µ—Ç:
- –í—Å–µ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –î–∞—Ç—ã —Å–æ–±—ã—Ç–∏–π
- –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è "—Å–µ–≥–æ–¥–Ω—è"
- –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
2. –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å (—Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –≤ UTC, –∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ ‚Äî –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏)
3. –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

–¢–∞–∫–∂–µ —É–ª—É—á—à–∞—é —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç, —á—Ç–æ–±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å:


```shellscript
python debug_calendar.py
```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
        xml_content = await self.fetch_calendar()
        all_events = self.parse_calendar(xml_content)
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (Europe/Moscow)
        today = datetime.now().date()
        today_events = []
        
        logger.info(f"–ò—â–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {today}")
        logger.info(f"–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ: {len(all_events)}")
        
        for event in all_events:
            if event['start_date']:
                event_date = event['start_date'].date()
                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É (–±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏)
                if event_date == today:
                    today_events.append(event)
                    logger.info(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {event['title']} ({event_date})")
        
        if not today_events:
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            logger.info("–°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è:")
            from datetime import timedelta
            week_later = today + timedelta(days=7)
            for event in all_events:
                if event['start_date']:
                    event_date = event['start_date'].date()
                    if today <= event_date <= week_later:
                        days_diff = (event_date - today).days
                        logger.info(f"  –ß–µ—Ä–µ–∑ {days_diff} –¥–Ω–µ–π ({event_date}): {event['title'][:50]}")
        
        return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```


–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python debug_calendar.py
```

–û–Ω –ø–æ–∫–∞–∂–µ—Ç:
- –í—Å–µ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –î–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
- –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è "—Å–µ–≥–æ–¥–Ω—è"
- –ü–æ—á–µ–º—É —Å–æ–±—ã—Ç–∏–µ 6 –¥–µ–∫–∞–±—Ä—è –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è

–¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ ‚Äî —Ç–∞–º –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞–π–¥–µ–Ω—ã.

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. –î–∞—Ç–∞ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º —Ä—É—Å—Å–∫–∏—Ö –º–µ—Å—è—Ü–µ–≤
3. –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `debug_calendar.py` –∏ –ø—Ä–∏—à–ª–∏—Ç–µ –≤—ã–≤–æ–¥ ‚Äî –ø–æ –Ω–µ–º—É –æ–ø—Ä–µ–¥–µ–ª—é –ø—Ä–æ–±–ª–µ–º—É.

```shellscript
python debug_calendar.py
```

```shellscript
python debug_calendar.py
```

---

**User**

–¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –±–∞–∑—É —Å–æ–±—ã—Ç–∏–π –Ω–µ –≤ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –±–∞–∑–µ. –∏ –¥–æ–±–∞–≤–∏–º —Ñ–æ—Ä–º—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π. —Ç–∞–º –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (–ø–æ—Ç–æ–º –æ–Ω–æ –±—É–¥–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–æ –∂–∏—Ä–Ω—ã–º), –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ. –∏ –∏–º—è –∞–≤—Ç–æ—Ä–∞ (–∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏), –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ API

---

**Cursor**


–°–æ–∑–¥–∞—é —Å–∏—Å—Ç–µ–º—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –≤–µ–±-—Ñ–æ—Ä–º–æ–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏.


```python
"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
"""

import sqlite3
import logging
from datetime import datetime
from typing import List, Dict, Optional
from pathlib import Path

logger = logging.getLogger(__name__)

DB_PATH = Path("literary_events.db")


class EventDatabase:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π"""
    
    def __init__(self, db_path: str = None):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        
        Args:
            db_path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        """
        self.db_path = db_path or str(DB_PATH)
        self.init_database()
    
    def get_connection(self):
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö"""
        conn = sqlite3.connect(self.db_path)
        conn.row_factory = sqlite3.Row  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ —Å–ª–æ–≤–∞—Ä–∏
        return conn
    
    def init_database(self):
        """–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        # –¢–∞–±–ª–∏—Ü–∞ —Å–æ–±—ã—Ç–∏–π
        cursor.execute("""
            CREATE TABLE IF NOT EXISTS events (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                title TEXT NOT NULL,
                description TEXT,
                event_date DATE NOT NULL,
                event_type TEXT NOT NULL,  -- 'author', 'tag', 'category', 'custom'
                reference_uuid TEXT,  -- UUID –∞–≤—Ç–æ—Ä–∞, —Ç–µ–≥–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                reference_name TEXT,  -- –ù–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                is_active BOOLEAN DEFAULT 1
            )
        """)
        
        # –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –¥–∞—Ç–µ
        cursor.execute("""
            CREATE INDEX IF NOT EXISTS idx_event_date 
            ON events(event_date)
        """)
        
        # –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
        cursor.execute("""
            CREATE INDEX IF NOT EXISTS idx_is_active 
            ON events(is_active)
        """)
        
        conn.commit()
        conn.close()
        logger.info("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")
    
    def add_event(
        self,
        title: str,
        event_date: datetime,
        event_type: str,
        description: str = None,
        reference_uuid: str = None,
        reference_name: str = None,
        is_active: bool = True
    ) -> int:
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
        
        Returns:
            ID —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
        """
        conn = self.get_connection()
        cursor = conn.cursor()
        
        cursor.execute("""
            INSERT INTO events 
            (title, description, event_date, event_type, reference_uuid, reference_name, is_active)
            VALUES (?, ?, ?, ?, ?, ?, ?)
        """, (
            title,
            description,
            event_date.date(),
            event_type,
            reference_uuid,
            reference_name,
            is_active
        ))
        
        event_id = cursor.lastrowid
        conn.commit()
        conn.close()
        
        logger.info(f"–î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {title} ({event_date.date()})")
        return event_id
    
    def get_events_by_date(self, date: datetime) -> List[Dict]:
        """
        –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É
        
        Args:
            date: –î–∞—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
            
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
        """
        conn = self.get_connection()
        cursor = conn.cursor()
        
        cursor.execute("""
            SELECT * FROM events
            WHERE event_date = ? AND is_active = 1
            ORDER BY event_date, title
        """, (date.date(),))
        
        rows = cursor.fetchall()
        conn.close()
        
        events = []
        for row in rows:
            events.append({
                'id': row['id'],
                'title': row['title'],
                'description': row['description'],
                'event_date': datetime.strptime(row['event_date'], '%Y-%m-%d').date(),
                'event_type': row['event_type'],
                'reference_uuid': row['reference_uuid'],
                'reference_name': row['reference_name'],
                'created_at': row['created_at'],
                'updated_at': row['updated_at']
            })
        
        return events
    
    def get_all_events(
        self,
        limit: int = None,
        offset: int = 0,
        is_active: bool = True
    ) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        query = """
            SELECT * FROM events
            WHERE is_active = ?
            ORDER BY event_date DESC, title
        """
        params = [is_active]
        
        if limit:
            query += " LIMIT ? OFFSET ?"
            params.extend([limit, offset])
        
        cursor.execute(query, params)
        rows = cursor.fetchall()
        conn.close()
        
        events = []
        for row in rows:
            events.append({
                'id': row['id'],
                'title': row['title'],
                'description': row['description'],
                'event_date': datetime.strptime(row['event_date'], '%Y-%m-%d').date(),
                'event_type': row['event_type'],
                'reference_uuid': row['reference_uuid'],
                'reference_name': row['reference_name'],
                'created_at': row['created_at'],
                'updated_at': row['updated_at']
            })
        
        return events
    
    def update_event(
        self,
        event_id: int,
        title: str = None,
        description: str = None,
        event_date: datetime = None,
        is_active: bool = None
    ) -> bool:
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        updates = []
        params = []
        
        if title is not None:
            updates.append("title = ?")
            params.append(title)
        if description is not None:
            updates.append("description = ?")
            params.append(description)
        if event_date is not None:
            updates.append("event_date = ?")
            params.append(event_date.date())
        if is_active is not None:
            updates.append("is_active = ?")
            params.append(is_active)
        
        if not updates:
            return False
        
        updates.append("updated_at = CURRENT_TIMESTAMP")
        params.append(event_id)
        
        query = f"UPDATE events SET {', '.join(updates)} WHERE id = ?"
        cursor.execute(query, params)
        
        conn.commit()
        conn.close()
        
        logger.info(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ ID: {event_id}")
        return cursor.rowcount > 0
    
    def delete_event(self, event_id: int) -> bool:
        """–£–¥–∞–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç is_active = 0)"""
        return self.update_event(event_id, is_active=False)
    
    def get_event_by_id(self, event_id: int) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –ø–æ ID"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        cursor.execute("SELECT * FROM events WHERE id = ?", (event_id,))
        row = cursor.fetchone()
        conn.close()
        
        if not row:
            return None
        
        return {
            'id': row['id'],
            'title': row['title'],
            'description': row['description'],
            'event_date': datetime.strptime(row['event_date'], '%Y-%m-%d').date(),
            'event_type': row['event_type'],
            'reference_uuid': row['reference_uuid'],
            'reference_name': row['reference_name'],
            'created_at': row['created_at'],
            'updated_at': row['updated_at']
        }

```

```python
"""
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–æ–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
"""

from flask import Flask, render_template, request, jsonify, redirect, url_for, flash
from datetime import datetime
import logging
from database import EventDatabase
import httpx
import asyncio

app = Flask(__name__)
app.secret_key = 'your-secret-key-change-this-in-production'  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

db = EventDatabase()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# URL GraphQL API (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥)
GRAPHQL_ENDPOINT = None  # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥


async def fetch_from_graphql(query: str, variables: dict = None):
    """–í—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ GraphQL API"""
    if not GRAPHQL_ENDPOINT:
        return None
    
    try:
        async with httpx.AsyncClient(timeout=30.0) as client:
            response = await client.post(
                GRAPHQL_ENDPOINT,
                json={"query": query, "variables": variables or {}},
                headers={"Content-Type": "application/json"}
            )
            if response.status_code == 200:
                return response.json()
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ GraphQL –∑–∞–ø—Ä–æ—Å–∞: {e}")
    return None


def run_async(coro):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é"""
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    try:
        return loop.run_until_complete(coro)
    finally:
        loop.close()


@app.route('/')
def index():
    """–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–æ–±—ã—Ç–∏–π"""
    events = db.get_all_events(limit=50)
    return render_template('index.html', events=events)


@app.route('/add', methods=['GET', 'POST'])
def add_event():
    """–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è"""
    if request.method == 'POST':
        try:
            # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
            title = request.form.get('title', '').strip()
            description = request.form.get('description', '').strip()
            event_date_str = request.form.get('event_date', '')
            event_type = request.form.get('event_type', 'custom')
            reference_uuid = request.form.get('reference_uuid', '').strip() or None
            reference_name = request.form.get('reference_name', '').strip() or None
            
            # –í–∞–ª–∏–¥–∞—Ü–∏—è
            if not title:
                flash('–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!', 'error')
                return redirect(url_for('add_event'))
            
            if not event_date_str:
                flash('–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞!', 'error')
                return redirect(url_for('add_event'))
            
            # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É
            try:
                event_date = datetime.strptime(event_date_str, '%Y-%m-%d')
            except ValueError:
                flash('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ì–ì–ì–ì-–ú–ú-–î–î', 'error')
                return redirect(url_for('add_event'))
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            event_id = db.add_event(
                title=title,
                description=description,
                event_date=event_date,
                event_type=event_type,
                reference_uuid=reference_uuid,
                reference_name=reference_name
            )
            
            flash(f'–°–æ–±—ã—Ç–∏–µ "{title}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success')
            return redirect(url_for('index'))
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è: {e}")
            flash(f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è: {str(e)}', 'error')
            return redirect(url_for('add_event'))
    
    # GET –∑–∞–ø—Ä–æ—Å - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
    return render_template('add_event.html')


@app.route('/api/authors')
def api_authors():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤"""
    query = """
    query GetAuthors {
      authors(body: {
        limit: 100
        page: 1
      }) {
        uuid
        firstName
        lastName
        patronymic
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'authors' in result['data']:
        authors = []
        for author in result['data']['authors']:
            name_parts = []
            if author.get('lastName'):
                name_parts.append(author['lastName'])
            if author.get('firstName'):
                name_parts.append(author['firstName'])
            if author.get('patronymic'):
                name_parts.append(author['patronymic'])
            
            full_name = ' '.join(name_parts) if name_parts else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'
            
            authors.append({
                'uuid': author['uuid'],
                'name': full_name,
                'slug': author.get('slug', '')
            })
        
        return jsonify({'authors': authors})
    
    return jsonify({'authors': []})


@app.route('/api/tags')
def api_tags():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–µ–≥–æ–≤"""
    query = """
    query GetTags {
      tags(body: {
        limit: 100
      }) {
        uuid
        name
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'tags' in result['data']:
        return jsonify({'tags': result['data']['tags']})
    
    return jsonify({'tags': []})


@app.route('/api/categories')
def api_categories():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
    query = """
    query GetCategories {
      categories(body: {
        typeView: ALL
      }) {
        uuid
        name
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'categories' in result['data']:
        return jsonify({'categories': result['data']['categories']})
    
    return jsonify({'categories': []})


@app.route('/api/events/today')
def api_events_today():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
    today = datetime.now()
    events = db.get_events_by_date(today)
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –±–æ—Ç–∞
    formatted_events = []
    for event in events:
        formatted_events.append({
            'title': event['title'],
            'description': event['description'],
            'start_date': datetime.combine(event['event_date'], datetime.min.time()),
            'event_type': event['event_type'],
            'reference_uuid': event['reference_uuid'],
            'reference_name': event['reference_name']
        })
    
    return jsonify({'events': formatted_events})


@app.route('/edit/<int:event_id>', methods=['GET', 'POST'])
def edit_event(event_id):
    """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è"""
    event = db.get_event_by_id(event_id)
    
    if not event:
        flash('–°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!', 'error')
        return redirect(url_for('index'))
    
    if request.method == 'POST':
        try:
            title = request.form.get('title', '').strip()
            description = request.form.get('description', '').strip()
            event_date_str = request.form.get('event_date', '')
            is_active = request.form.get('is_active') == 'on'
            
            if not title or not event_date_str:
                flash('–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –¥–∞—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!', 'error')
                return redirect(url_for('edit_event', event_id=event_id))
            
            event_date = datetime.strptime(event_date_str, '%Y-%m-%d')
            
            db.update_event(
                event_id=event_id,
                title=title,
                description=description,
                event_date=event_date,
                is_active=is_active
            )
            
            flash('–°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!', 'success')
            return redirect(url_for('index'))
        except Exception as e:
            flash(f'–û—à–∏–±–∫–∞: {str(e)}', 'error')
    
    return render_template('edit_event.html', event=event)


@app.route('/delete/<int:event_id>')
def delete_event(event_id):
    """–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è"""
    if db.delete_event(event_id):
        flash('–°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success')
    else:
        flash('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏!', 'error')
    return redirect(url_for('index'))


if __name__ == '__main__':
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ GRAPHQL_ENDPOINT —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
    import os
    GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
    
    app.run(debug=True, host='0.0.0.0', port=5000)

```

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å{% endblock %}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2em;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #5568d3;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .events-list {
            margin-top: 30px;
        }
        
        .event-card {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        
        .event-card h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .event-card .date {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .event-card .description {
            color: #555;
            margin-bottom: 10px;
        }
        
        .event-actions {
            margin-top: 10px;
        }
        
        .event-actions a {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'error' if category == 'error' else 'success' }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </div>
</body>
</html>

```

```html
{% extends "base.html" %}

{% block content %}
<h1>üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h1>

<a href="{{ url_for('add_event') }}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</a>

<div class="events-list">
    {% if events %}
        {% for event in events %}
        <div class="event-card">
            <h3>{{ event.title }}</h3>
            <div class="date">üìÖ {{ event.event_date.strftime('%d.%m.%Y') }}</div>
            {% if event.description %}
            <div class="description">{{ event.description }}</div>
            {% endif %}
            {% if event.reference_name %}
            <div class="reference">
                {% if event.event_type == 'author' %}
                    üë§ –ê–≤—Ç–æ—Ä: {{ event.reference_name }}
                {% elif event.event_type == 'tag' %}
                    üè∑Ô∏è –¢–µ–≥: {{ event.reference_name }}
                {% elif event.event_type == 'category' %}
                    üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ event.reference_name }}
                {% endif %}
            </div>
            {% endif %}
            <div class="event-actions">
                <a href="{{ url_for('edit_event', event_id=event.id) }}" class="btn">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="{{ url_for('delete_event', event_id=event.id) }}" class="btn btn-danger" 
                   onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ?')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p>–°–æ–±—ã—Ç–∏–π –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ!</p>
    {% endif %}
</div>
{% endblock %}

```

```html
{% extends "base.html" %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ - –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å{% endblock %}

{% block content %}
<h1>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ</h1>

<form method="POST" action="{{ url_for('add_event') }}">
    <div class="form-group">
        <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è *</label>
        <input type="text" id="title" name="title" required 
               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É">
    </div>
    
    <div class="form-group">
        <label for="description">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
        <textarea id="description" name="description" 
                  placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–±—ã—Ç–∏–∏"></textarea>
    </div>
    
    <div class="form-group">
        <label for="event_date">–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è *</label>
        <input type="date" id="event_date" name="event_date" required>
    </div>
    
    <div class="form-group">
        <label for="event_type">–¢–∏–ø —Å–æ–±—ã—Ç–∏—è</label>
        <select id="event_type" name="event_type" onchange="toggleReferenceFields()">
            <option value="custom">–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ</option>
            <option value="author">–°–≤—è–∑–∞–Ω–æ —Å –∞–≤—Ç–æ—Ä–æ–º</option>
            <option value="tag">–°–≤—è–∑–∞–Ω–æ —Å —Ç–µ–≥–æ–º</option>
            <option value="category">–°–≤—è–∑–∞–Ω–æ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π</option>
        </select>
    </div>
    
    <div class="form-group" id="reference_group" style="display: none;">
        <label for="reference_name">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞</label>
        <select id="reference_select" name="reference_select" onchange="updateReference()">
            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ --</option>
        </select>
        <input type="hidden" id="reference_uuid" name="reference_uuid">
        <input type="hidden" id="reference_name" name="reference_name">
    </div>
    
    <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
    <a href="{{ url_for('index') }}" class="btn">‚ùå –û—Ç–º–µ–Ω–∞</a>
</form>

<script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏—è
    document.getElementById('event_type').addEventListener('change', function() {
        const eventType = this.value;
        const referenceGroup = document.getElementById('reference_group');
        const referenceSelect = document.getElementById('reference_select');
        
        if (eventType === 'custom') {
            referenceGroup.style.display = 'none';
            return;
        }
        
        referenceGroup.style.display = 'block';
        referenceSelect.innerHTML = '<option value="">–ó–∞–≥—Ä—É–∑–∫–∞...</option>';
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API
        let apiUrl = '';
        if (eventType === 'author') {
            apiUrl = '/api/authors';
        } else if (eventType === 'tag') {
            apiUrl = '/api/tags';
        } else if (eventType === 'category') {
            apiUrl = '/api/categories';
        }
        
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                referenceSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ --</option>';
                const items = data[eventType + 's'] || [];
                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.uuid;
                    option.textContent = item.name;
                    option.dataset.name = item.name;
                    referenceSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                referenceSelect.innerHTML = '<option value="">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</option>';
            });
    });
    
    function updateReference() {
        const select = document.getElementById('reference_select');
        const selectedOption = select.options[select.selectedIndex];
        
        if (selectedOption.value) {
            document.getElementById('reference_uuid').value = selectedOption.value;
            document.getElementById('reference_name').value = selectedOption.dataset.name || selectedOption.textContent;
        } else {
            document.getElementById('reference_uuid').value = '';
            document.getElementById('reference_name').value = '';
        }
    }
    
    function toggleReferenceFields() {
        const eventType = document.getElementById('event_type').value;
        const referenceGroup = document.getElementById('reference_group');
        
        if (eventType === 'custom') {
            referenceGroup.style.display = 'none';
        } else {
            referenceGroup.style.display = 'block';
            // –¢—Ä–∏–≥–≥–µ—Ä–∏–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö
            document.getElementById('event_type').dispatchEvent(new Event('change'));
        }
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    document.getElementById('event_date').valueAsDate = new Date();
</script>
{% endblock %}

```

```html
{% extends "base.html" %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ - –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å{% endblock %}

{% block content %}
<h1>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</h1>

<form method="POST" action="{{ url_for('edit_event', event_id=event.id) }}">
    <div class="form-group">
        <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è *</label>
        <input type="text" id="title" name="title" value="{{ event.title }}" required>
    </div>
    
    <div class="form-group">
        <label for="description">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
        <textarea id="description" name="description">{{ event.description or '' }}</textarea>
    </div>
    
    <div class="form-group">
        <label for="event_date">–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è *</label>
        <input type="date" id="event_date" name="event_date" 
               value="{{ event.event_date.strftime('%Y-%m-%d') }}" required>
    </div>
    
    <div class="form-group">
        <label>
            <input type="checkbox" name="is_active" {% if event.is_active %}checked{% endif %}>
            –ê–∫—Ç–∏–≤–Ω–æ
        </label>
    </div>
    
    <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    <a href="{{ url_for('index') }}" class="btn">‚ùå –û—Ç–º–µ–Ω–∞</a>
</form>
{% endblock %}

```

```pip-requirements
Flask>=3.0.0
httpx>=0.25.0

```


–û–±–Ω–æ–≤–ª—è—é –±–æ—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:


```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            from database import EventDatabase
            db = EventDatabase()
            
            today = datetime.now()
            db_events = db.get_events_by_date(today)
            
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –±–æ—Ç–æ–º
            today_events = []
            for db_event in db_events:
                event = {
                    'title': db_event['title'],
                    'description': db_event['description'] or '',
                    'start_date': datetime.combine(db_event['event_date'], datetime.min.time()),
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥/–∫–∞—Ç–µ–≥–æ—Ä–∏—é
                if db_event['reference_uuid']:
                    if db_event['event_type'] == 'author':
                        event['author_uuids'].append(db_event['reference_uuid'])
                        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
                        event['links'].append(
                            f"https://example.com/catalog?authors={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'tag':
                        event['tags'].append(db_event['reference_uuid'])
                        event['links'].append(
                            f"https://example.com/catalog?tags={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'category':
                        event['links'].append(
                            f"https://example.com/catalog?categories={db_event['reference_uuid']}&page=1"
                        )
                
                today_events.append(event)
            
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –ë–î: {len(today_events)}")
            return today_events
            
        except ImportError:
            # Fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏ –ë–î –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞
            logger.warning("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å")
            xml_content = await self.fetch_calendar()
            all_events = self.parse_calendar(xml_content)
            
            today = datetime.now().date()
            today_events = []
            
            for event in all_events:
                if event['start_date']:
                    event_date = event['start_date'].date()
                    if event_date == today:
                        today_events.append(event)
            
            return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```markdown
# üåê –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º

## –û–ø–∏—Å–∞–Ω–∏–µ

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å —Ñ–æ—Ä–º–æ–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É
- ‚úÖ –í—ã–±–æ—Ä –∞–≤—Ç–æ—Ä–æ–≤, —Ç–µ–≥–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ API
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GraphQL API

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
pip install -r requirements_web.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
export GRAPHQL_ENDPOINT="https://–≤–∞—à-api-endpoint.com/graphql"
export FLASK_SECRET_KEY="–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á"
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

```bash
python web_app.py
```

4. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**

```
http://localhost:5000
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

1. –ù–∞–∂–º–∏—Ç–µ "‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ"
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è** - –±—É–¥–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–æ –∂–∏—Ä–Ω—ã–º –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –±–æ—Ç–∞
   - **–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
   - **–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è** - –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–æ/–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Å–æ–±—ã—Ç–∏–µ
   - **–¢–∏–ø —Å–æ–±—ã—Ç–∏—è**:
     - –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
     - –°–≤—è–∑–∞–Ω–æ —Å –∞–≤—Ç–æ—Ä–æ–º (–≤—ã–±–æ—Ä –∏–∑ API)
     - –°–≤—è–∑–∞–Ω–æ —Å —Ç–µ–≥–æ–º (–≤—ã–±–æ—Ä –∏–∑ API)
     - –°–≤—è–∑–∞–Ω–æ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π (–≤—ã–±–æ—Ä –∏–∑ API)

3. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
   - –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
   - –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ GraphQL API
   - –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

1. –ù–∞–∂–º–∏—Ç–µ "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–æ–±—ã—Ç–∏—è
2. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

1. –ù–∞–∂–º–∏—Ç–µ "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–æ–±—ã—Ç–∏—è
2. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ
3. –°–æ–±—ã—Ç–∏–µ –±—É–¥–µ—Ç –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–¢–∞–±–ª–∏—Ü–∞ `events`:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `title` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `event_date` - –¥–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è
- `event_type` - —Ç–∏–ø ('author', 'tag', 'category', 'custom')
- `reference_uuid` - UUID –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `reference_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `is_active` - –∞–∫—Ç–∏–≤–Ω–æ –ª–∏ —Å–æ–±—ã—Ç–∏–µ
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## API Endpoints

### –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
```
GET /api/events/today
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤
```
GET /api/authors
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤
```
GET /api/tags
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```
GET /api/categories
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è.

–ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –±–æ—Ç fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:
1. –ò–∑–º–µ–Ω–∏—Ç–µ `FLASK_SECRET_KEY` –Ω–∞ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
3. –î–æ–±–∞–≤—å—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
4. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
python web_app.py
```

### –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Gunicorn
```bash
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 web_app:app
```

### Docker
```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY requirements_web.txt .
RUN pip install -r requirements_web.txt
COPY . .
CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "web_app:app"]
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ –¥–Ω–µ —Ä–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞

1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "–°–≤—è–∑–∞–Ω–æ —Å –∞–≤—Ç–æ—Ä–æ–º"
2. –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1900 –≥–æ–¥—É"
4. –£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ —ç—Ç–æ–≥–æ –∞–≤—Ç–æ—Ä–∞!

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞

1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ"
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: "–î–µ–Ω—å –±–∏–±–ª–∏–æ—Ç–µ–∫"
3. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ
4. –£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `GRAPHQL_ENDPOINT`:
```bash
echo $GRAPHQL_ENDPOINT
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```bash
chmod 755 .
```

### –°–æ–±—ã—Ç–∏—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–±—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω—ã (`is_active = 1`)

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º!** üéâ

```

```shellscript
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export GRAPHQL_ENDPOINT="${GRAPHQL_ENDPOINT:-https://your-api-endpoint.com/graphql}"
export FLASK_SECRET_KEY="${FLASK_SECRET_KEY:-change-this-in-production}"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python web_app.py

```

```bat
@echo off
REM –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Windows

REM –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
set GRAPHQL_ENDPOINT=https://your-api-endpoint.com/graphql
set FLASK_SECRET_KEY=change-this-in-production

REM –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python web_app.py

pause

```


–°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏. –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:

## –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (`database.py`)
- SQLite –±–∞–∑–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ –¥–∞—Ç–µ

### 2. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`web_app.py`)
- Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–æ–π
- API endpoints –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤/—Ç–µ–≥–æ–≤/–∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GraphQL API

### 3. HTML —à–∞–±–ª–æ–Ω—ã
- `templates/base.html` ‚Äî –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω
- `templates/index.html` ‚Äî —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
- `templates/add_event.html` ‚Äî —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `templates/edit_event.html` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4. –û–±–Ω–æ–≤–ª–µ–Ω –±–æ—Ç
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- Fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements_web.txt
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API (–≤ `web_app.py` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è):
```python
GRAPHQL_ENDPOINT = "https://–≤–∞—à-api-endpoint.com/graphql"
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
python web_app.py
```

4. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:5000
```

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É

1. –ù–∞–∂–º–∏—Ç–µ "‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ"
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (–±—É–¥–µ—Ç –∂–∏—Ä–Ω—ã–º –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –±–æ—Ç–∞)
   - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è
   - –¢–∏–ø —Å–æ–±—ã—Ç–∏—è:
     - –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
     - –°–≤—è–∑–∞–Ω–æ —Å –∞–≤—Ç–æ—Ä–æ–º ‚Äî –≤—ã–±–æ—Ä –∏–∑ API
     - –°–≤—è–∑–∞–Ω–æ —Å —Ç–µ–≥–æ–º ‚Äî –≤—ã–±–æ—Ä –∏–∑ API
     - –°–≤—è–∑–∞–Ω–æ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π ‚Äî –≤—ã–±–æ—Ä –∏–∑ API

3. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
   - –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ GraphQL API
   - –ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤/—Ç–µ–≥–æ–≤/–∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ API
- –ö—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite (–ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–∞—è)
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –±–∞–∑—É

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ –¥–Ω–µ —Ä–æ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞:
1. –í—ã–±–µ—Ä–∏—Ç–µ "–°–≤—è–∑–∞–Ω–æ —Å –∞–≤—Ç–æ—Ä–æ–º"
2. –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ API)
3. –í–≤–µ–¥–∏—Ç–µ: "–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1860 –≥–æ–¥—É"
4. –£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É: 29.01.2026
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ —ç—Ç–æ–≥–æ –∞–≤—Ç–æ—Ä–∞.

–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ.

```shellscript
pip install -r requirements_web.txt
```

```python
GRAPHQL_ENDPOINT = "https://–≤–∞—à-api-endpoint.com/graphql"
```

```shellscript
python web_app.py
```

```plaintext
http://localhost:5000
```

---

**User**

–∞ —Ç—ã –Ω–µ —Å–ø–∞—Ä—Å–∏–ª —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è?

---

**Cursor**


–°–æ–∑–¥–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–ª—è—é URL API –≤ `web_app.py`.


```python
"""
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–æ–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
"""

from flask import Flask, render_template, request, jsonify, redirect, url_for, flash
from datetime import datetime
import logging
from database import EventDatabase
import httpx
import asyncio

app = Flask(__name__)
app.secret_key = 'your-secret-key-change-this-in-production'  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

db = EventDatabase()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# URL GraphQL API (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥)
GRAPHQL_ENDPOINT = "https://example.com/graphql"


async def fetch_from_graphql(query: str, variables: dict = None):
    """–í—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ GraphQL API"""
    if not GRAPHQL_ENDPOINT:
        return None
    
    try:
        async with httpx.AsyncClient(timeout=30.0) as client:
            response = await client.post(
                GRAPHQL_ENDPOINT,
                json={"query": query, "variables": variables or {}},
                headers={"Content-Type": "application/json"}
            )
            if response.status_code == 200:
                return response.json()
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ GraphQL –∑–∞–ø—Ä–æ—Å–∞: {e}")
    return None


def run_async(coro):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é"""
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    try:
        return loop.run_until_complete(coro)
    finally:
        loop.close()


@app.route('/')
def index():
    """–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–æ–±—ã—Ç–∏–π"""
    events = db.get_all_events(limit=50)
    return render_template('index.html', events=events)


@app.route('/add', methods=['GET', 'POST'])
def add_event():
    """–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è"""
    if request.method == 'POST':
        try:
            # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
            title = request.form.get('title', '').strip()
            description = request.form.get('description', '').strip()
            event_date_str = request.form.get('event_date', '')
            event_type = request.form.get('event_type', 'custom')
            reference_uuid = request.form.get('reference_uuid', '').strip() or None
            reference_name = request.form.get('reference_name', '').strip() or None
            
            # –í–∞–ª–∏–¥–∞—Ü–∏—è
            if not title:
                flash('–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!', 'error')
                return redirect(url_for('add_event'))
            
            if not event_date_str:
                flash('–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞!', 'error')
                return redirect(url_for('add_event'))
            
            # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É
            try:
                event_date = datetime.strptime(event_date_str, '%Y-%m-%d')
            except ValueError:
                flash('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ì–ì–ì–ì-–ú–ú-–î–î', 'error')
                return redirect(url_for('add_event'))
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            event_id = db.add_event(
                title=title,
                description=description,
                event_date=event_date,
                event_type=event_type,
                reference_uuid=reference_uuid,
                reference_name=reference_name
            )
            
            flash(f'–°–æ–±—ã—Ç–∏–µ "{title}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success')
            return redirect(url_for('index'))
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è: {e}")
            flash(f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è: {str(e)}', 'error')
            return redirect(url_for('add_event'))
    
    # GET –∑–∞–ø—Ä–æ—Å - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
    return render_template('add_event.html')


@app.route('/api/authors')
def api_authors():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤"""
    query = """
    query GetAuthors {
      authors(body: {
        limit: 100
        page: 1
      }) {
        uuid
        firstName
        lastName
        patronymic
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'authors' in result['data']:
        authors = []
        for author in result['data']['authors']:
            name_parts = []
            if author.get('lastName'):
                name_parts.append(author['lastName'])
            if author.get('firstName'):
                name_parts.append(author['firstName'])
            if author.get('patronymic'):
                name_parts.append(author['patronymic'])
            
            full_name = ' '.join(name_parts) if name_parts else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä'
            
            authors.append({
                'uuid': author['uuid'],
                'name': full_name,
                'slug': author.get('slug', '')
            })
        
        return jsonify({'authors': authors})
    
    return jsonify({'authors': []})


@app.route('/api/tags')
def api_tags():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–µ–≥–æ–≤"""
    query = """
    query GetTags {
      tags(body: {
        limit: 100
      }) {
        uuid
        name
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'tags' in result['data']:
        return jsonify({'tags': result['data']['tags']})
    
    return jsonify({'tags': []})


@app.route('/api/categories')
def api_categories():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
    query = """
    query GetCategories {
      categories(body: {
        typeView: ALL
      }) {
        uuid
        name
        slug
      }
    }
    """
    
    result = run_async(fetch_from_graphql(query))
    
    if result and 'data' in result and 'categories' in result['data']:
        return jsonify({'categories': result['data']['categories']})
    
    return jsonify({'categories': []})


@app.route('/api/events/today')
def api_events_today():
    """API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è"""
    today = datetime.now()
    events = db.get_events_by_date(today)
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –±–æ—Ç–∞
    formatted_events = []
    for event in events:
        formatted_events.append({
            'title': event['title'],
            'description': event['description'],
            'start_date': datetime.combine(event['event_date'], datetime.min.time()),
            'event_type': event['event_type'],
            'reference_uuid': event['reference_uuid'],
            'reference_name': event['reference_name']
        })
    
    return jsonify({'events': formatted_events})


@app.route('/edit/<int:event_id>', methods=['GET', 'POST'])
def edit_event(event_id):
    """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è"""
    event = db.get_event_by_id(event_id)
    
    if not event:
        flash('–°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!', 'error')
        return redirect(url_for('index'))
    
    if request.method == 'POST':
        try:
            title = request.form.get('title', '').strip()
            description = request.form.get('description', '').strip()
            event_date_str = request.form.get('event_date', '')
            is_active = request.form.get('is_active') == 'on'
            
            if not title or not event_date_str:
                flash('–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –¥–∞—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!', 'error')
                return redirect(url_for('edit_event', event_id=event_id))
            
            event_date = datetime.strptime(event_date_str, '%Y-%m-%d')
            
            db.update_event(
                event_id=event_id,
                title=title,
                description=description,
                event_date=event_date,
                is_active=is_active
            )
            
            flash('–°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!', 'success')
            return redirect(url_for('index'))
        except Exception as e:
            flash(f'–û—à–∏–±–∫–∞: {str(e)}', 'error')
    
    return render_template('edit_event.html', event=event)


@app.route('/delete/<int:event_id>')
def delete_event(event_id):
    """–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è"""
    if db.delete_event(event_id):
        flash('–°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success')
    else:
        flash('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏!', 'error')
    return redirect(url_for('index'))


if __name__ == '__main__':
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ GRAPHQL_ENDPOINT —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
    import os
    GRAPHQL_ENDPOINT = os.getenv('GRAPHQL_ENDPOINT')
    
    app.run(debug=True, host='0.0.0.0', port=5000)


```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
"""

import asyncio
import httpx
import logging
from datetime import datetime
from database import EventDatabase
from literary_calendar_bot import LiteraryCalendarBot

logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def import_from_yandex_calendar():
    """–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    db = EventDatabase()
    
    print("=" * 60)
    print("üîÑ –ò–ú–ü–û–†–¢ –°–û–ë–´–¢–ò–ô –ò–ó –Ø–ù–î–ï–ö–° –ö–ê–õ–ï–ù–î–ê–†–Ø")
    print("=" * 60)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    print("\n1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    xml_content = await bot.fetch_calendar()
    print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤)")
    
    # –ü–∞—Ä—Å–∏–º —Å–æ–±—ã—Ç–∏—è
    print("\n2Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...")
    all_events = bot.parse_calendar(xml_content)
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(all_events)}")
    
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    print("\n3Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...")
    imported_count = 0
    skipped_count = 0
    error_count = 0
    
    for event in all_events:
        if not event.get('start_date'):
            skipped_count += 1
            logger.warning(f"–ü—Ä–æ–ø—É—â–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –±–µ–∑ –¥–∞—Ç—ã: {event['title']}")
            continue
        
        try:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –∏ —Å—Å—ã–ª–∫–∏
            event_type = 'custom'
            reference_uuid = None
            reference_name = None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å UUID –∞–≤—Ç–æ—Ä–æ–≤
            if event.get('author_uuids'):
                event_type = 'author'
                reference_uuid = event['author_uuids'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
                # –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∏–º—è –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å—Å—ã–ª–æ–∫
                reference_name = None  # –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ API
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–≥–∏
            elif event.get('tags'):
                event_type = 'tag'
                reference_uuid = event['tags'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–µ–≥
                reference_name = None
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ —Å—Å—ã–ª–æ–∫, –µ—Å–ª–∏ –µ—Å—Ç—å
            if event.get('links'):
                for link in event['links']:
                    if 'authors=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
                    elif 'tags=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
            existing_events = db.get_events_by_date(event['start_date'])
            is_duplicate = False
            for existing in existing_events:
                if existing['title'] == event['title']:
                    is_duplicate = True
                    break
            
            if is_duplicate:
                skipped_count += 1
                logger.info(f"–°–æ–±—ã—Ç–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {event['title']}")
                continue
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            event_id = db.add_event(
                title=event['title'],
                description=event.get('description', ''),
                event_date=event['start_date'],
                event_type=event_type,
                reference_uuid=reference_uuid,
                reference_name=reference_name
            )
            
            imported_count += 1
            print(f"  ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {event['title'][:50]} ({event['start_date'].strftime('%d.%m.%Y')})")
            
        except Exception as e:
            error_count += 1
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ–±—ã—Ç–∏—è '{event['title']}': {e}")
    
    print("\n" + "=" * 60)
    print("üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–ú–ü–û–†–¢–ê")
    print("=" * 60)
    print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {imported_count}")
    print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã/–±–µ–∑ –¥–∞—Ç—ã): {skipped_count}")
    print(f"‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"üìÖ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(all_events)}")
    print("=" * 60)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    if imported_count > 0:
        print("\nüìã –ü—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π:")
        recent_events = db.get_all_events(limit=5)
        for i, evt in enumerate(recent_events[:5], 1):
            print(f"\n{i}. {evt['title']}")
            print(f"   –î–∞—Ç–∞: {evt['event_date'].strftime('%d.%m.%Y')}")
            if evt['reference_name']:
                print(f"   –°–≤—è–∑–∞–Ω–æ —Å: {evt['reference_name']}")
    
    print("\n‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!")
    print("\nüí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:")
    print("   1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python web_app.py")
    print("   2. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è: http://localhost:5000")
    print("   3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É")


if __name__ == "__main__":
    asyncio.run(import_from_yandex_calendar())

```

```markdown
# üì• –ò–º–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫

```bash
python import_from_yandex_calendar.py
```

–°–∫—Ä–∏–ø—Ç:
1. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ –Ø–Ω–¥–µ–∫—Å
2. ‚úÖ –†–∞—Å–ø–∞—Ä—Å–∏—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
3. ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQLite
4. ‚úÖ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
5. ‚úÖ –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–º–ø–æ—Ä—Ç–∞

## –ß—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- ‚úÖ UUID –∞–≤—Ç–æ—Ä–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ —Å—Å—ã–ª–∫–∞—Ö)
- ‚úÖ UUID —Ç–µ–≥–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ —Å—Å—ã–ª–∫–∞—Ö)

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üîÑ –ò–ú–ü–û–†–¢ –°–û–ë–´–¢–ò–ô –ò–ó –Ø–ù–î–ï–ö–° –ö–ê–õ–ï–ù–î–ê–†–Ø
============================================================

1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...
‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω (15234 —Å–∏–º–≤–æ–ª–æ–≤)

2Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...
‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: 45

3Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...
  ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: –û–ª–µ–≥ –ì—Ä–∏–≥–æ—Ä—å–µ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1943 –≥–æ–¥—É (06.12.2025)
  ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –¥–µ–Ω—å –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –∞–≤–∏–∞—Ü–∏–∏ (07.12.2025)
  ...

============================================================
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–ú–ü–û–†–¢–ê
============================================================
‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: 42
‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã/–±–µ–∑ –¥–∞—Ç—ã): 3
‚ùå –û—à–∏–±–æ–∫: 0
üìÖ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 45
============================================================
```

## –ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–±—ã—Ç–∏—è:**
   ```bash
   python web_app.py
   # –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:**
   - –ò–º–µ–Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û–ø–∏—Å–∞–Ω–∏—è –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å

3. **–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –±–∞–∑—É:**
   - –ë–æ—Ç –±—É–¥–µ—Ç –±—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω

## –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã (—Å–æ–±—ã—Ç–∏—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –¥–∞—Ç–æ–π).

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
1. –£–¥–∞–ª–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: `rm literary_events.db`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–º–ø–æ—Ä—Ç —Å–Ω–æ–≤–∞

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —Å–∫—Ä–∏–ø—Ç–µ:

```python
calendar_url = "–≤–∞—à-url-–∫–∞–ª–µ–Ω–¥–∞—Ä—è"
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ

### –°–æ–±—ã—Ç–∏—è –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É —Å–æ–±—ã—Ç–∏–π –µ—Å—Ç—å –¥–∞—Ç—ã

### –î—É–±–ª–∏–∫–∞—Ç—ã

- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, —É–¥–∞–ª–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö!** üéâ

```


–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω URL API –≤ `web_app.py` (—É–±—Ä–∞–ª –ª–∏—à–Ω–∏–π —Ç–µ–∫—Å—Ç "url: ").

## –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ (`import_from_yandex_calendar.py`)

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
- –ü–∞—Ä—Å–∏—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —Å –¥–∞—Ç–∞–º–∏
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–æ–≤/—Ç–µ–≥–∏ –∏–∑ —Å—Å—ã–ª–æ–∫
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è:

```bash
python import_from_yandex_calendar.py
```

–°–∫—Ä–∏–ø—Ç:
- –ó–∞–≥—Ä—É–∑–∏—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- –†–∞—Å–ø–∞—Ä—Å–∏—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```bash
python web_app.py
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.

### 3. –î–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É –≤–º–µ—Å—Ç–æ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è.

## –ß—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

- –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- –î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è
- –û–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- UUID –∞–≤—Ç–æ—Ä–æ–≤ (–∏–∑ —Å—Å—ã–ª–æ–∫)
- UUID —Ç–µ–≥–æ–≤ (–∏–∑ —Å—Å—ã–ª–æ–∫)

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É
- –ú–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–º–ø–æ—Ä—Ç, —á—Ç–æ–±—ã –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

```shellscript
python import_from_yandex_calendar.py
```

```shellscript
python web_app.py
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000
```

---

**User**

–∫–∞–∫–∞—è-—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞, –Ω–µ –≤–∏–∂—É —Å–æ–±—ã—Ç–∏–π, –∫—Ä–æ–º–µ —Ç–æ–≥–æ, —á—Ç–æ —Å–∞–º–∞ –¥–æ–±–∞–≤–∏–ª–∞

---

**Cursor**


–ü—Ä–æ–≤–µ—Ä—è—é, –ø–æ—á–µ–º—É —Å–æ–±—ã—Ç–∏—è –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è. –°–æ–∑–¥–∞—é –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:


```python
"""
–û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π
"""

import asyncio
import httpx
from datetime import datetime
from database import EventDatabase
from literary_calendar_bot import LiteraryCalendarBot

async def debug_import():
    """–û—Ç–ª–∞–¥–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π"""
    
    print("=" * 60)
    print("üîç –û–¢–õ–ê–î–ö–ê –ò–ú–ü–û–†–¢–ê –°–û–ë–´–¢–ò–ô")
    print("=" * 60)
    
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    print("\n1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    db = EventDatabase()
    db_events = db.get_all_events(limit=100)
    print(f"‚úÖ –°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: {len(db_events)}")
    
    if db_events:
        print("\n–°–æ–±—ã—Ç–∏—è –≤ –±–∞–∑–µ:")
        for i, event in enumerate(db_events[:10], 1):
            print(f"  {i}. {event['title']} - {event['event_date']}")
    else:
        print("  ‚ö†Ô∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞")
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    print("\n2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    try:
        xml_content = await bot.fetch_calendar()
        print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤)")
        
        # –ü–∞—Ä—Å–∏–º —Å–æ–±—ã—Ç–∏—è
        print("\n3Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
        calendar_events = bot.parse_calendar(xml_content)
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ: {len(calendar_events)}")
        
        if calendar_events:
            print("\n–ü–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:")
            for i, event in enumerate(calendar_events[:10], 1):
                date_str = event['start_date'].strftime('%d.%m.%Y') if event.get('start_date') else '–ë–µ–∑ –¥–∞—Ç—ã'
                print(f"  {i}. {event['title'][:50]}")
                print(f"     –î–∞—Ç–∞: {date_str}")
                print(f"     –ê–≤—Ç–æ—Ä—ã UUID: {event.get('author_uuids', [])}")
                print(f"     –°—Å—ã–ª–∫–∏: {len(event.get('links', []))}")
        else:
            print("  ‚ö†Ô∏è –°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ")
        
        # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ
        print("\n4Ô∏è‚É£ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö...")
        
        calendar_dates = {}
        for event in calendar_events:
            if event.get('start_date'):
                date_key = event['start_date'].date()
                title = event['title']
                calendar_dates[(date_key, title)] = event
        
        db_dates = {}
        for event in db_events:
            date_key = event['event_date']
            title = event['title']
            db_dates[(date_key, title)] = event
        
        print(f"  –°–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ: {len(calendar_dates)}")
        print(f"  –°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(db_dates)}")
        
        # –ù–∞—Ö–æ–¥–∏–º —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –±–∞–∑–µ
        missing_events = []
        for key, event in calendar_dates.items():
            if key not in db_dates:
                missing_events.append(event)
        
        print(f"\n  üìã –°–æ–±—ã—Ç–∏–π –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞: {len(missing_events)}")
        
        if missing_events:
            print("\n  –ü—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –±–∞–∑–µ:")
            for i, event in enumerate(missing_events[:5], 1):
                date_str = event['start_date'].strftime('%d.%m.%Y') if event.get('start_date') else '–ë–µ–∑ –¥–∞—Ç—ã'
                print(f"    {i}. {event['title'][:50]} ({date_str})")
        
        # 4. –ü—Ä–æ–±—É–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ
        if missing_events:
            print("\n5Ô∏è‚É£ –¢–µ—Å—Ç–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç –æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è...")
            test_event = missing_events[0]
            
            try:
                event_type = 'custom'
                reference_uuid = None
                reference_name = None
                
                if test_event.get('author_uuids'):
                    event_type = 'author'
                    reference_uuid = test_event['author_uuids'][0]
                
                event_id = db.add_event(
                    title=test_event['title'],
                    description=test_event.get('description', ''),
                    event_date=test_event['start_date'],
                    event_type=event_type,
                    reference_uuid=reference_uuid,
                    reference_name=reference_name
                )
                
                print(f"  ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ! ID: {event_id}")
                print(f"     –ù–∞–∑–≤–∞–Ω–∏–µ: {test_event['title']}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–Ω–æ –ø–æ—è–≤–∏–ª–æ—Å—å –≤ –±–∞–∑–µ
                new_events = db.get_all_events(limit=100)
                print(f"  ‚úÖ –¢–µ–ø–µ—Ä—å —Å–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(new_events)}")
                
            except Exception as e:
                print(f"  ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–æ–≤–æ–º –∏–º–ø–æ—Ä—Ç–µ: {e}")
                import traceback
                traceback.print_exc()
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
    
    print("\n" + "=" * 60)
    print("‚úÖ –û—Ç–ª–∞–¥–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    print("=" * 60)
    
    print("\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
    print("1. –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –Ω–∞–π–¥–µ–Ω—ã, –Ω–æ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è:")
    print("   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python import_from_yandex_calendar.py")
    print("2. –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:")
    print("   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è")
    print("   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python debug_calendar.py")
    print("3. –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞:")
    print("   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞")
    print("   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª literary_events.db —Å–æ–∑–¥–∞–Ω")

if __name__ == "__main__":
    asyncio.run(debug_import())

```


–£–ª—É—á—à–∞—é —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è—é –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
"""

import asyncio
import httpx
import logging
from datetime import datetime
from database import EventDatabase
from literary_calendar_bot import LiteraryCalendarBot

logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def import_from_yandex_calendar():
    """–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    db = EventDatabase()
    
    print("=" * 60)
    print("üîÑ –ò–ú–ü–û–†–¢ –°–û–ë–´–¢–ò–ô –ò–ó –Ø–ù–î–ï–ö–° –ö–ê–õ–ï–ù–î–ê–†–Ø")
    print("=" * 60)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    print("\n1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    xml_content = await bot.fetch_calendar()
    print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤)")
    
    # –ü–∞—Ä—Å–∏–º —Å–æ–±—ã—Ç–∏—è
    print("\n2Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...")
    all_events = bot.parse_calendar(xml_content)
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(all_events)}")
    
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    print("\n3Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...")
    imported_count = 0
    skipped_count = 0
    error_count = 0
    
    for event in all_events:
        if not event.get('start_date'):
            skipped_count += 1
            logger.warning(f"–ü—Ä–æ–ø—É—â–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –±–µ–∑ –¥–∞—Ç—ã: {event['title']}")
            continue
        
        try:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –∏ —Å—Å—ã–ª–∫–∏
            event_type = 'custom'
            reference_uuid = None
            reference_name = None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å UUID –∞–≤—Ç–æ—Ä–æ–≤
            if event.get('author_uuids'):
                event_type = 'author'
                reference_uuid = event['author_uuids'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
                # –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∏–º—è –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å—Å—ã–ª–æ–∫
                reference_name = None  # –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ API
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–≥–∏
            elif event.get('tags'):
                event_type = 'tag'
                reference_uuid = event['tags'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–µ–≥
                reference_name = None
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ —Å—Å—ã–ª–æ–∫, –µ—Å–ª–∏ –µ—Å—Ç—å
            if event.get('links'):
                for link in event['links']:
                    if 'authors=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
                    elif 'tags=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
            # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–æ –¥–∞—Ç–µ –∏ –Ω–∞–∑–≤–∞–Ω–∏—é
            event_date_only = event['start_date'].date()
            existing_events = db.get_events_by_date(event['start_date'])
            is_duplicate = False
            
            for existing in existing_events:
                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø—Ä–æ–±–µ–ª–æ–≤)
                existing_title = existing['title'].strip().lower()
                new_title = event['title'].strip().lower()
                if existing_title == new_title:
                    is_duplicate = True
                    logger.debug(f"–î—É–±–ª–∏–∫–∞—Ç –Ω–∞–π–¥–µ–Ω: {event['title']}")
                    break
            
            if is_duplicate:
                skipped_count += 1
                continue
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            event_id = db.add_event(
                title=event['title'],
                description=event.get('description', ''),
                event_date=event['start_date'],
                event_type=event_type,
                reference_uuid=reference_uuid,
                reference_name=reference_name
            )
            
            imported_count += 1
            print(f"  ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {event['title'][:50]} ({event['start_date'].strftime('%d.%m.%Y')})")
            
        except Exception as e:
            error_count += 1
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ–±—ã—Ç–∏—è '{event['title']}': {e}")
    
    print("\n" + "=" * 60)
    print("üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–ú–ü–û–†–¢–ê")
    print("=" * 60)
    print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {imported_count}")
    print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã/–±–µ–∑ –¥–∞—Ç—ã): {skipped_count}")
    print(f"‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"üìÖ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(all_events)}")
    print("=" * 60)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    if imported_count > 0:
        print("\nüìã –ü—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π:")
        recent_events = db.get_all_events(limit=5)
        for i, evt in enumerate(recent_events[:5], 1):
            print(f"\n{i}. {evt['title']}")
            print(f"   –î–∞—Ç–∞: {evt['event_date'].strftime('%d.%m.%Y')}")
            if evt['reference_name']:
                print(f"   –°–≤—è–∑–∞–Ω–æ —Å: {evt['reference_name']}")
    
    print("\n‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!")
    print("\nüí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:")
    print("   1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python web_app.py")
    print("   2. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è: http://localhost:5000")
    print("   3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É")


if __name__ == "__main__":
    asyncio.run(import_from_yandex_calendar())


```

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
"""

import asyncio
import httpx
import logging
from datetime import datetime
from database import EventDatabase
from literary_calendar_bot import LiteraryCalendarBot

logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


async def import_from_yandex_calendar():
    """–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    db = EventDatabase()
    
    print("=" * 60)
    print("üîÑ –ò–ú–ü–û–†–¢ –°–û–ë–´–¢–ò–ô –ò–ó –Ø–ù–î–ï–ö–° –ö–ê–õ–ï–ù–î–ê–†–Ø")
    print("=" * 60)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    print("\n1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    xml_content = await bot.fetch_calendar()
    print(f"‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω ({len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤)")
    
    # –ü–∞—Ä—Å–∏–º —Å–æ–±—ã—Ç–∏—è
    print("\n2Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...")
    all_events = bot.parse_calendar(xml_content)
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(all_events)}")
    
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    print("\n3Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...")
    imported_count = 0
    skipped_count = 0
    error_count = 0
    
    for event in all_events:
        if not event.get('start_date'):
            skipped_count += 1
            logger.warning(f"–ü—Ä–æ–ø—É—â–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –±–µ–∑ –¥–∞—Ç—ã: {event['title']}")
            continue
        
        try:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –∏ —Å—Å—ã–ª–∫–∏
            event_type = 'custom'
            reference_uuid = None
            reference_name = None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å UUID –∞–≤—Ç–æ—Ä–æ–≤
            if event.get('author_uuids'):
                event_type = 'author'
                reference_uuid = event['author_uuids'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
                # –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∏–º—è –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å—Å—ã–ª–æ–∫
                reference_name = None  # –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ API
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–≥–∏
            elif event.get('tags'):
                event_type = 'tag'
                reference_uuid = event['tags'][0]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–µ–≥
                reference_name = None
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ —Å—Å—ã–ª–æ–∫, –µ—Å–ª–∏ –µ—Å—Ç—å
            if event.get('links'):
                for link in event['links']:
                    if 'authors=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
                    elif 'tags=' in link:
                        # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –≤—ã—à–µ
                        pass
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
            # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–æ –¥–∞—Ç–µ –∏ –Ω–∞–∑–≤–∞–Ω–∏—é
            event_date_only = event['start_date'].date()
            existing_events = db.get_events_by_date(event['start_date'])
            is_duplicate = False
            
            for existing in existing_events:
                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø—Ä–æ–±–µ–ª–æ–≤)
                existing_title = existing['title'].strip().lower()
                new_title = event['title'].strip().lower()
                if existing_title == new_title:
                    is_duplicate = True
                    logger.debug(f"–î—É–±–ª–∏–∫–∞—Ç –Ω–∞–π–¥–µ–Ω: {event['title']}")
                    break
            
            if is_duplicate:
                skipped_count += 1
                continue
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            event_id = db.add_event(
                title=event['title'],
                description=event.get('description', ''),
                event_date=event['start_date'],
                event_type=event_type,
                reference_uuid=reference_uuid,
                reference_name=reference_name
            )
            
            imported_count += 1
            date_str = event['start_date'].strftime('%d.%m.%Y') if event.get('start_date') else '–ë–µ–∑ –¥–∞—Ç—ã'
            print(f"  ‚úÖ [{imported_count}] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {event['title'][:50]} ({date_str})")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∂–¥–æ–µ 10-–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            if imported_count % 10 == 0:
                print(f"     ... –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ {imported_count} —Å–æ–±—ã—Ç–∏–π ...")
            
        except Exception as e:
            error_count += 1
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ–±—ã—Ç–∏—è '{event['title']}': {e}")
    
    print("\n" + "=" * 60)
    print("üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–ú–ü–û–†–¢–ê")
    print("=" * 60)
    print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {imported_count}")
    print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã/–±–µ–∑ –¥–∞—Ç—ã): {skipped_count}")
    print(f"‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"üìÖ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(all_events)}")
    print("=" * 60)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    if imported_count > 0:
        print("\nüìã –ü—Ä–∏–º–µ—Ä—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π:")
        recent_events = db.get_all_events(limit=5)
        for i, evt in enumerate(recent_events[:5], 1):
            print(f"\n{i}. {evt['title']}")
            print(f"   –î–∞—Ç–∞: {evt['event_date'].strftime('%d.%m.%Y')}")
            if evt['reference_name']:
                print(f"   –°–≤—è–∑–∞–Ω–æ —Å: {evt['reference_name']}")
    
    print("\n‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!")
    print("\nüí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:")
    print("   1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python web_app.py")
    print("   2. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è: http://localhost:5000")
    print("   3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É")


if __name__ == "__main__":
    asyncio.run(import_from_yandex_calendar())


```

```python
logging.basicConfig(
    format='%(asctime)s - %(levelname)s - %(message)s',
    level=logging.DEBUG  # –ò–∑–º–µ–Ω–∏–ª–∏ –Ω–∞ DEBUG –¥–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤
)
logger = logging.getLogger(__name__)
```

```python
"""
–ë—ã—Å—Ç—Ä—ã–π –∏–º–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è
–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
"""

import asyncio
import httpx
from datetime import datetime
from database import EventDatabase
from literary_calendar_bot import LiteraryCalendarBot

async def quick_import():
    """–ë—ã—Å—Ç—Ä—ã–π –∏–º–ø–æ—Ä—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º"""
    
    print("üöÄ –ë–´–°–¢–†–´–ô –ò–ú–ü–û–†–¢ –°–û–ë–´–¢–ò–ô")
    print("=" * 60)
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    calendar_url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    db = EventDatabase()
    
    bot = LiteraryCalendarBot(
        bot_token="dummy",
        calendar_url=calendar_url,
        graphql_endpoint="dummy",
        group_chat_id="dummy"
    )
    
    # –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞
    print("\nüì• –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    try:
        xml_content = await bot.fetch_calendar()
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(xml_content)} —Å–∏–º–≤–æ–ª–æ–≤")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {e}")
        return
    
    # –®–∞–≥ 2: –ü–∞—Ä—Å–∏–Ω–≥
    print("\nüîç –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π...")
    try:
        events = bot.parse_calendar(xml_content)
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ {len(events)} —Å–æ–±—ã—Ç–∏–π")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: {e}")
        import traceback
        traceback.print_exc()
        return
    
    if not events:
        print("‚ö†Ô∏è –°–æ–±—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ!")
        return
    
    # –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã
    print("\nüìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    existing = db.get_all_events()
    print(f"   –°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(existing)}")
    
    # –®–∞–≥ 4: –ò–º–ø–æ—Ä—Ç
    print("\nüíæ –ò–º–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π...")
    imported = 0
    skipped = 0
    errors = 0
    
    for i, event in enumerate(events, 1):
        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–±—ã—Ç–∏—è –±–µ–∑ –¥–∞—Ç—ã
        if not event.get('start_date'):
            skipped += 1
            print(f"  ‚è≠Ô∏è  [{i}/{len(events)}] –ü—Ä–æ–ø—É—â–µ–Ω–æ (–Ω–µ—Ç –¥–∞—Ç—ã): {event['title'][:40]}")
            continue
        
        try:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø
            event_type = 'custom'
            ref_uuid = None
            ref_name = None
            
            if event.get('author_uuids'):
                event_type = 'author'
                ref_uuid = event['author_uuids'][0]
            elif event.get('tags'):
                event_type = 'tag'
                ref_uuid = event['tags'][0]
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–∞
            event_date = event['start_date'].date()
            existing_today = db.get_events_by_date(event['start_date'])
            
            is_dup = any(
                e['title'].strip().lower() == event['title'].strip().lower()
                for e in existing_today
            )
            
            if is_dup:
                skipped += 1
                if i <= 5 or imported < 3:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ
                    print(f"  ‚è≠Ô∏è  [{i}/{len(events)}] –î—É–±–ª–∏–∫–∞—Ç: {event['title'][:40]}")
                continue
            
            # –ò–º–ø–æ—Ä—Ç
            db.add_event(
                title=event['title'],
                description=event.get('description', ''),
                event_date=event['start_date'],
                event_type=event_type,
                reference_uuid=ref_uuid,
                reference_name=ref_name
            )
            
            imported += 1
            date_str = event['start_date'].strftime('%d.%m.%Y')
            print(f"  ‚úÖ [{i}/{len(events)}] {event['title'][:40]} ({date_str})")
            
        except Exception as e:
            errors += 1
            print(f"  ‚ùå [{i}/{len(events)}] –û—à–∏–±–∫–∞: {event['title'][:40]} - {e}")
    
    # –ò—Ç–æ–≥–∏
    print("\n" + "=" * 60)
    print("üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´")
    print("=" * 60)
    print(f"‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: {imported}")
    print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ: {skipped}")
    print(f"‚ùå –û—à–∏–±–æ–∫: {errors}")
    print(f"üìÖ –í—Å–µ–≥–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ: {len(events)}")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    final_count = len(db.get_all_events())
    print(f"\nüíæ –°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ —Ç–µ–ø–µ—Ä—å: {final_count}")
    
    if imported > 0:
        print("\n‚úÖ –ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!")
        print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python web_app.py")
    else:
        print("\n‚ö†Ô∏è –°–æ–±—ã—Ç–∏—è –Ω–µ –±—ã–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã.")
        print("   –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:")
        print("   - –í—Å–µ —Å–æ–±—ã—Ç–∏—è —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ")
        print("   - –°–æ–±—ã—Ç–∏—è –±–µ–∑ –¥–∞—Ç")
        print("   - –û—à–∏–±–∫–∏ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ")

if __name__ == "__main__":
    asyncio.run(quick_import())

```


–°–æ–∑–¥–∞–ª –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:

## –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É

```bash
python debug_import.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –°–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –°–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω—É–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ü–æ—á–µ–º—É –æ–Ω–∏ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è

## –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–º–ø–æ—Ä—Ç

```bash
python quick_import.py
```

–ò–ª–∏ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é:
```bash
python import_from_yandex_calendar.py
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

1. –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª—Å—è ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç–µ `quick_import.py`
2. –°–æ–±—ã—Ç–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
3. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –¥–∞—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ –æ—Ç–ª–∞–¥–∫–∏
4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `literary_events.db`

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ Python:

```python
from database import EventDatabase
db = EventDatabase()
events = db.get_all_events()
print(f"–°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(events)}")
for e in events[:5]:
    print(f"  - {e['title']} ({e['event_date']})")
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `debug_import.py` –∏ –ø—Ä–∏—à–ª–∏—Ç–µ –≤—ã–≤–æ–¥ ‚Äî –ø–æ –Ω–µ–º—É –æ–ø—Ä–µ–¥–µ–ª—é –ø—Ä–æ–±–ª–µ–º—É.

```shellscript
python debug_import.py
```

```shellscript
python quick_import.py
```

```shellscript
python import_from_yandex_calendar.py
```

```python
from database import EventDatabase
db = EventDatabase()
events = db.get_all_events()
print(f"–°–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(events)}")
for e in events[:5]:
    print(f"  - {e['title']} ({e['event_date']})")
```

---

**User**

–ø–æ–ø—Ä–æ—Å–∏ –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π –∑–∞ —Å–¥–µ–ª—É—é—â–∏–µ 10 –¥–Ω–µ–π –∏–∑ —Å–ø–∞—Ä—Å–µ–Ω–Ω–æ–π –±–∞–∑—ã

---

**Cursor**


–°–æ–∑–¥–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—ã–≤–æ–¥–∞ –ø–µ—Ä–≤—ã—Ö 10 —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:


```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –≤—ã–≤–æ–¥–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π –∑–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π
"""

from datetime import datetime, timedelta
from database import EventDatabase

def show_upcoming_events():
    """–í—ã–≤–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π"""
    
    print("=" * 60)
    print("üìÖ –ë–õ–ò–ñ–ê–ô–®–ò–ï –°–û–ë–´–¢–ò–Ø (–°–õ–ï–î–£–Æ–©–ò–ï 10 –î–ù–ï–ô)")
    print("=" * 60)
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    db = EventDatabase()
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
    today = datetime.now().date()
    end_date = today + timedelta(days=10)
    
    print(f"\nüìÜ –ü–µ—Ä–∏–æ–¥: {today.strftime('%d.%m.%Y')} - {end_date.strftime('%d.%m.%Y')}")
    print(f"üìÖ –°–µ–≥–æ–¥–Ω—è: {today.strftime('%d %B %Y')}")
    print("-" * 60)
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
    all_events = db.get_all_events(is_active=True)
    
    # –§–∏–ª—å—Ç—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π
    upcoming_events = []
    for event in all_events:
        event_date = event['event_date']
        if today <= event_date <= end_date:
            upcoming_events.append(event)
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ
    upcoming_events.sort(key=lambda x: x['event_date'])
    
    print(f"\n‚úÖ –ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(upcoming_events)}")
    
    if not upcoming_events:
        print("\n‚ö†Ô∏è –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")
        print("\nüí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:")
        print("   1. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è: python quick_import.py")
        print("   2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É: python web_app.py")
        return
    
    # –í—ã–≤–æ–¥–∏–º –ø–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π
    print(f"\nüìã –ü–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π:\n")
    
    for i, event in enumerate(upcoming_events[:10], 1):
        event_date = event['event_date']
        days_until = (event_date - today).days
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        if days_until == 0:
            status = "üéØ –°–ï–ì–û–î–ù–Ø"
        elif days_until == 1:
            status = "üìÖ –ó–ê–í–¢–†–ê"
        else:
            status = f"üìÖ –ß–µ—Ä–µ–∑ {days_until} –¥–Ω–µ–π"
        
        print(f"{i}. {status}")
        print(f"   üìö {event['title']}")
        print(f"   üìÜ –î–∞—Ç–∞: {event_date.strftime('%d %B %Y')} ({event_date.strftime('%d.%m.%Y')})")
        
        if event.get('description'):
            desc = event['description'][:100]
            if len(event.get('description', '')) > 100:
                desc += "..."
            print(f"   üìù {desc}")
        
        if event.get('reference_name'):
            ref_type = {
                'author': 'üë§ –ê–≤—Ç–æ—Ä',
                'tag': 'üè∑Ô∏è –¢–µ–≥',
                'category': 'üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è'
            }.get(event['event_type'], 'üîó –°—Å—ã–ª–∫–∞')
            print(f"   {ref_type}: {event['reference_name']}")
        
        print()
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    print("-" * 60)
    print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   –í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π –≤ –±–∞–∑–µ: {len(all_events)}")
    print(f"   –°–æ–±—ã—Ç–∏–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π: {len(upcoming_events)}")
    print(f"   –ü–æ–∫–∞–∑–∞–Ω–æ: {min(10, len(upcoming_events))}")
    
    if len(upcoming_events) > 10:
        print(f"\nüí° –ï—â–µ {len(upcoming_events) - 10} —Å–æ–±—ã—Ç–∏–π –Ω–µ –ø–æ–∫–∞–∑–∞–Ω–æ")
    
    print("=" * 60)

if __name__ == "__main__":
    show_upcoming_events()

```


–í –±–∞–∑–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ (–¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ –≤—Ä—É—á–Ω—É—é). –°–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ó–∞–ø—É—Å–∫–∞—é –∏–º–ø–æ—Ä—Ç:



–ü–∞—Ä—Å–µ—Ä –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è. –ü—Ä–æ–≤–µ—Ä—è—é —Ñ–æ—Ä–º–∞—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ —É–ª—É—á—à–∞—é –ø–∞—Ä—Å–µ—Ä:



–°–æ–∑–¥–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:


```python
"""–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""

import asyncio
import httpx

async def check():
    url = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    async with httpx.AsyncClient() as client:
        r = await client.get(url)
        print("–ü–µ—Ä–≤—ã–µ 3000 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:")
        print("=" * 60)
        print(r.text[:3000])
        print("=" * 60)
        print(f"\n–í—Å–µ–≥–æ —Å–∏–º–≤–æ–ª–æ–≤: {len(r.text)}")

asyncio.run(check())

```


–ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç. –û–±–Ω–æ–≤–ª—è—é –ø–∞—Ä—Å–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å HTML:


```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

try:
    from bs4 import BeautifulSoup
    HAS_BS4 = True
except ImportError:
    HAS_BS4 = False

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar –ø–æ —Å—Ç—Ä–æ–∫–∞–º"""
        events = []
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            from database import EventDatabase
            db = EventDatabase()
            
            today = datetime.now()
            db_events = db.get_events_by_date(today)
            
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –±–æ—Ç–æ–º
            today_events = []
            for db_event in db_events:
                event = {
                    'title': db_event['title'],
                    'description': db_event['description'] or '',
                    'start_date': datetime.combine(db_event['event_date'], datetime.min.time()),
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥/–∫–∞—Ç–µ–≥–æ—Ä–∏—é
                if db_event['reference_uuid']:
                    if db_event['event_type'] == 'author':
                        event['author_uuids'].append(db_event['reference_uuid'])
                        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
                        event['links'].append(
                            f"https://example.com/catalog?authors={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'tag':
                        event['tags'].append(db_event['reference_uuid'])
                        event['links'].append(
                            f"https://example.com/catalog?tags={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'category':
                        event['links'].append(
                            f"https://example.com/catalog?categories={db_event['reference_uuid']}&page=1"
                        )
                
                today_events.append(event)
            
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –ë–î: {len(today_events)}")
            return today_events
            
        except ImportError:
            # Fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏ –ë–î –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞
            logger.warning("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å")
            xml_content = await self.fetch_calendar()
            all_events = self.parse_calendar(xml_content)
            
            today = datetime.now().date()
            today_events = []
            
            for event in all_events:
                if event['start_date']:
                    event_date = event['start_date'].date()
                    if event_date == today:
                        today_events.append(event)
            
            return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

try:
    from bs4 import BeautifulSoup
    HAS_BS4 = True
except ImportError:
    HAS_BS4 = False

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar (HTML —Ñ–æ—Ä–º–∞—Ç)"""
        events = []
        
        # –ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BeautifulSoup –¥–ª—è HTML –ø–∞—Ä—Å–∏–Ω–≥–∞
        if HAS_BS4:
            return self._parse_html_bs4(content)
        
        # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —Å—Ç—Ä–æ–∫–∞–º
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            from database import EventDatabase
            db = EventDatabase()
            
            today = datetime.now()
            db_events = db.get_events_by_date(today)
            
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –±–æ—Ç–æ–º
            today_events = []
            for db_event in db_events:
                event = {
                    'title': db_event['title'],
                    'description': db_event['description'] or '',
                    'start_date': datetime.combine(db_event['event_date'], datetime.min.time()),
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥/–∫–∞—Ç–µ–≥–æ—Ä–∏—é
                if db_event['reference_uuid']:
                    if db_event['event_type'] == 'author':
                        event['author_uuids'].append(db_event['reference_uuid'])
                        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
                        event['links'].append(
                            f"https://example.com/catalog?authors={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'tag':
                        event['tags'].append(db_event['reference_uuid'])
                        event['links'].append(
                            f"https://example.com/catalog?tags={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'category':
                        event['links'].append(
                            f"https://example.com/catalog?categories={db_event['reference_uuid']}&page=1"
                        )
                
                today_events.append(event)
            
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –ë–î: {len(today_events)}")
            return today_events
            
        except ImportError:
            # Fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏ –ë–î –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞
            logger.warning("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å")
            xml_content = await self.fetch_calendar()
            all_events = self.parse_calendar(xml_content)
            
            today = datetime.now().date()
            today_events = []
            
            for event in all_events:
                if event['start_date']:
                    event_date = event['start_date'].date()
                    if event_date == today:
                        today_events.append(event)
            
            return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```python
"""
Telegram-–±–æ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
—Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∫–Ω–∏–≥–∏ –∏–∑ API "–°–≤–µ—Ç"
"""

import asyncio
import logging
import re
import xml.etree.ElementTree as ET
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from urllib.parse import urlparse, parse_qs

import httpx
from telegram import Bot
from telegram.error import TelegramError

try:
    from bs4 import BeautifulSoup
    HAS_BS4 = True
except ImportError:
    HAS_BS4 = False

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


class LiteraryCalendarBot:
    """–ë–æ—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞—Ç"""
    
    def __init__(
        self,
        bot_token: str,
        calendar_url: str,
        graphql_endpoint: str,
        group_chat_id: str,
        timezone: str = "Europe/Moscow"
    ):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
        
        Args:
            bot_token: –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
            calendar_url: URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
            graphql_endpoint: URL GraphQL API
            group_chat_id: ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @userinfobot)
            timezone: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        """
        self.bot = Bot(token=bot_token)
        self.calendar_url = calendar_url
        self.graphql_endpoint = graphql_endpoint
        self.group_chat_id = group_chat_id
        self.timezone = timezone
        
    async def fetch_calendar(self) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ Yandex Calendar"""
        async with httpx.AsyncClient() as client:
            response = await client.get(self.calendar_url)
            if response.status_code == 200:
                return response.text
            else:
                raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {response.status_code}")
    
    def parse_calendar(self, xml_content: str) -> List[Dict]:
        """
        –ü–∞—Ä—Å–∏—Ç XML –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
        
        Returns:
            –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        """
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
        return self._simple_parse(xml_content)
    
    def _simple_parse(self, content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar (HTML —Ñ–æ—Ä–º–∞—Ç)"""
        events = []
        
        # –ü—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BeautifulSoup –¥–ª—è HTML –ø–∞—Ä—Å–∏–Ω–≥–∞
        if HAS_BS4:
            return self._parse_html_bs4(content)
        
        # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —Å—Ç—Ä–æ–∫–∞–º
        lines = content.split('\n')
        
        i = 0
        while i < len(lines):
            line = lines[i].strip()
            
            # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #)
            if line.startswith('# '):
                title = line[2:].strip()
                event = {
                    'title': title,
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ò—â–µ–º –¥–∞—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö (–æ–±—ã—á–Ω–æ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞)
                for j in range(i + 1, min(i + 5, len(lines))):
                    date_line = lines[j].strip()
                    
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00 7 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    # –∏–ª–∏ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                    date_patterns = [
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}:\d{2})',  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                        r'(\d{1,2})\s+(\w+)\s+(\d{4})',  # –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
                    ]
                    
                    for pattern in date_patterns:
                        date_match = re.search(pattern, date_line)
                        if date_match:
                            day, month_ru, year = date_match.groups()[:3]
                            time_str = date_match.group(4) if len(date_match.groups()) > 3 else "00:00"
                            
                            try:
                                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä—É—Å—Å–∫–∏–µ –º–µ—Å—è—Ü—ã
                                months_ru = {
                                    '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                                    '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                                    '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                                    '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                                    '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
                                }
                                month = months_ru.get(month_ru.lower())
                                if month:
                                    hour, minute = map(int, time_str.split(':'))
                                    event['start_date'] = datetime(int(year), month, int(day), hour, minute)
                                    break
                            except (ValueError, KeyError) as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_line}': {e}")
                    
                    if event['start_date']:
                        break
                
                # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö
                description_lines = []
                for j in range(i + 1, min(i + 15, len(lines))):
                    link_line = lines[j]
                    
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ example.com
                    if 'example.com' in link_line:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ URL –∏–∑ —Å—Ç—Ä–æ–∫–∏
                        urls = re.findall(r'https?://[^\s<>"\)]+', link_line)
                        for url in urls:
                            if url not in event['links']:
                                event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                            try:
                                parsed_url = urlparse(url)
                                query_params = parse_qs(parsed_url.query)
                                
                                if 'authors' in query_params:
                                    event['author_uuids'].extend(query_params['authors'])
                                if 'tags' in query_params:
                                    event['tags'].extend(query_params['tags'])
                                
                                # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º slug –≤ –ø—É—Ç–∏
                                path_parts = parsed_url.path.strip('/').split('/')
                                if len(path_parts) > 1 and path_parts[0] == 'catalog':
                                    # –ú–æ–∂–µ—Ç –±—ã—Ç—å slug –∫–Ω–∏–≥–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                                    pass
                            except Exception as e:
                                logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL '{url}': {e}")
                    
                    # –°–æ–±–∏—Ä–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ–∫—Ü–∏–µ–π)
                    elif link_line.strip() and not link_line.strip().startswith('#'):
                        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞—Ç–∞–º–∏
                        if not re.search(r'\d{1,2}\s+\w+\s+\d{4}', link_line):
                            desc_text = link_line.strip()
                            if desc_text and desc_text not in description_lines:
                                description_lines.append(desc_text)
                    
                    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    if j < len(lines) - 1 and lines[j + 1].strip().startswith('# '):
                        break
                
                # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
                if description_lines:
                    event['description'] = '\n'.join(description_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                
                events.append(event)
            i += 1
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: {len(events)}")
        return events
    
    def _parse_html_bs4(self, html_content: str) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ HTML –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å –ø–æ–º–æ—â—å—é BeautifulSoup"""
        events = []
        
        try:
            soup = BeautifulSoup(html_content, 'html.parser')
            
            # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å–æ–±—ã—Ç–∏—è (div —Å –∫–ª–∞—Å—Å–æ–º b-content-event)
            event_divs = soup.find_all('div', class_='b-content-event')
            
            for event_div in event_divs:
                event = {
                    'title': '',
                    'start_date': None,
                    'end_date': None,
                    'description': '',
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–æ–±—ã—Ç–∏—è (h1)
                h1 = event_div.find('h1')
                if h1:
                    event['title'] = h1.get_text(strip=True)
                
                # –î–∞—Ç–∞ (div —Å –∫–ª–∞—Å—Å–æ–º e-time)
                time_div = event_div.find('div', class_='e-time')
                if time_div:
                    time_spans = time_div.find_all('span')
                    if time_spans and len(time_spans) >= 1:
                        date_str = time_spans[0].get_text(strip=True)
                        # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –≤–∏–¥–∞ "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
                        event['start_date'] = self._parse_date_string(date_str)
                
                # –û–ø–∏—Å–∞–Ω–∏–µ (div —Å –∫–ª–∞—Å—Å–æ–º e-description)
                desc_div = event_div.find('div', class_='e-description')
                if desc_div:
                    # –¢–µ–∫—Å—Ç –æ–ø–∏—Å–∞–Ω–∏—è
                    desc_text = desc_div.get_text(strip=True)
                    if desc_text:
                        event['description'] = desc_text
                    
                    # –°—Å—ã–ª–∫–∏
                    links = desc_div.find_all('a', href=True)
                    for link in links:
                        url = link.get('href', '')
                        if url:
                            event['links'].append(url)
                            
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º UUID –∞–≤—Ç–æ—Ä–æ–≤ –∏–∑ —Å—Å—ã–ª–æ–∫
                            parsed_url = urlparse(url)
                            query_params = parse_qs(parsed_url.query)
                            
                            if 'authors' in query_params:
                                event['author_uuids'].extend(query_params['authors'])
                            if 'tags' in query_params:
                                event['tags'].extend(query_params['tags'])
                
                if event['title']:
                    events.append(event)
            
            logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ BeautifulSoup: {len(events)}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML: {e}")
            # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥
            return self._parse_html_simple(html_content)
        
        return events
    
    def _parse_date_string(self, date_str: str) -> Optional[datetime]:
        """–ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É –¥–∞—Ç—ã –≤–∏–¥–∞ '6 –¥–µ–∫–∞–±—Ä—è 2025 00:00'"""
        try:
            # –ü–∞—Ä—Å–∏–º —Ñ–æ—Ä–º–∞—Ç "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
            months_ru = {
                '—è–Ω–≤–∞—Ä—è': 1, '—Ñ–µ–≤—Ä–∞–ª—è': 2, '–º–∞—Ä—Ç–∞': 3, '–∞–ø—Ä–µ–ª—è': 4,
                '–º–∞—è': 5, '–∏—é–Ω—è': 6, '–∏—é–ª—è': 7, '–∞–≤–≥—É—Å—Ç–∞': 8,
                '—Å–µ–Ω—Ç—è–±—Ä—è': 9, '–æ–∫—Ç—è–±—Ä—è': 10, '–Ω–æ—è–±—Ä—è': 11, '–¥–µ–∫–∞–±—Ä—è': 12,
                '—è–Ω–≤–∞—Ä—å': 1, '—Ñ–µ–≤—Ä–∞–ª—å': 2, '–º–∞—Ä—Ç': 3, '–∞–ø—Ä–µ–ª—å': 4,
                '–º–∞–π': 5, '–∏—é–Ω—å': 6, '–∏—é–ª—å': 7, '–∞–≤–≥—É—Å—Ç': 8,
                '—Å–µ–Ω—Ç—è–±—Ä—å': 9, '–æ–∫—Ç—è–±—Ä—å': 10, '–Ω–æ—è–±—Ä—å': 11, '–¥–µ–∫–∞–±—Ä—å': 12
            }
            
            # –ü–∞—Ç—Ç–µ—Ä–Ω: "6 –¥–µ–∫–∞–±—Ä—è 2025 00:00"
            match = re.search(r'(\d{1,2})\s+(\w+)\s+(\d{4})\s+(\d{2}):(\d{2})', date_str)
            if match:
                day, month_ru, year, hour, minute = match.groups()
                month = months_ru.get(month_ru.lower())
                if month:
                    return datetime(int(year), month, int(day), int(hour), int(minute))
            
            # –ü—Ä–æ–±—É–µ–º –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏: "6 –¥–µ–∫–∞–±—Ä—è 2025"
            match = re.search(r'(\d{1,2})\s+(\w+)\s+(\d{4})', date_str)
            if match:
                day, month_ru, year = match.groups()
                month = months_ru.get(month_ru.lower())
                if month:
                    return datetime(int(year), month, int(day), 0, 0)
            
        except Exception as e:
            logger.warning(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã '{date_str}': {e}")
        
        return None
    
    def _parse_html_simple(self, html_content: str) -> List[Dict]:
        """–ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ HTML –±–µ–∑ BeautifulSoup (fallback)"""
        events = []
        
        # –ò—â–µ–º —Å–æ–±—ã—Ç–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É <h1>...</h1>
        h1_pattern = r'<h1>(.*?)</h1>'
        time_pattern = r'<span>(\d{1,2}\s+\w+\s+\d{4}\s+\d{2}:\d{2})</span>'
        link_pattern = r'href="([^"]+)"'
        
        # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–æ–±—ã—Ç–∏—è –ø–æ div.b-content-event
        event_blocks = re.split(r'<div class="b-content-event">', html_content)
        
        for block in event_blocks[1:]:  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—ã–π –ø—É—Å—Ç–æ–π –±–ª–æ–∫
            event = {
                'title': '',
                'start_date': None,
                'end_date': None,
                'description': '',
                'author_uuids': [],
                'tags': [],
                'links': []
            }
            
            # –ó–∞–≥–æ–ª–æ–≤–æ–∫
            h1_match = re.search(h1_pattern, block)
            if h1_match:
                event['title'] = re.sub(r'<[^>]+>', '', h1_match.group(1)).strip()
            
            # –î–∞—Ç–∞
            time_match = re.search(time_pattern, block)
            if time_match:
                date_str = time_match.group(1)
                event['start_date'] = self._parse_date_string(date_str)
            
            # –°—Å—ã–ª–∫–∏
            links = re.findall(link_pattern, block)
            for url in links:
                if 'example.com' in url:
                    event['links'].append(url)
                    parsed_url = urlparse(url)
                    query_params = parse_qs(parsed_url.query)
                    if 'authors' in query_params:
                        event['author_uuids'].extend(query_params['authors'])
                    if 'tags' in query_params:
                        event['tags'].extend(query_params['tags'])
            
            if event['title']:
                events.append(event)
        
        logger.info(f"–†–∞—Å–ø–∞—Ä—Å–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ—Å—Ç—ã–º –ø–∞—Ä—Å–µ—Ä–æ–º: {len(events)}")
        return events
    
    async def get_books_by_author(self, author_uuid: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByAuthor($authorUuid: String!) {
          books(body: {
            authors: [$authorUuid]
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
            annotation
            image {
              url
            }
          }
        }
        """
        
        variables = {"authorUuid": author_uuid}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data and 'books' in data['data']:
                        return data['data']['books']
                else:
                    logger.error(f"–û—à–∏–±–∫–∞ API: {response.status_code}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API: {e}")
        
        return []
    
    async def get_books_by_tag(self, tag: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥—É —á–µ—Ä–µ–∑ GraphQL API"""
        query = """
        query GetBooksByTag($tagSlug: String!) {
          books(body: {
            isActive: true
            limit: 5
          }) {
            uuid
            name
            slug
          }
          tags(body: {
            slugs: [$tagSlug]
          }) {
            uuid
            name
            books(limit: 5) {
              uuid
              name
              slug
            }
          }
        }
        """
        
        variables = {"tagSlug": tag}
        
        try:
            async with httpx.AsyncClient() as client:
                response = await client.post(
                    self.graphql_endpoint,
                    json={"query": query, "variables": variables},
                    headers={"Content-Type": "application/json"},
                    timeout=30.0
                )
                if response.status_code == 200:
                    data = response.json()
                    if 'data' in data:
                        # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ tags
                        if 'tags' in data['data'] and data['data']['tags']:
                            tag_data = data['data']['tags'][0]
                            if 'books' in tag_data:
                                return tag_data['books']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ —Ç–µ–≥—É: {e}")
        
        return []
    
    def format_event_message(self, event: Dict, books: List[Dict] = None) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏"""
        message_parts = []
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        message_parts.append(f"üìö <b>{event['title']}</b>\n")
        
        # –î–∞—Ç–∞
        if event['start_date']:
            date_str = event['start_date'].strftime("%d %B %Y")
            message_parts.append(f"üìÖ {date_str}\n")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        if event['description']:
            desc = event['description'][:200]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            message_parts.append(f"{desc}\n")
        
        # –ö–Ω–∏–≥–∏
        if books:
            message_parts.append("\nüìñ <b>–ö–Ω–∏–≥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–°–≤–µ—Ç¬ª:</b>")
            for book in books[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 –∫–Ω–∏–≥
                book_name = book.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                book_slug = book.get('slug', '')
                if book_slug:
                    book_url = f"https://example.com/catalog/{book_slug}"
                    message_parts.append(f"‚Ä¢ <a href='{book_url}'>{book_name}</a>")
                else:
                    message_parts.append(f"‚Ä¢ {book_name}")
        
        # –°—Å—ã–ª–∫–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        if event['links']:
            message_parts.append("\nüîó <b>–°—Å—ã–ª–∫–∏:</b>")
            for link in event['links'][:3]:  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Å—ã–ª–∫–∏
                message_parts.append(f"<a href='{link}'>–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>")
        
        return "\n".join(message_parts)
    
    async def get_today_events(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            from database import EventDatabase
            db = EventDatabase()
            
            today = datetime.now()
            db_events = db.get_events_by_date(today)
            
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –±–æ—Ç–æ–º
            today_events = []
            for db_event in db_events:
                event = {
                    'title': db_event['title'],
                    'description': db_event['description'] or '',
                    'start_date': datetime.combine(db_event['event_date'], datetime.min.time()),
                    'author_uuids': [],
                    'tags': [],
                    'links': []
                }
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∞–≤—Ç–æ—Ä–∞/—Ç–µ–≥/–∫–∞—Ç–µ–≥–æ—Ä–∏—é
                if db_event['reference_uuid']:
                    if db_event['event_type'] == 'author':
                        event['author_uuids'].append(db_event['reference_uuid'])
                        # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
                        event['links'].append(
                            f"https://example.com/catalog?authors={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'tag':
                        event['tags'].append(db_event['reference_uuid'])
                        event['links'].append(
                            f"https://example.com/catalog?tags={db_event['reference_uuid']}&page=1"
                        )
                    elif db_event['event_type'] == 'category':
                        event['links'].append(
                            f"https://example.com/catalog?categories={db_event['reference_uuid']}&page=1"
                        )
                
                today_events.append(event)
            
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ –ë–î: {len(today_events)}")
            return today_events
            
        except ImportError:
            # Fallback –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –µ—Å–ª–∏ –ë–î –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞
            logger.warning("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—å")
            xml_content = await self.fetch_calendar()
            all_events = self.parse_calendar(xml_content)
            
            today = datetime.now().date()
            today_events = []
            
            for event in all_events:
                if event['start_date']:
                    event_date = event['start_date'].date()
                    if event_date == today:
                        today_events.append(event)
            
            return today_events
    
    async def send_daily_digest(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É"""
        try:
            events = await self.get_today_events()
            
            if not events:
                logger.info("–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è")
                return
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            for event in events:
                books = []
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
                for author_uuid in event['author_uuids']:
                    author_books = await self.get_books_by_author(author_uuid)
                    books.extend(author_books)
                
                # –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥–∏ –ø–æ —Ç–µ–≥–∞–º
                for tag in event['tags']:
                    tag_books = await self.get_books_by_tag(tag)
                    books.extend(tag_books)
                
                # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                seen_uuids = set()
                unique_books = []
                for book in books:
                    uuid = book.get('uuid')
                    if uuid and uuid not in seen_uuids:
                        seen_uuids.add(uuid)
                        unique_books.append(book)
                
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                message = self.format_event_message(event, unique_books)
                
                try:
                    await self.bot.send_message(
                        chat_id=self.group_chat_id,
                        text=message,
                        parse_mode='HTML',
                        disable_web_page_preview=False
                    )
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {event['title']}")
                    
                    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                    await asyncio.sleep(1)
                    
                except TelegramError as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å—Å—ã–ª–∫–∏: {e}")
    
    async def run_daily(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏"""
        logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏")
        
        while True:
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ 9:00)
                now = datetime.now()
                if now.hour == 9 and now.minute == 0:
                    await self.send_daily_digest()
                    # –ñ–¥–µ–º —á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                    await asyncio.sleep(3600)
                else:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                    await asyncio.sleep(60)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ: {e}")
                await asyncio.sleep(60)


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    # –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É @BotFather –≤ Telegram
    BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    
    # URL –∫–∞–ª–µ–Ω–¥–∞—Ä—è Yandex Calendar
    CALENDAR_URL = "https://calendar.yandex.ru/export/html.xml?private_token=<REDACTED>&tz_id=Europe/Moscow&limit=90"
    
    # URL GraphQL API (–Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ API)
    GRAPHQL_ENDPOINT = "https://your-api-endpoint.com/graphql"
    
    # ID –≥—Ä—É–ø–ø—ã –≤ Telegram (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –¥–æ–±–∞–≤–∏–≤ –±–æ—Ç–∞ @userinfobot –≤ –≥—Ä—É–ø–ø—É)
    GROUP_CHAT_ID = "YOUR_GROUP_CHAT_ID"
    # ======================
    
    bot = LiteraryCalendarBot(
        bot_token=BOT_TOKEN,
        calendar_url=CALENDAR_URL,
        graphql_endpoint=GRAPHQL_ENDPOINT,
        group_chat_id=GROUP_CHAT_ID
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É
    await bot.run_daily()


if __name__ == "__main__":
    asyncio.run(main())


```

```pip-requirements
python-telegram-bot>=20.7
httpx>=0.25.0
beautifulsoup4>=4.12.0


```


–ó–∞–ø—É—Å–∫–∞—é –∏–º–ø–æ—Ä—Ç —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–∞—Ä—Å–µ—Ä–æ–º:



–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω: –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 89 —Å–æ–±—ã—Ç–∏–π. –ü–æ–∫–∞–∑—ã–≤–∞—é –ø–µ—Ä–≤—ã–µ 10 —Å–æ–±—ã—Ç–∏–π –∑–∞ —Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π:



–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

## –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: 89 —Å–æ–±—ã—Ç–∏–π –∏–∑ 90

## –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è (—Å–ª–µ–¥—É—é—â–∏–µ 10 –¥–Ω–µ–π):

1. –°–ï–ì–û–î–ù–Ø (6 –¥–µ–∫–∞–±—Ä—è) ‚Äî –û–ª–µ–≥ –ì—Ä–∏–≥–æ—Ä—å–µ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1943 –≥–æ–¥—É
2. –ó–ê–í–¢–†–ê (7 –¥–µ–∫–∞–±—Ä—è) ‚Äî –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –¥–µ–Ω—å –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –∞–≤–∏–∞—Ü–∏–∏
3. –ß–µ—Ä–µ–∑ 6 –¥–Ω–µ–π (12 –¥–µ–∫–∞–±—Ä—è) ‚Äî –í–∞—Å–∏–ª–∏–π –ì—Ä–æ—Å—Å–º–∞–Ω —Ä–æ–¥–∏–ª—Å—è –≤ 1905 –≥–æ–¥—É
4. –ß–µ—Ä–µ–∑ 6 –¥–Ω–µ–π (12 –¥–µ–∫–∞–±—Ä—è) ‚Äî –ù–∏–∫–æ–ª–∞–π –ö–∞—Ä–∞–º–∑–∏–Ω —Ä–æ–¥–∏–ª—Å—è –≤ 1766 –≥–æ–¥—É
5. –ß–µ—Ä–µ–∑ 7 –¥–Ω–µ–π (13 –¥–µ–∫–∞–±—Ä—è) ‚Äî –í–∞–ª–µ—Ä–∏–π –ë—Ä—é—Å–æ–≤ —Ä–æ–¥–∏–ª—Å—è –≤ 1873 –≥–æ–¥—É
6. –ß–µ—Ä–µ–∑ 7 –¥–Ω–µ–π (13 –¥–µ–∫–∞–±—Ä—è) ‚Äî –ö–∞—Ä–ª–æ –ì–æ—Ü—Ü–∏ —Ä–æ–¥–∏–ª—Å—è –≤ 1720 –≥–æ–¥—É

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. –ü–∞—Ä—Å–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å HTML-—Ñ–æ—Ä–º–∞—Ç–æ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—è
2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ BeautifulSoup –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML
3. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 89 —Å–æ–±—ã—Ç–∏–π –∏–∑ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è
4. –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Ç–µ–ø–µ—Ä—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## –ß—Ç–æ –¥–∞–ª—å—à–µ:

1. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è: `python web_app.py` ‚Üí http://localhost:5000
2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ –Ø–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Ç–µ–ø–µ—Ä—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

---

**User**

–æ–∫, —Ç–µ–ø–µ—Ä—å –Ω–∞–¥–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±–ª–æ–∂–∫—É –∫–Ω–∏–≥–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –∞–≤—Ç–æ—Ä–∞

